<html>
<head><meta charset="utf-8"><title>Nirt · brlcad · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/index.html">brlcad</a></h2>
<h3>Topic: <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/Nirt.html">Nirt</a></h3>

<hr>

<base href="https://brlcad.zulipchat.com">

<head><link href="https://brl-cad.github.io/zulip_archive/style.css" rel="stylesheet"></head>

<a name="175526690"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/Nirt/near/175526690" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> scorp08 <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/Nirt.html#175526690">(Sep 12 2019 at 13:07)</a>:</h4>
<p><span class="user-mention" data-user-id="102902">@Sean</span>  great news. <br>
I was wondering that is it possible to change rt_shootray() with rt_shootrays() in fortray.c to increase performance ? <br>
Also  I was just shooting single rays in archer with "nirt", can  rt_shootrays() be executed in "nirt"  or just one single ray with rt_shootray ?</p>



<a name="175528320"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/Nirt/near/175528320" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/Nirt.html#175528320">(Sep 12 2019 at 13:23)</a>:</h4>
<p>Nirt only has one ray to shoot.  You have to also change nirt so it stores up ray requests or something.</p>



<a name="175531578"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/Nirt/near/175531578" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> scorp08 <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/Nirt.html#175531578">(Sep 12 2019 at 13:59)</a>:</h4>
<p><span class="user-mention" data-user-id="102902">@Sean</span>  thnks. Can I gain performance with the  current version of rt_shootrays() or have to apply parallel proccessing, BSP (spatial partioning) etc ?</p>



<a name="175533548"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/Nirt/near/175533548" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/Nirt.html#175533548">(Sep 12 2019 at 14:21)</a>:</h4>
<p><span class="user-mention" data-user-id="228172">@scorp08</span> The current rt_shootrays() is an iterator over rt_shootray() which can be run in parallel and does the spatial partitioning already.  So ... I'm not sure what you're getting at. </p>
<p>If you're shooting rays with nirt in a shell script, shooting rays with rt_shootray() or rt_shootrays() is probably going to be several overs of magnitude faster simply because the overhead of the shell script.  If you create a nirt script instead, that will be faster than a shell script but still limited by nirt code (e.g., it does not shoot in parallel).  If you create a program in C/C++ calling rt_shootray() or rt_shootrays(), then that will be faster still (or slower) depending on the overhead of your code.</p>



<a name="176005248"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/Nirt/near/176005248" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> scorp08 <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/Nirt.html#176005248">(Sep 18 2019 at 13:35)</a>:</h4>
<p><span class="user-mention" data-user-id="102902">@Sean</span>  my aim is  change rt_shootray() in fortray.c with rt_shootrays() to gain performance boost rather than shooting rays individually</p>



<a name="176012458"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/Nirt/near/176012458" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/Nirt.html#176012458">(Sep 18 2019 at 14:51)</a>:</h4>
<p>@scorp08, I'm confused then because fortray.c has nothing to do with nirt ... that's the Fortran interface to librt.  Are you developing a Fortran code?</p>



<a name="176012726"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/Nirt/near/176012726" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/Nirt.html#176012726">(Sep 18 2019 at 14:54)</a>:</h4>
<p>Nirt fires rays when it receives a "shoot" command, which you can find in src/nirt/command.c including the rt_shootray() call.  The problem is still not whether that can be changed to rt_shootrays() there, as it most certainly can.  The problem is that nirt only has one ray so you'd have to modify nirt to queue up shots instead of firing them immediately.  Not a hard change.</p>



<a name="176095182"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/Nirt/near/176095182" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> scorp08 <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/Nirt.html#176095182">(Sep 19 2019 at 12:48)</a>:</h4>
<p><span class="user-mention" data-user-id="102902">@Sean</span>  I will start with fortray for multiple shots but I stuck in the "struct bu_list". Do I need to create a queue template like explained in "  --- BEGIN EXAMPLE --- " in list.h to fill bu_list with xray ?</p>



<a name="176113623"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/Nirt/near/176113623" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/Nirt.html#176113623">(Sep 19 2019 at 15:55)</a>:</h4>
<p>@scorp08 I don't understand why you're modifying fortray ... that's not used by nirt.  Are you coding in Fortran?</p>



<a name="176113978"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/Nirt/near/176113978" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/Nirt.html#176113978">(Sep 19 2019 at 15:58)</a>:</h4>
<blockquote>
<p>Do I need to create a queue template like explained in "  --- BEGIN EXAMPLE --- " in list.h to fill bu_list with xray ?</p>
</blockquote>
<p>There are examples in src/librt/mkbundle.c -- you'll basically call BU_LIST_APPEND() after allocating a new xray.</p>



<a name="176182206"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/Nirt/near/176182206" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> scorp08 <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/Nirt.html#176182206">(Sep 20 2019 at 10:52)</a>:</h4>
<p><span class="user-mention" data-user-id="102902">@Sean</span>  Thnks. I will do some coding in fortran. Is it neccessary to use BU_FORTRAN while declaring a function everytime ?</p>



<a name="176375431"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/Nirt/near/176375431" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/Nirt.html#176375431">(Sep 23 2019 at 14:49)</a>:</h4>
<p><span class="user-mention" data-user-id="228172">@scorp08</span> Oh, that's interesting.  I'd be interested in hearing more (public or private) about what Fortran code you are working on.</p>
<p>It is not necessary to use BU_FORTRAN with modern Fortran.  All it's doing these days is adding an underscore to the name.  It used to be helpful to modify the name so that the output object code had proper calling convention in Fortran, but that all has changed a lot since.  If you have changes to make to it, please do suggest them or submit a patch.</p>



<a name="176455352"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/Nirt/near/176455352" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> scorp08 <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/Nirt.html#176455352">(Sep 24 2019 at 11:49)</a>:</h4>
<p><span class="user-mention" data-user-id="102902">@Sean</span>  thnks. Not last but least question :): After adding stuff to fortray.c , is there an easy way to test it ? Since it includes headers from different folders and those headers also includes from different folders , I frequently got file not found error which is normal. I am using codeblocks IDE but I do not know how can I  open brlcad-master as a project and work on files and build??</p>



<a name="176455755"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/Nirt/near/176455755" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/Nirt.html#176455755">(Sep 24 2019 at 11:55)</a>:</h4>
<p>Looks like cmake has a codeblocks output you can try: <a href="https://stackoverflow.com/questions/37618040/codeblocks-with-cmake" target="_blank" title="https://stackoverflow.com/questions/37618040/codeblocks-with-cmake">https://stackoverflow.com/questions/37618040/codeblocks-with-cmake</a></p>



<a name="176456929"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/Nirt/near/176456929" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> scorp08 <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/Nirt.html#176456929">(Sep 24 2019 at 12:10)</a>:</h4>
<p>The problem is for example build&amp;run "rtshot.c" not possible because "raytrace.h" is not in curdir. And similar for other files...</p>



<a name="176458173"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/Nirt/near/176458173" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/Nirt.html#176458173">(Sep 24 2019 at 12:26)</a>:</h4>
<p><span class="user-mention" data-user-id="228172">@scorp08</span> did you create and open a codeblocks project with cmake?  it should have the right include directories set if you do.</p>



<a name="176827314"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/Nirt/near/176827314" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> scorp08 <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/Nirt.html#176827314">(Sep 28 2019 at 14:00)</a>:</h4>
<p><span class="user-mention" data-user-id="102902">@Sean</span>  I could not fix error of "java not found"  in Cmake altough it is installed . find_package is used instead findJava.</p>



<a name="176902922"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/Nirt/near/176902922" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/Nirt.html#176902922">(Sep 30 2019 at 04:49)</a>:</h4>
<p><span class="user-mention" data-user-id="228172">@scorp08</span> that sounds like a general cmake issue.  we don't have any find java logic.  find_package() is the standard way to include things like Java -- that's what makes it call into the FindJava.cmake sources.  You can see this at <a href="https://cmake.org/cmake/help/v3.5/module/FindJava.html" target="_blank" title="https://cmake.org/cmake/help/v3.5/module/FindJava.html">https://cmake.org/cmake/help/v3.5/module/FindJava.html</a></p>



<a name="176902984"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/Nirt/near/176902984" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/Nirt.html#176902984">(Sep 30 2019 at 04:51)</a>:</h4>
<p>If it's not finding Java, make sure you delete your cache (rm -rf CMake*) after making sure you install it.  Note, you may still need to specify where it was installed into with the -DJAVA_HOME=/path/to/java during cmake.</p>



<a name="176909625"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/Nirt/near/176909625" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> scorp08 <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/Nirt.html#176909625">(Sep 30 2019 at 07:34)</a>:</h4>
<p>solved findJava but this time findThread issue occured:(</p>



<a name="176928657"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/Nirt/near/176928657" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/Nirt.html#176928657">(Sep 30 2019 at 12:51)</a>:</h4>
<p>BRL-CAD specific issue or something in your cmake logic?</p>



<a name="176928678"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/Nirt/near/176928678" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/Nirt.html#176928678">(Sep 30 2019 at 12:51)</a>:</h4>
<p>You can read the builddir/CMakeFiles/CMakeError.txt and CMakeOutput.txt to see why things fail.</p>



<a name="176975243"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/Nirt/near/176975243" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> scorp08 <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/Nirt.html#176975243">(Sep 30 2019 at 21:12)</a>:</h4>
<p>it seems that "-" is missing in the c flag  "Wunused-const-variable".</p>



<a name="177029623"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/Nirt/near/177029623" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> scorp08 <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/Nirt.html#177029623">(Oct 01 2019 at 07:17)</a>:</h4>
<p>Loosing my mind, got -lpthreads not found error now. Using mingw-64. Is that the reason ?  using POSIX and searched spending couple of hours but could not find the solution</p>



<a name="177031713"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/Nirt/near/177031713" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Rossberg <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/Nirt.html#177031713">(Oct 01 2019 at 07:57)</a>:</h4>
<p>Using the GNU compiler on Ms Windows (e.g. with Code::Blocks or MinGW) is known to have issues, and I would not recommend them for starters. Instead, MS Visual Studio is know for working well, at least up to version 2015. There is a free version of it you could use.</p>
<p>Another possibility would be to use Linux, either on an own machine, in a dual boot configuration, or in a virtual machine. (However, the virtual machine image provided on SourceForge is a bit outdated (<a href="https://sourceforge.net/projects/brlcad/files/BRL-CAD%20for%20Virtual%20Machines/" target="_blank" title="https://sourceforge.net/projects/brlcad/files/BRL-CAD%20for%20Virtual%20Machines/">https://sourceforge.net/projects/brlcad/files/BRL-CAD%20for%20Virtual%20Machines/</a>).)</p>



<a name="177410494"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/Nirt/near/177410494" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/Nirt.html#177410494">(Oct 05 2019 at 11:34)</a>:</h4>
<blockquote>
<p>Loosing my mind, got -lpthreads not found error now. Using mingw-64. Is that the reason ?  using POSIX and searched spending couple of hours but could not find the solution</p>
</blockquote>
<p><span class="user-mention" data-user-id="228172">@scorp08</span> you'll want to delete your build directory every time (at least the cache file) ... it has a huge influence on subsequent cmake testing.  Daniel is right though -- mingw is not strongly supported by cmake in general (even some of the internal tests have issues).</p>



<a name="177410498"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/Nirt/near/177410498" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/Nirt.html#177410498">(Oct 05 2019 at 11:34)</a>:</h4>
<p>it can work, but you're going to have to do a bit of work to get it working stable</p>



<a name="177457894"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/Nirt/near/177457894" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> scorp08 <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/Nirt.html#177457894">(Oct 06 2019 at 11:50)</a>:</h4>
<p>tried with VS2013 but again findthread error "CheckForPthreads.obj : error LNK2019: unresolved external symbol __imp_pthread_create referenced in function..." . I need to add link with  'pthreadVC2.lib'. But could not understand where it is try to test CheckForPthreads.c ?   where can I add flag in cmakelists ??</p>



<a name="177467134"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/Nirt/near/177467134" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Rossberg <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/Nirt.html#177467134">(Oct 06 2019 at 16:27)</a>:</h4>
<p>Did you started from empty build directory? CMake should drop pthreads in this configuration because this isn't POSIX.</p>



<a name="177492529"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/Nirt/near/177492529" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> scorp08 <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/Nirt.html#177492529">(Oct 07 2019 at 05:51)</a>:</h4>
<p>yes. It tries to build CheckForPthreads.c but not link 'pthreadVC2.lib'.</p>



<a name="177492911"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/Nirt/near/177492911" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Rossberg <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/Nirt.html#177492911">(Oct 07 2019 at 06:04)</a>:</h4>
<p>This is OK. CMake shall check for pthreads. However, this check fails for Visual Studio, therefore CMakes does not include them in the final build configuration.</p>



<a name="177492960"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/Nirt/near/177492960" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Rossberg <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/Nirt.html#177492960">(Oct 07 2019 at 06:05)</a>:</h4>
<p>I'll check it with my Visual Studio ...</p>



<a name="177512689"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/Nirt/near/177512689" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/Nirt.html#177512689">(Oct 07 2019 at 12:07)</a>:</h4>
<p><span class="user-mention" data-user-id="228172">@scorp08</span> if you can post your cmake files or output, it might be easier to help figure out what's wrong</p>



<a name="177513259"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/Nirt/near/177513259" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Rossberg <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/Nirt.html#177513259">(Oct 07 2019 at 12:17)</a>:</h4>
<p>Just tried with VS 2013: CMake works. I had to close some error messages from test functions manually (the 3 AVX tests), but this is okay.</p>
<p>But, the build fails because libbrep (RTree.h) requires C++11 which VS 2013 is not. Unfortunately, I don't have any newer Visual Studio, at least at the moment.</p>



<a name="177516252"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/Nirt/near/177516252" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/Nirt.html#177516252">(Oct 07 2019 at 12:59)</a>:</h4>
<p>Until the feature is working, we can probably disable the files requiring it, but we are adopting C++11 so it's only a matter of time.  I believe VS2015 is the new minimum for it.</p>



<a name="177782521"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/Nirt/near/177782521" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> scorp08 <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/Nirt.html#177782521">(Oct 10 2019 at 06:19)</a>:</h4>
<p><span class="user-mention" data-user-id="102939">@Daniel Rossberg</span>  It looked for pthread.h library and returned "could not found" error as I do not have. Why It force me to include pthread.h ?</p>



<a name="177784473"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/Nirt/near/177784473" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Rossberg <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/Nirt.html#177784473">(Oct 10 2019 at 07:02)</a>:</h4>
<p>What is "It"? CMake?</p>



<a name="177785798"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/Nirt/near/177785798" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> scorp08 <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/Nirt.html#177785798">(Oct 10 2019 at 07:29)</a>:</h4>
<p>Findthreads.cmake</p>



<a name="177790116"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/Nirt/near/177790116" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Rossberg <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/Nirt.html#177790116">(Oct 10 2019 at 08:42)</a>:</h4>
<p>That's okay. It's the purpose of CMake to test many features and generate the build files according to the test results. In case of pthead this means to set the HAVE_PTHREAD_H macro accordingly.</p>
<p>For example, have a look at src/libbu/parallel.c. If HAVE_PTHREAD_H is set rt_thread_t is pthread_t, but on MS Windows with _WIN32 rt_thread_t is HANDLE.</p>
<p>Now, you experienced that CMake could not find pthread, therefore it does not define HAVE_PTHREAD_H, which results in not using pthread in the build. But, because it runs on MS Windows, _WIN32 is defined, which causes the use of the Windows threading. This is exactly what we expect CMake shall do.</p>



<a name="177800888"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/Nirt/near/177800888" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> scorp08 <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/Nirt.html#177800888">(Oct 10 2019 at 11:39)</a>:</h4>
<p>understand but why (@222) findthreats.cmake is returning True ? findthreats is trying to add imported interface Threads::Threads. so, cause to "could not found pthread.h " error. While I was trying with my own cmake builds, it returned False, so there is no error.</p>



<a name="177801730"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/Nirt/near/177801730" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Rossberg <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/Nirt.html#177801730">(Oct 10 2019 at 11:54)</a>:</h4>
<p>@222? Did I missed a listing somewhere?</p>
<p>FindThreads "determines the thread library of the system". On MS Windows, it should find the Win32 threading API.</p>



<a name="177806144"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/Nirt/near/177806144" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> scorp08 <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/Nirt.html#177806144">(Oct 10 2019 at 12:51)</a>:</h4>
<p>" <a href="https://github.com/Kitware/CMake/blob/master/Modules/FindThreads.cmake" target="_blank" title="https://github.com/Kitware/CMake/blob/master/Modules/FindThreads.cmake">https://github.com/Kitware/CMake/blob/master/Modules/FindThreads.cmake</a>" 222.row, that clause cause the error</p>



<a name="177808303"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/Nirt/near/177808303" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Rossberg <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/Nirt.html#177808303">(Oct 10 2019 at 13:14)</a>:</h4>
<p>This is an "if" clause. How could this cause an error?<br>
I can only agree with Sean: <a href="#narrow/stream/104062-general/topic/Nirt/near/177512689" title="#narrow/stream/104062-general/topic/Nirt/near/177512689">https://brlcad.zulipchat.com/#narrow/stream/104062-general/topic/Nirt/near/177512689</a></p>



<a name="177825919"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/Nirt/near/177825919" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> scorp08 <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/Nirt.html#177825919">(Oct 10 2019 at 16:13)</a>:</h4>
<blockquote>
<p>" <a href="https://github.com/Kitware/CMake/blob/master/Modules/FindThreads.cmake" target="_blank" title="https://github.com/Kitware/CMake/blob/master/Modules/FindThreads.cmake">https://github.com/Kitware/CMake/blob/master/Modules/FindThreads.cmake</a>" 222.row, that clause cause the error<br>
``` I meant the add_library (@223) cause the error.<br>
I tried in  another computer which I included pthread.h and dll file. Here is the errorfile <a href="/user_uploads/1549/hglfpsaUfOSk7u_tbHliaCLO/CMakeError.log" target="_blank" title="CMakeError.log">CMakeError.log</a> <br>
I will try to post other errorlog...</p>
</blockquote>



<a name="177879547"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/Nirt/near/177879547" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/Nirt.html#177879547">(Oct 11 2019 at 05:34)</a>:</h4>
<p>At a glance, the only thing suspicious I see is THREADS_FOUND on 222 should be Threads_FOUND, but that shouldn't matter here I think</p>



<a name="177879722"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/Nirt/near/177879722" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/Nirt.html#177879722">(Oct 11 2019 at 05:38)</a>:</h4>
<p>the error log only shows individual test errors (which may be perfectly normal, hard to say without seeing other output), which is useful in conjunction with  the other logs.  what's the cmake output look like if you save it to a file?  that will be more informative towards fixing / preventing whatever is going wrong.</p>



<a name="177882097"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/Nirt/near/177882097" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Rossberg <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/Nirt.html#177882097">(Oct 11 2019 at 06:41)</a>:</h4>
<ul>
<li>I don't recommend to provide the Windows build with the pthread.h and pthread.dll. I expect this to break the build because of conflicting the POSIX with the WIN32 threading API here.</li>
<li>In my logs I see a "fatal error" because of the non-existent pthread.h. But, this is exactly what I expect to happen. The consequence is that HAVE_PTHREAD_H is not defined and WIN32 threading will be used instead.</li>
</ul>
<p>I still don't see your problem.</p>



<a name="177889380"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/Nirt/near/177889380" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> scorp08 <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/Nirt.html#177889380">(Oct 11 2019 at 08:58)</a>:</h4>
<p>Maybe it is due to cmake version (i am using 3.8). In my case it is not configuring both ( with pthread.h and without ) . So i could not build</p>



<a name="177890170"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/Nirt/near/177890170" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Rossberg <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/Nirt.html#177890170">(Oct 11 2019 at 09:11)</a>:</h4>
<p>This does not make sense to me. CMake doesn't really need to configure the WIN32 version because the _WIN32 macro will be always set for Visual Studio builds, independently from what FindThreads says.</p>
<p>Does CMake generate a solution (.sln) file?</p>



<a name="177909688"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/Nirt/near/177909688" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> scorp08 <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/Nirt.html#177909688">(Oct 11 2019 at 14:05)</a>:</h4>
<p>No. If you have an option  to try with latest versions of cmake,  it would be good</p>



<a name="177910991"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/Nirt/near/177910991" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Rossberg <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/Nirt.html#177910991">(Oct 11 2019 at 14:19)</a>:</h4>
<p>I just run CMake 3.15.4 with the VS 2019 backend. There was an issue with a test program (.exe) which was hard to remove, but I got the VS build files at the end.</p>
<p>You should really upload your &lt;build directory&gt;/CMakeFiles/CMakeOutput.log.</p>



<a name="177930769"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/Nirt/near/177930769" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> scorp08 <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/Nirt.html#177930769">(Oct 11 2019 at 17:43)</a>:</h4>
<p>Ohhh, I was trying with brlcad 7.24. Now tried with latest and it is done !. But what is difference, what was the cause of thread error ?</p>



<a name="177998342"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/Nirt/near/177998342" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Rossberg <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/Nirt.html#177998342">(Oct 12 2019 at 17:25)</a>:</h4>
<p>Can't say without your logs <span aria-label="wink" class="emoji emoji-1f609" role="img" title="wink">:wink:</span></p>



<a name="178008435"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/Nirt/near/178008435" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> scorp08 <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/Nirt.html#178008435">(Oct 12 2019 at 22:02)</a>:</h4>
<p>ok. Is it possible to build latest version and use  dll files  in 7.24  ? especially librt ?</p>



<a name="178081048"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/Nirt/near/178081048" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> scorp08 <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/Nirt.html#178081048">(Oct 14 2019 at 07:53)</a>:</h4>
<p>Here the errorlogs from 7.24 (pthread.h -could not finished configure) ... <a href="/user_uploads/1549/y_iZJLHIwar_cwmPhZExO2xg/CMakeError.log" target="_blank" title="CMakeError.log">CMakeError.log</a> <a href="/user_uploads/1549/9VPX1IuxShlDg0UeGRgyqg2d/CMakeOutput.log" target="_blank" title="CMakeOutput.log">CMakeOutput.log</a></p>



<a name="178086173"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/Nirt/near/178086173" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Rossberg <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/Nirt.html#178086173">(Oct 14 2019 at 09:08)</a>:</h4>
<blockquote>
<p>ok. Is it possible to build latest version and use  dll files  in 7.24  ? especially librt ?</p>
</blockquote>
<p>No, it is not possible because of changes in the API. Function parameters have changed meanwhile.</p>



<a name="178091288"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/Nirt/near/178091288" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Rossberg <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/Nirt.html#178091288">(Oct 14 2019 at 10:30)</a>:</h4>
<blockquote>
<p>Here the errorlogs from 7.24 (pthread.h -could not finished configure) ... <a href="/user_uploads/1549/y_iZJLHIwar_cwmPhZExO2xg/CMakeError.log" target="_blank" title="CMakeError.log">CMakeError.log</a> <a href="/user_uploads/1549/9VPX1IuxShlDg0UeGRgyqg2d/CMakeOutput.log" target="_blank" title="CMakeOutput.log">CMakeOutput.log</a></p>
</blockquote>
<p>All I can say is that</p>
<div class="codehilite"><pre><span></span>STATUS: Looking for pthread.h
STATUS: Looking for pthread.h - not found
STATUS: Found Threads: TRUE
</pre></div>


<p>is perfectly right for MS Windows. It has to look like this there.</p>
<p>Another matter is your compiler. I'm not sure if MSVS 2017 will work with the BRL-CAD 7.24 set-up.</p>



<a name="178092086"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/Nirt/near/178092086" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> scorp08 <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/Nirt.html#178092086">(Oct 14 2019 at 10:42)</a>:</h4>
<p>I also tried with 2013, no success with same error...could not find the problem :(</p>



<a name="178096983"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/Nirt/near/178096983" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Rossberg <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/Nirt.html#178096983">(Oct 14 2019 at 12:07)</a>:</h4>
<p>Maybe it requires an even older version of Visual Studio or a CMake version 2.x.</p>
<p>BUT, what do you want to do? Why do you want to be compatible with BRL-CAD version 7.24? If you want to write an own application using BRL-CAD libraries, there are other possibilities.</p>



<hr><p>Last updated: Jul 30 2024 at 00:40 UTC</p>
</html>