<html>
<head><meta charset="utf-8"><title>regress-repository · brlcad · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/index.html">brlcad</a></h2>
<h3>Topic: <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html">regress-repository</a></h3>

<hr>

<base href="https://brlcad.zulipchat.com">

<head><link href="https://brl-cad.github.io/zulip_archive/style.css" rel="stylesheet"></head>

<a name="197506927"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197506927" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197506927">(May 14 2020 at 05:15)</a>:</h4>
<p>Not scanning at all, actually - that's probably where I was getting the cmakefiles.cmake reference.  I use that as my initial list, so there's no scanning at all.</p>



<a name="197506975"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197506975" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197506975">(May 14 2020 at 05:16)</a>:</h4>
<p>I mean scanning file contents, i.e., reading from disk</p>



<a name="197507006"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197507006" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197507006">(May 14 2020 at 05:17)</a>:</h4>
<p>hierarchy traversal is nearly instantaneous these days on all platforms</p>



<a name="197507015"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197507015" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197507015">(May 14 2020 at 05:17)</a>:</h4>
<p>Oh.  I'm resetting the offset in the stream once per pass type - getting finer than that is going to get pretty tricky.</p>



<a name="197507035"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197507035" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197507035">(May 14 2020 at 05:18)</a>:</h4>
<p>traversal is measured in hundreds of thousands of inodes per second, thousands of dirs per second</p>



<a name="197507060"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197507060" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197507060">(May 14 2020 at 05:18)</a>:</h4>
<p>so I open the ifstream, do a bio.h check, reset seeking to 0, do the bnetwork.h check, etc.</p>



<a name="197507066"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197507066" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197507066">(May 14 2020 at 05:18)</a>:</h4>
<p>hm</p>



<a name="197507078"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197507078" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197507078">(May 14 2020 at 05:19)</a>:</h4>
<p>that definitely is going to involve disk caching</p>



<a name="197507134"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197507134" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197507134">(May 14 2020 at 05:20)</a>:</h4>
<p>In principle I might be able to reuse each getline to do all the processing, but I'm leery of trying - that would involve multiple simultaneous scanning state managements, and just to save 5 or 6 seconds I doubt it's worth it.</p>



<a name="197507136"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197507136" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197507136">(May 14 2020 at 05:20)</a>:</h4>
<p>to eliminate the effect, you'd need to parse the ifstream into a stringstream or other buffer type and do all your work on that</p>



<a name="197507148"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197507148" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197507148">(May 14 2020 at 05:21)</a>:</h4>
<p>Hmm.  More ram usage, but none of our files are big enough to be an issue anyway on any sane system...</p>



<a name="197507153"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197507153" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197507153">(May 14 2020 at 05:21)</a>:</h4>
<p>not even close to being an issue</p>



<a name="197507207"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197507207" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197507207">(May 14 2020 at 05:22)</a>:</h4>
<p>the only downside would be if you don't actually have enough work, i.e., if the cost of a malloc+memcpy is more than your regex (which seems unlikely)</p>



<a name="197507266"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197507266" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197507266">(May 14 2020 at 05:24)</a>:</h4>
<p>the memcpy can be avoided, but you'd need to use bu_mapped_file or mmap or similar and just scan the buffer instead of using getline.  it's an order of magnitude faster for read-only work.</p>



<a name="197507280"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197507280" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197507280">(May 14 2020 at 05:25)</a>:</h4>
<p>relies on the virtual memory manager to do the best thing, and it's really hard to do better oneself</p>



<a name="197507417"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197507417" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197507417">(May 14 2020 at 05:29)</a>:</h4>
<p>in a quick test stringstream didn't do much</p>



<a name="197507418"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197507418" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197507418">(May 14 2020 at 05:29)</a>:</h4>
<p>for what it's worth, it's very likely possible to get the repo check down to a sub-second time compiled.  not necessary of course, and any improvement will be gravy.</p>



<a name="197507421"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197507421" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197507421">(May 14 2020 at 05:29)</a>:</h4>
<p>you're already disk-cached -- you'd have to invalidate the cache to see the effect</p>



<a name="197507425"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197507425" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197507425">(May 14 2020 at 05:30)</a>:</h4>
<p>ah</p>



<a name="197507475"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197507475" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197507475">(May 14 2020 at 05:31)</a>:</h4>
<p>I'd still expect it to be a smidgen gain, but it's mostly saving seek time.  if it's cached, though, it's all in memory already and there is no actual seeking going on</p>



<a name="197507512"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197507512" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197507512">(May 14 2020 at 05:32)</a>:</h4>
<p>I'm probably not using it correctly - I literally dropped in the stringstream instead of the ifstream, and I doubt that's right</p>



<a name="197507540"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197507540" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197507540">(May 14 2020 at 05:33)</a>:</h4>
<p>If you want to watch it blow up on OSX, you can try it with cmake -DREPOCHECK_TEST=ON to have "make regress-repository" use the new version.</p>



<a name="197507541"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197507541" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197507541">(May 14 2020 at 05:33)</a>:</h4>
<p>mapped file really will be the best for this.</p>



<a name="197507604"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197507604" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197507604">(May 14 2020 at 05:35)</a>:</h4>
<p>for myself I'd rather figure out how to get it to check all of our files defining main to make sure they call bu_setprogname</p>



<a name="197507652"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197507652" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197507652">(May 14 2020 at 05:36)</a>:</h4>
<p>it's as simple as </p>
<div class="codehilite"><pre><span></span><code>struct bu_mapped_file *mf =  bu_open_mapped_file(myfile, &quot;whatever&quot;);
</code></pre></div>


<p>and just start searching (char*)mf-&gt;buf for content.</p>



<a name="197507653"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197507653" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197507653">(May 14 2020 at 05:36)</a>:</h4>
<p>Don't know if I've added a new program in the last 5 years without forgetting to do that and then having to debug why the relative lookup acted weird...</p>



<a name="197507680"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197507680" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197507680">(May 14 2020 at 05:37)</a>:</h4>
<p>bu_getline will work on that?  (been a while since I used a mapped file)</p>



<a name="197507692"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197507692" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197507692">(May 14 2020 at 05:37)</a>:</h4>
<p>need lines for the line number reporting...</p>



<a name="197507758"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197507758" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197507758">(May 14 2020 at 05:39)</a>:</h4>
<p>you don't need bu_getline, you just use it almost like it was getline's result</p>



<a name="197507764"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197507764" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197507764">(May 14 2020 at 05:39)</a>:</h4>
<p>just, it's all lines</p>



<a name="197507768"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197507768" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197507768">(May 14 2020 at 05:39)</a>:</h4>
<p>instantaneously.  it's a beautiful thing.</p>



<a name="197507832"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197507832" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197507832">(May 14 2020 at 05:41)</a>:</h4>
<p>Well, if you think it's worth it I can take a look tomorrow.  Need to try it on some more machines, but for myself if it's reliably &lt;10sec (or even &lt;30 sec) across the board that's probably good enough for now...</p>



<a name="197507834"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197507834" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197507834">(May 14 2020 at 05:41)</a>:</h4>
<p>Yeah, I agree with you on the bu_setprogname -- that's bit us repeatedly.  ideally we shouldn't need to call it at all, but we still don't have all platforms yet.</p>



<a name="197507843"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197507843" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197507843">(May 14 2020 at 05:41)</a>:</h4>
<p>I don't think we can get around it for OpenBSD - I couldn't find any other solution that worked reliably</p>



<a name="197507883"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197507883" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197507883">(May 14 2020 at 05:42)</a>:</h4>
<p>It's actually pretty cool that the iwd/setprogname pairing does work - I think that might be an unusual capability</p>



<a name="197507895"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197507895" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197507895">(May 14 2020 at 05:43)</a>:</h4>
<p><span class="user-mention silent" data-user-id="112516">starseeker</span> <a href="#narrow/stream/104062-general/topic/regress-repository/near/197507832">said</a>:</p>
<blockquote>
<p>Well, if you think it's worth it I can take a look tomorrow.  Need to try it on some more machines, but for myself if it's reliably &lt;10sec (or even &lt;30 sec) across the board that's probably good enough for now...</p>
</blockquote>
<p>if one of your goals/reasons for transcoding it was to make it faster, then it's definitely worth it.  I think it would be worthwhile simply because the code definitely has a 10x cyclomatic complexity increase, so we should at least take advantage it'll give decreasing iterative testing times.</p>



<a name="197507936"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197507936" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197507936">(May 14 2020 at 05:44)</a>:</h4>
<p>if it can be made fast enough, then we might even be able to break up the tests themselves so it's not a compound test</p>



<a name="197507954"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197507954" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197507954">(May 14 2020 at 05:45)</a>:</h4>
<p>Well, kinda - I wanted to get to a place where we don't see those crazy outliers that sometimes break the CI results with a "timed out" fail</p>



<a name="197507958"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197507958" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197507958">(May 14 2020 at 05:45)</a>:</h4>
<p>(and have it run on Windows...)</p>



<a name="197507960"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197507960" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197507960">(May 14 2020 at 05:45)</a>:</h4>
<p>breaking it up with certainly do that too :)</p>



<a name="197507985"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197507985" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197507985">(May 14 2020 at 05:45)</a>:</h4>
<p>and it could run in parallel</p>



<a name="197508066"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197508066" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197508066">(May 14 2020 at 05:46)</a>:</h4>
<p>I could probably do that now, actually (running the individual tests bit) - didn't bother since it's no longer a drop-in replacement for <a href="http://repository.sh">repository.sh</a> when I do that, but shouldn't be too hard.</p>



<a name="197508177"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197508177" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197508177">(May 14 2020 at 05:48)</a>:</h4>
<p>the only reason all those tests were munged together was because of shell scripting I/O performance limitations.  I would have needed to use shared memory or ports/socket communication to break it up effectively, which is a pain in shell scripts.</p>



<a name="197508179"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197508179" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197508179">(May 14 2020 at 05:49)</a>:</h4>
<p><span class="user-mention" data-user-id="102902">@Sean</span> Most of the complexity is to support threading - if you want to go simpler and single threaded it can probably be about the same or maybe a little simpler than the shell script</p>



<a name="197508190"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197508190" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197508190">(May 14 2020 at 05:49)</a>:</h4>
<p>threading o.O</p>



<a name="197508201"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197508201" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197508201">(May 14 2020 at 05:49)</a>:</h4>
<p>Launches the test suite against multiple files in parallel</p>



<a name="197508249"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197508249" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197508249">(May 14 2020 at 05:50)</a>:</h4>
<p>what complexity are you referring to?</p>



<a name="197508254"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197508254" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197508254">(May 14 2020 at 05:50)</a>:</h4>
<p>I see no threading in repocheck.cpp</p>



<a name="197508269"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197508269" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197508269">(May 14 2020 at 05:51)</a>:</h4>
<p>look around 748 (you may need to svn update if you haven't in the last few hours)</p>



<a name="197508537"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197508537" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197508537">(May 14 2020 at 05:57)</a>:</h4>
<p>alright, I gotta call it a night</p>



<a name="197508539"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197508539" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197508539">(May 14 2020 at 05:57)</a>:</h4>
<p>ah, I see what you mean now</p>



<a name="197508589"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197508589" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197508589">(May 14 2020 at 05:58)</a>:</h4>
<p>yeah, I think it should be single threaded..</p>



<a name="197508603"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197508603" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197508603">(May 14 2020 at 05:59)</a>:</h4>
<p>It did make a difference, at least in earlier testing - maybe less so now.</p>



<a name="197508604"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197508604" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197508604">(May 14 2020 at 05:59)</a>:</h4>
<p>this is already turning 1-line shell script commands into 100 line C++ logic, which has it's obvious benefits, but I don't think it's healthy to add to that complexity unnecessarily.  it won't be as maintainable.</p>



<a name="197508671"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197508671" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197508671">(May 14 2020 at 06:01)</a>:</h4>
<p><a href="http://repository.sh">repository.sh</a> is 382 lines,  repocheck.cpp is (currently) 885 - more like 3x overall...</p>



<a name="197508688"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197508688" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197508688">(May 14 2020 at 06:01)</a>:</h4>
<p><a href="http://repository.sh">repository.sh</a> has an unrealistic amount of error checking for typical scripting</p>



<a name="197508730"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197508730" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197508730">(May 14 2020 at 06:02)</a>:</h4>
<p>but fair enough since even the error checking and logging is transcodd</p>



<a name="197508754"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197508754" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197508754">(May 14 2020 at 06:03)</a>:</h4>
<p>the script could be distilled down to something like 10 lines, though, one grep for each test</p>



<a name="197508808"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197508808" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197508808">(May 14 2020 at 06:04)</a>:</h4>
<p>&lt;snort&gt; if we don't factor in readability of the lines, sure you can win that way ;-)</p>



<a name="197508824"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197508824" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197508824">(May 14 2020 at 06:04)</a>:</h4>
<p>it's not a competition</p>



<a name="197508863"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197508863" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197508863">(May 14 2020 at 06:05)</a>:</h4>
<p>Well, maybe in the sense of competing solutions - the C++ code has to be good enough to warrant replacement of an existing, working solution</p>



<a name="197508919"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197508919" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197508919">(May 14 2020 at 06:06)</a>:</h4>
<p>Without, as you say, insane maintenance burdens being taken on as a result.</p>



<a name="197508932"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197508932" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197508932">(May 14 2020 at 06:06)</a>:</h4>
<p>readability of both is dominated by reader experience.  assuming an experienced programmer, the difference here is going to predominantly be lines of code and potential for error, long-term maintainability</p>



<a name="197509006"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197509006" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197509006">(May 14 2020 at 06:08)</a>:</h4>
<p>cyclomatic complexity of c++ is nowhere near that of any higher level language including shell script.  it's way higher.</p>



<a name="197509050"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197509050" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197509050">(May 14 2020 at 06:08)</a>:</h4>
<p>When I'm doing the coding you can add a 2x multiplier for error potential to shell scripting just due to spaces and special characters in path names.</p>



<a name="197509061"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197509061" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197509061">(May 14 2020 at 06:08)</a>:</h4>
<p>it's a win in the other benefits, portability and performance foremost</p>



<a name="197509156"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197509156" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197509156">(May 14 2020 at 06:10)</a>:</h4>
<p>Anyway, I'll crank it back to the single threaded version tomorrow and see if mapped files do anything helpful for performance.</p>



<a name="197509158"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197509158" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197509158">(May 14 2020 at 06:10)</a>:</h4>
<p>any single developer's experience or preference, mine and yours included, shouldn't be the dominant calculus in my opinion.  that leads to things like sticking with tcl/tk.</p>



<a name="197509193"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197509193" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197509193">(May 14 2020 at 06:11)</a>:</h4>
<p>heh.  In fairness, Tcl/Tk was the rational choice in 1990.  They just decided they liked it in 1990  and stayed put too long.</p>



<a name="197509268"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197509268" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197509268">(May 14 2020 at 06:12)</a>:</h4>
<p>alright, uncle.  need sleep</p>



<a name="197509272"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197509272" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197509272">(May 14 2020 at 06:12)</a>:</h4>
<p>certainly, and shell scripts can still be written in significant fraction of the time as c++, they have their place</p>



<a name="197509377"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197509377" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197509377">(May 14 2020 at 06:14)</a>:</h4>
<p>cya</p>



<a name="197509554"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197509554" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197509554">(May 14 2020 at 06:18)</a>:</h4>
<p>fyi, jenkins is barking a failure: make[3]: don't know how to make embedded_licenses.txt. Stop</p>



<a name="197510292"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197510292" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197510292">(May 14 2020 at 06:31)</a>:</h4>
<p>just saw c75789 .. that's technically wrong too.  the correct form of a URI reference for a relative reference is simply the relative path (i.e., no file: prefix).  see <a href="https://en.wikipedia.org/wiki/Uniform_Resource_Identifier">https://en.wikipedia.org/wiki/Uniform_Resource_Identifier</a></p>



<a name="197542769"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197542769" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197542769">(May 14 2020 at 12:05)</a>:</h4>
<p>Was considering the "root" of the reference system to be the root of the BRL-CAD src tree (not the filesystem) so in that sense they're absolute.  However, if you prefer something like the reuse.software format we can do that - I just want to pick one answer, set it up, and not worry about it anymore.</p>



<a name="197543612"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197543612" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197543612">(May 14 2020 at 12:12)</a>:</h4>
<p>stale build tree caught me - missed a variable.  r75796 should do it.</p>



<a name="197564349"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197564349" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197564349">(May 14 2020 at 14:38)</a>:</h4>
<p>Well, that gets to &lt; 2s on Linux, but still ~15 on FreeBSD.</p>



<a name="197565180"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197565180" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197565180">(May 14 2020 at 14:44)</a>:</h4>
<p><span class="user-mention" data-user-id="102902">@Sean</span> is there any equivalent to perf on FreeBSD?</p>



<a name="197573778"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197573778" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197573778">(May 14 2020 at 15:38)</a>:</h4>
<p><span class="user-mention silent" data-user-id="112516">starseeker</span> <a href="#narrow/stream/104062-general/topic/regress-repository/near/197542769">said</a>:</p>
<blockquote>
<p>Was considering the "root" of the reference system to be the root of the BRL-CAD src tree (not the filesystem) so in that sense they're absolute.  However, if you prefer something like the reuse.software format we can do that - I just want to pick one answer, set it up, and not worry about it anymore.</p>
</blockquote>
<p>I know what you were considering; it was clear.  Just letting you know that it's technically wrong per the URI spec if that was the reason for using them.  There's little reason to prefer file:/path/to/file over file:path/to/file and vice versa.  The actual correct form is simply path/to/file or ./path/to/file as a URI reference, which is combined with a root path to create a valid URL, like file:/usr/home/brlcad/path/to/file or file:<code>pwd</code>/$filepath or file:${PWD}/${filepath} etc.</p>



<a name="197573880"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197573880" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197573880">(May 14 2020 at 15:39)</a>:</h4>
<p>Note of the two relative forms, lots of software does support the latter (file:rel/path/to/file) despite being invalid (e.g., I believe some terminals will handle it)</p>



<a name="197574149"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197574149" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197574149">(May 14 2020 at 15:41)</a>:</h4>
<p><span class="user-mention silent" data-user-id="112516">starseeker</span> <a href="#narrow/stream/104062-general/topic/regress-repository/near/197565180">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="102902">Sean</span> is there any equivalent to perf on FreeBSD?</p>
</blockquote>
<p>yes, it's called the pmc interface on freebsd.  I think the main comparable tool is hwpmc but I have not tried it</p>



<a name="197574198"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197574198" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197574198">(May 14 2020 at 15:41)</a>:</h4>
<p><a href="https://people.freebsd.org/~jkoshy/projects/perf-measurement/">https://people.freebsd.org/~jkoshy/projects/perf-measurement/</a></p>



<a name="197574319"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197574319" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197574319">(May 14 2020 at 15:42)</a>:</h4>
<p>looks like latest docs are <a href="https://wiki.freebsd.org/PmcTools">https://wiki.freebsd.org/PmcTools</a></p>



<a name="197576158"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197576158" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197576158">(May 14 2020 at 15:54)</a>:</h4>
<p>Looks like pcmstat is the user facing side, but I can't get it to kick off...</p>



<a name="197576300"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197576300" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197576300">(May 14 2020 at 15:55)</a>:</h4>
<p>pmcstat: ERROR: Initialization of the pmc(3) library failed: No such file or directory</p>



<a name="197576379"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197576379" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197576379">(May 14 2020 at 15:56)</a>:</h4>
<p>Not sure if that's my fault or if there's something missing on the system...</p>



<a name="197576452"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197576452" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197576452">(May 14 2020 at 15:56)</a>:</h4>
<p><span class="user-mention" data-user-id="112516">@starseeker</span> just looking at 75799, you're not likely going to see a performance improvement with that approach.  you're making three copies of every file.  without copy on right, that could even be slower than what you had before.</p>



<a name="197576676"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197576676" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197576676">(May 14 2020 at 15:58)</a>:</h4>
<p><span class="user-mention" data-user-id="102902">@Sean</span> I didn't see a way with mapped file to go line-by-line - it's just a big char buffer.  That won't work for this...</p>



<a name="197576693"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197576693" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197576693">(May 14 2020 at 15:58)</a>:</h4>
<p>the benefit of mapped files is when you use the mmap-&gt;buf directly.  you do that to completely avoid user memory allocation, and it avoids unnecessary disk seeking.</p>



<a name="197576764"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197576764" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197576764">(May 14 2020 at 15:58)</a>:</h4>
<p>sure it can</p>



<a name="197576962"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197576962" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197576962">(May 14 2020 at 16:00)</a>:</h4>
<p>Short of manually storing offsets along the buffer...</p>



<a name="197576968"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197576968" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197576968">(May 14 2020 at 16:00)</a>:</h4>
<p>especially with regexes, it's geared for that use case.</p>



<a name="197577049"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197577049" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197577049">(May 14 2020 at 16:00)</a>:</h4>
<p>not following?  why would you store offsets?</p>



<a name="197577085"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197577085" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197577085">(May 14 2020 at 16:01)</a>:</h4>
<p>(we're in the wrong topic - one sec)</p>



<a name="197577162"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197577162" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197577162">(May 14 2020 at 16:01)</a>:</h4>
<p>For reporting I need line numbers, which means I'm processing per-line, not per file string</p>



<a name="197577169"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197577169" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197577169">(May 14 2020 at 16:01)</a>:</h4>
<p>there fixed</p>



<a name="197577181"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197577181" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197577181">(May 14 2020 at 16:01)</a>:</h4>
<p>file stream rather</p>



<a name="197577381"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197577381" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197577381">(May 14 2020 at 16:03)</a>:</h4>
<p>it seems to be literally the bytes in a buffer, which isn't enough structure by itself</p>



<a name="197577383"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197577383" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197577383">(May 14 2020 at 16:03)</a>:</h4>
<p>just because you need line numbers doesn't mean you have to process per-line</p>



<a name="197577422"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197577422" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197577422">(May 14 2020 at 16:03)</a>:</h4>
<p>?</p>



<a name="197577441"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197577441" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197577441">(May 14 2020 at 16:03)</a>:</h4>
<p>not following</p>



<a name="197577663"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197577663" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197577663">(May 14 2020 at 16:04)</a>:</h4>
<p>C/C++ literally has no concept of lines, it's a construct by convention.  a line only exists because we say it exists as denoted by special character values.</p>



<a name="197577724"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197577724" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197577724">(May 14 2020 at 16:05)</a>:</h4>
<p>there is std api that implements that convention, but it's not rote and not the only way</p>



<a name="197578007"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197578007" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197578007">(May 14 2020 at 16:07)</a>:</h4>
<p>the performance gain is had from just keeping track where things are in the -&gt;buf</p>



<a name="197578040"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197578040" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197578040">(May 14 2020 at 16:07)</a>:</h4>
<p>you can certainly find a match with a regex regardless of newlines or with newlines being taken into account</p>



<a name="197578052"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197578052" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197578052">(May 14 2020 at 16:07)</a>:</h4>
<p>for example</p>



<a name="197578347"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197578347" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197578347">(May 14 2020 at 16:09)</a>:</h4>
<p>to find a line number, you just count newlines backwards from a match point (of course, probably would make sense to wrap that 2-liner into a whatsthislinenumber(off_t position) function)</p>



<a name="197578524"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197578524" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197578524">(May 14 2020 at 16:10)</a>:</h4>
<p>but that happens entirely in memory, without a memory copy, so it's instantaneous compared to the alternatives</p>



<a name="197578662"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197578662" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197578662">(May 14 2020 at 16:11)</a>:</h4>
<p>there's probably a c++ helper, but the C was would be to iteratively call strchr() from a match point</p>



<a name="197578998"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197578998" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197578998">(May 14 2020 at 16:13)</a>:</h4>
<p>or literally for (i=pos; i&gt;0; i--) if (buf[i] == newline) linenumber++;</p>



<a name="197579061"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197579061" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197579061">(May 14 2020 at 16:13)</a>:</h4>
<p>just with strchr, you might get lucky and get a vectorized implementation</p>



<a name="197579180"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197579180" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197579180">(May 14 2020 at 16:14)</a>:</h4>
<p>groan... that's a lot of really finicky overhaul for a few seconds, assuming I can get it to work - that would involve ripping out virtually all the std::string usage.</p>



<a name="197579379"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197579379" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197579379">(May 14 2020 at 16:15)</a>:</h4>
<p><em>shrug</em> would be a REALLY good real usecase to learn about performance, but certainly up to you</p>



<a name="197579597"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197579597" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197579597">(May 14 2020 at 16:17)</a>:</h4>
<p>this is applicable everywhere in the code, and particularly relevant given how much you like to use std::string and the stl containers.</p>



<a name="197580136"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197580136" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197580136">(May 14 2020 at 16:20)</a>:</h4>
<p>also it doesn't get any simpler than this.<br>
but you're also right that it's certainly not necessary for this unit test, just rare to have learning opportunities isolated like this.</p>



<a name="197581573"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197581573" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197581573">(May 14 2020 at 16:30)</a>:</h4>
<p>for what it's worth:</p>
<div class="codehilite"><pre><span></span><code>std::string fbuff((char *)ifile-&gt;buf);  // A) this potentially reads entire file from disk, mallocs memory, and copies the entire memory span
std::istringstream fs(fbuff); // B) this potentially mallocs more memory and copies memory, albeit typically in blocksizes but could result in a full allocation duplicate of fbuff
...
while (std::getline(fs, sline) ... // C) this necessary causes an allocation, albeit typically only one blocksize worth
</code></pre></div>



<a name="197581746"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197581746" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197581746">(May 14 2020 at 16:31)</a>:</h4>
<p>&lt;nod&gt;  - there's also some risk that the regex_match calls may malloc under the hood if I feed them const char * inputs - not sure about that</p>



<a name="197581749"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197581749" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197581749">(May 14 2020 at 16:31)</a>:</h4>
<p>gcc and llvm have optimizations that try to defer the allocations in A and B, but they're not guaranteed or portably reliable</p>



<a name="197581986"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197581986" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197581986">(May 14 2020 at 16:33)</a>:</h4>
<p>could be wrong, but I don't think so</p>



<a name="197582107"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197582107" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197582107">(May 14 2020 at 16:34)</a>:</h4>
<p>regfree() releases things allocated by recompile</p>



<a name="197582159"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197582159" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197582159">(May 14 2020 at 16:34)</a>:</h4>
<p>The C library probably doesn't - was thinking about the C++11 implementations.</p>



<a name="197582246"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197582246" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197582246">(May 14 2020 at 16:35)</a>:</h4>
<p>I'd be surprised if they do too... that's old behavior, there's no need for it to allocate unless you do something like request the match in a new object</p>



<a name="197582279"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197582279" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197582279">(May 14 2020 at 16:35)</a>:</h4>
<p>which you definitely don't need for this</p>



<a name="197582947"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197582947" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197582947">(May 14 2020 at 16:40)</a>:</h4>
<p>I mean the implementation certainly could under the hood if they wanted, but that's true of the C version and nearly any API that doesn't explicitly say they don't make syscalls.</p>



<a name="197597878"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197597878" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197597878">(May 14 2020 at 18:28)</a>:</h4>
<p><span class="user-mention" data-user-id="102902">@Sean</span> Is r75802 headed in the direction you were suggesting?</p>



<a name="197598883"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197598883" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197598883">(May 14 2020 at 18:35)</a>:</h4>
<p>yeah, that's definitely in the right direction!  awesome.  fast study!</p>



<a name="197599056"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197599056" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197599056">(May 14 2020 at 18:36)</a>:</h4>
<p>you could make pos_to_line_num a bit faster as you don't need to calculate offset.  can just check NULL result.</p>



<a name="197599215"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197599215" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197599215">(May 14 2020 at 18:37)</a>:</h4>
<p>the fastest version of this probably involves a start-to-end positional parameters so you can accumulate instead of parsing all the way back to the start repeatedly.  still should be really fast, but O(n) vs O(n^2) in the worst case</p>



<a name="197599366"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197599366" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197599366">(May 14 2020 at 18:38)</a>:</h4>
<p>you also might not gain much from the bio.h precheck, might even be slowing it down, but that's easy enough to test and observe.</p>



<a name="197608213"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197608213" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197608213">(May 14 2020 at 19:47)</a>:</h4>
<p><span class="user-mention" data-user-id="102902">@Sean</span> here's the weird part - compared to the prior commit, this version is slower on FreeBSD</p>



<a name="197608761"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197608761" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197608761">(May 14 2020 at 19:52)</a>:</h4>
<p>the only additional work is the repeat backscanning, so pos_to_line_num() could be a bigger issue than I gave it.  not that surprising -- it's going to be more sensitive to cpu.  I can try a profile if you want me to dig deeper, or install them if they're not there if you want to give it a go.</p>



<a name="197608967"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197608967" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197608967">(May 14 2020 at 19:53)</a>:</h4>
<p>I'll fiddle with it a bit first, if you think that's the likely source.  I don't trust FreeBSD's regex performance, but my code is the likelier issue.</p>



<a name="197609110"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197609110" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197609110">(May 14 2020 at 19:54)</a>:</h4>
<p>Would it be worth making a libbu function in the bu/mapped_files.h API that wraps the "correct" position to line number translation, once that's done?  Would be a waste to have to re-invent it down the road if we're going to use mapped file more.</p>



<a name="197609562"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197609562" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197609562">(May 14 2020 at 19:58)</a>:</h4>
<p>I'm not quite following what you're proposing about not calculating the offset.  Don't I have to know that to know when to stop accumulating line counts?</p>



<a name="197609751"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197609751" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197609751">(May 14 2020 at 20:00)</a>:</h4>
<p>perf on linux puts most of the time in the bu_open_mapped_file command, but it's also much faster than FreeBSD so that's probably not a helpful indication.</p>



<a name="197610977"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197610977" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197610977">(May 14 2020 at 20:09)</a>:</h4>
<p>don't think it belongs with mapped files, but could exist as some sort of helper function elsewhere, bu_str_ maybe.  I'd wait until there's a second use case.  More importantly, though -- the faster version of this is probably going to require a different function signature, different args.</p>



<a name="197613356"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197613356" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197613356">(May 14 2020 at 20:28)</a>:</h4>
<p>hm, thinking about it some more, there's potential for a really big performance boost by only loading the top of the file.  that works for the header checks but I guess wouldn't be so great for some of the other checks.</p>



<a name="197613782"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197613782" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197613782">(May 14 2020 at 20:31)</a>:</h4>
<p>I'm only checking the first 500 lines for some  of the checks...</p>



<a name="197613964"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197613964" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197613964">(May 14 2020 at 20:33)</a>:</h4>
<p>Even with the C++ isms I'm sub-second on my ubuntu box, so I'm going to go ahead and wire it in - if nothing else we should be able to git rid of that 600 second timeout special case...</p>



<a name="197614467"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197614467" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197614467">(May 14 2020 at 20:37)</a>:</h4>
<p>cool.</p>



<a name="197622889"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197622889" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197622889">(May 14 2020 at 21:50)</a>:</h4>
<p>Hah - taught it to look for bu_setprogname in files with main()</p>



<a name="197622992"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197622992" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197622992">(May 14 2020 at 21:51)</a>:</h4>
<p>Not totally debugged yet - it's not catching them all - but progress</p>



<a name="197623248"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197623248" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197623248">(May 14 2020 at 21:53)</a>:</h4>
<p>Ah, right - int may be on a different line.  That's more like it - 303 that don't call it</p>



<a name="197623675"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197623675" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197623675">(May 14 2020 at 21:58)</a>:</h4>
<p>&lt;rolls up sleeves&gt;</p>



<a name="197640756"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197640756" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197640756">(May 15 2020 at 02:07)</a>:</h4>
<p>/me peels eyeballs off the monitor and heads for bed</p>



<a name="197708322"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197708322" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197708322">(May 15 2020 at 15:25)</a>:</h4>
<p><span class="user-mention" data-user-id="112516">@starseeker</span> it looks like you changed some of the repository regular expressions, was there a problem?</p>



<a name="197708504"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197708504" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197708504">(May 15 2020 at 15:26)</a>:</h4>
<p>Not really - adjusted slightly what I was checking at which times, mostly</p>



<a name="197708547"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197708547" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197708547">(May 15 2020 at 15:26)</a>:</h4>
<p>Had to un-quote some stuff as well</p>



<a name="197708758"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197708758" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197708758">(May 15 2020 at 15:28)</a>:</h4>
<p>just noticing some of them will match differently now</p>



<a name="197708799"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197708799" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197708799">(May 15 2020 at 15:28)</a>:</h4>
<p>which ones?</p>



<a name="197708804"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197708804" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197708804">(May 15 2020 at 15:28)</a>:</h4>
<p>not sure if it was intentional or fixing a mismatch<br>
looks like you fixed one of the ones changed in 75812</p>



<a name="197708913"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197708913" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197708913">(May 15 2020 at 15:29)</a>:</h4>
<p>I think in one or two cases I simplified while testing, I may have forgotten to put back one or two of the more specific regex strings</p>



<a name="197708949"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197708949" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197708949">(May 15 2020 at 15:29)</a>:</h4>
<p>I know that was one of those cases, there may be others I missed...</p>



<a name="197708976"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197708976" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197708976">(May 15 2020 at 15:29)</a>:</h4>
<p>matching space chars is rather different from matching [[:space:]] ... :)</p>



<a name="197708999"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197708999" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197708999">(May 15 2020 at 15:30)</a>:</h4>
<p>that's not a simplification</p>



<a name="197709070"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197709070" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197709070">(May 15 2020 at 15:30)</a>:</h4>
<p>Heh - I mean simplifying the regex expression while I was debugging setting them up in C++</p>



<a name="197709215"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197709215" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197709215">(May 15 2020 at 15:31)</a>:</h4>
<p>When translating the longer ones a single char misstep could wipe out badly - if I couldn't see what the problem was the first step was to take it back down to something I could readily parse by eye to make sure I hadn't made some more basic mistake.</p>



<a name="197709338"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197709338" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197709338">(May 15 2020 at 15:32)</a>:</h4>
<p>I introduced each problem deliberately into my source tree to detect them, so there is some positive evidence they'll catch things</p>



<a name="197709431"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197709431" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197709431">(May 15 2020 at 15:33)</a>:</h4>
<p>(runs on Windows in &lt;10s, btw)</p>



<a name="197710468"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197710468" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197710468">(May 15 2020 at 15:40)</a>:</h4>
<p>in doing so, I think some matching behavior has changed.  could be wrong, but the regular expressions for the function matches and platform checks look different.  some less aggressive, some more aggressive.</p>



<a name="197710494"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197710494" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197710494">(May 15 2020 at 15:41)</a>:</h4>
<p>great that it's running fast</p>



<a name="197710627"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197710627" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197710627">(May 15 2020 at 15:41)</a>:</h4>
<p>The one behavior I know has changed is that platform symbols are counted per-symbol, not per line - so some of the lines with WIN32 and CYGWIN on one line, for example, are now registering 2 counts instead of 1</p>



<a name="197710725"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197710725" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197710725">(May 15 2020 at 15:42)</a>:</h4>
<p>you're also catching mixed case now, which it wasn't doing before (not saying that's good or bad, just different)</p>



<a name="197710897"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197710897" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197710897">(May 15 2020 at 15:43)</a>:</h4>
<p>you mean the platform symbols?  I thought that was still matching just all upper and all lower...</p>



<a name="197710903"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197710903" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197710903">(May 15 2020 at 15:43)</a>:</h4>
<p>can I make a request on the function tests -- can you make it so the things to match are only on one line?</p>



<a name="197711024"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197711024" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197711024">(May 15 2020 at 15:44)</a>:</h4>
<p>maybe I misread</p>



<a name="197711042"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197711042" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197711042">(May 15 2020 at 15:44)</a>:</h4>
<p>/me checks</p>



<a name="197711068"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197711068" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197711068">(May 15 2020 at 15:44)</a>:</h4>
<p>Oh, you mean the the lists of specific functions and platforms? sure</p>



<a name="197711108"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197711108" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197711108">(May 15 2020 at 15:45)</a>:</h4>
<p>list of platforms is fine, they're one per line</p>



<a name="197711130"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197711130" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197711130">(May 15 2020 at 15:45)</a>:</h4>
<p>functions are on two lines</p>



<a name="197711182"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197711182" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197711182">(May 15 2020 at 15:45)</a>:</h4>
<p>worried that one will get updated and not the other over time</p>



<a name="197711342"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197711342" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197711342">(May 15 2020 at 15:46)</a>:</h4>
<p><span class="user-mention" data-user-id="102902">@Sean</span> where are you looking? not following...</p>



<a name="197711381"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197711381" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197711381">(May 15 2020 at 15:46)</a>:</h4>
<p>api_func_strs</p>



<a name="197711478"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197711478" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197711478">(May 15 2020 at 15:47)</a>:</h4>
<p>oh, wait I see what you're doing now</p>



<a name="197711489"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197711489" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197711489">(May 15 2020 at 15:47)</a>:</h4>
<p>Right - the static array.   Are you referring to the api_exemptions?</p>



<a name="197711575"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/regress-repository/near/197711575" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/regress-repository.html#197711575">(May 15 2020 at 15:48)</a>:</h4>
<p>no, I thought strings were being combined, but I get it now</p>



<hr><p>Last updated: Jul 07 2025 at 01:01 UTC</p>
</html>