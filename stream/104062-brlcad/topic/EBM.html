<html>
<head><meta charset="utf-8"><title>EBM · brlcad · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/index.html">brlcad</a></h2>
<h3>Topic: <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html">EBM</a></h3>

<hr>

<base href="https://brlcad.zulipchat.com">

<head><link href="https://brl-cad.github.io/zulip_archive/style.css" rel="stylesheet"></head>

<a name="184120548"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184120548" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184120548">(Dec 23 2019 at 17:47)</a>:</h4>
<p>Hey <span class="user-mention" data-user-id="102939">@Daniel Rossberg</span> , for now, could you help me work through the EBM task? I'm still not sure how I should be reading bip and then exporting.</p>



<a name="184120739"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184120739" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184120739">(Dec 23 2019 at 17:50)</a>:</h4>
<p>There's this part in the import5() code: </p>
<div class="codehilite"><pre><span></span>/* Get bit map from .bw(5) file */
mp = bu_open_mapped_file_with_path(dbip-&gt;dbi_filepath, eip-&gt;file, &quot;ebm&quot;);
if (!mp) {
    bu_log(&quot;rt_ebm_import4() unable to open &#39;%s&#39;\n&quot;, eip-&gt;file);
    bu_free((char *)eip, &quot;rt_ebm_import4: eip&quot;);
fail:
    ip-&gt;idb_type = ID_NULL;
    ip-&gt;idb_ptr = (void *)NULL;
    return -1;
}
eip-&gt;mp = mp;
if (mp-&gt;buflen &lt; (size_t)(eip-&gt;xdim*eip-&gt;ydim)) {
bu_log(&quot;rt_ebm_import4() file &#39;%s&#39; is too short %zu &lt; %u\n&quot;,
        eip-&gt;file, mp-&gt;buflen, eip-&gt;xdim*eip-&gt;ydim);
goto fail;
}
</pre></div>


<p>But for my implementation, I think that this should only run when datasrc is specified to be 'f'. Otherwise, something else should run instead to read the object, right?</p>



<a name="184120836"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184120836" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184120836">(Dec 23 2019 at 17:52)</a>:</h4>
<p>Oh, is that where the empty get_obj_data() and get_file_data() come into play?</p>



<a name="184153854"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184153854" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184153854">(Dec 24 2019 at 06:33)</a>:</h4>
<p>Hey <span class="user-mention" data-user-id="102902">@Sean</span>, in regards to the fix you mentioned on my task, would this be correct?</p>
<div class="codehilite"><pre><span></span>const struct bu_structparse rt_ebm_parse[] = {
    {&quot;%s&quot;,  RT_EBM_NAME_LEN, &quot;file&quot;, bu_offsetof(struct rt_ebm_internal, file), BU_STRUCTPARSE_FUNC_NULL, NULL, NULL },
    {&quot;%s&quot;,  RT_EBM_NAME_LEN, &quot;name&quot;, bu_offsetof(struct rt_ebm_internal, file), BU_STRUCTPARSE_FUNC_NULL, NULL, NULL },
    {&quot;%c&quot;,  1, &quot;src&quot;,   RT_EBM_O(datasrc),  BU_STRUCTPARSE_FUNC_NULL, NULL, NULL },
    {&quot;%d&quot;,  1, &quot;w&quot;,     RT_EBM_O(xdim),     BU_STRUCTPARSE_FUNC_NULL, NULL, NULL },
    {&quot;%d&quot;,  1, &quot;n&quot;,     RT_EBM_O(ydim),     BU_STRUCTPARSE_FUNC_NULL, NULL, NULL },
    {&quot;%f&quot;,  1, &quot;d&quot;,     RT_EBM_O(tallness), BU_STRUCTPARSE_FUNC_NULL, NULL, NULL },
    {&quot;%f&quot;,  16, &quot;mat&quot;, bu_offsetof(struct rt_ebm_internal, mat), BU_STRUCTPARSE_FUNC_NULL, NULL, NULL },
    {&quot;&quot;,    0, (char *)0, 0,            BU_STRUCTPARSE_FUNC_NULL, NULL, NULL }
};
</pre></div>



<a name="184153905"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184153905" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184153905">(Dec 24 2019 at 06:34)</a>:</h4>
<p>I took a look at the DSP example and noticed that there was something called <code>hook_file</code> in place of <code>BU_STRUCTPARSE_FUNC_NULL</code>, but I couldn't seem to find it in EBM</p>



<a name="184153981"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184153981" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184153981">(Dec 24 2019 at 06:37)</a>:</h4>
<p>Also, is it alright if my submission patch for the second task also includes the patches from the first?</p>



<a name="184154044"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184154044" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184154044">(Dec 24 2019 at 06:39)</a>:</h4>
<p>hey <span class="user-mention" data-user-id="250111">@Jeffrey Liu</span> sorry for missing all your questions since you started that hard task... just a bit under the weather with a cold and it's taken up some of my energy</p>



<a name="184154090"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184154090" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184154090">(Dec 24 2019 at 06:40)</a>:</h4>
<p>No worries! I managed to figure it out and I understand that the mentors are obviously busy outside of GCI. I hope you're feeling better now?</p>



<a name="184154091"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184154091" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184154091">(Dec 24 2019 at 06:40)</a>:</h4>
<blockquote>
<p>Also, is it alright if my submission patch for the second task also includes the patches from the first?</p>
</blockquote>
<p>if the first patch isn't applied yet, then yes but then you can also just post it as an update to the same patch</p>



<a name="184154153"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184154153" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184154153">(Dec 24 2019 at 06:42)</a>:</h4>
<p>just keep an eye out, run svn up and check svn log to see if/when it gets applied.  I was going to tonight, but alas <em>cough</em> <em>cough</em> I'm still feeling pretty crappy and need to get some extra sleep</p>



<a name="184154222"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184154222" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184154222">(Dec 24 2019 at 06:44)</a>:</h4>
<p>Ah it's alright, I don't want to keep you up if you're sick - so would it be fine if I just reran <code>svn diff &gt; ...</code> when applying my changes, even if the previous ones are still there?</p>



<a name="184154226"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184154226" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184154226">(Dec 24 2019 at 06:44)</a>:</h4>
<p>as long as you keep running "svn up" first, sure</p>



<a name="184154227"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184154227" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184154227">(Dec 24 2019 at 06:45)</a>:</h4>
<p>that way, it should merge</p>



<a name="184154236"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184154236" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184154236">(Dec 24 2019 at 06:45)</a>:</h4>
<p>just keep an eye out for conflicts as you'd have to resolve those before running diff</p>



<a name="184154285"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184154285" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184154285">(Dec 24 2019 at 06:46)</a>:</h4>
<p>Ok that makes sense, thanks for the advice!</p>



<a name="184154300"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184154300" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184154300">(Dec 24 2019 at 06:47)</a>:</h4>
<p>So regarding the other question I just asked, is that all I should change, or am I missing something?</p>



<a name="184154542"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184154542" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184154542">(Dec 24 2019 at 06:54)</a>:</h4>
<p>your patch has been applied</p>



<a name="184154552"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184154552" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sumagna Das <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184154552">(Dec 24 2019 at 06:55)</a>:</h4>
<p>(deleted)</p>



<a name="184154553"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184154553" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184154553">(Dec 24 2019 at 06:55)</a>:</h4>
<p>only problem is you're using the wrong whitespace rules (presumably in MSVC or visual code)</p>



<a name="184154556"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184154556" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184154556">(Dec 24 2019 at 06:55)</a>:</h4>
<p>jeffrey's ebm patch</p>



<a name="184154559"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184154559" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sumagna Das <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184154559">(Dec 24 2019 at 06:55)</a>:</h4>
<p>ok</p>



<a name="184154602"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184154602" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184154602">(Dec 24 2019 at 06:56)</a>:</h4>
<p>Shoot, I can take a look at it again if there's something wrong. Was it something specific or just in general?</p>



<a name="184154618"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184154618" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184154618">(Dec 24 2019 at 06:57)</a>:</h4>
<p>you need to set your indentation to 4 char indent, tab at 8</p>



<a name="184154660"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184154660" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184154660">(Dec 24 2019 at 06:58)</a>:</h4>
<p>Alright, I will do that. Sorry for the inconvenience</p>



<a name="184154661"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184154661" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184154661">(Dec 24 2019 at 06:58)</a>:</h4>
<p>I believe you set the tab size to 4, but tab size should be 8, indentation is 4</p>



<a name="184154665"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184154665" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184154665">(Dec 24 2019 at 06:58)</a>:</h4>
<p>your patch is applied in r74544</p>



<a name="184154682"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184154682" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184154682">(Dec 24 2019 at 07:00)</a>:</h4>
<p>Great! I'll update now and then continue working. It seems like I was a bit behind on the revisions before though, and some CMake files got updated. Is it necessary for me to reconfigure everything and then recompile?</p>



<a name="184155443"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184155443" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184155443">(Dec 24 2019 at 07:22)</a>:</h4>
<p>Hey <span class="user-mention" data-user-id="102902">@Sean</span>, sorry to bother you again but I had one last question when I was reading through your comment. Would it be enough to add two entries to rt_ebm_parse like this,</p>
<div class="codehilite"><pre><span></span>{&quot;%s&quot;,  RT_EBM_NAME_LEN, &quot;file&quot;, bu_offsetof(struct rt_ebm_internal, file), BU_STRUCTPARSE_FUNC_NULL, NULL, NULL },
{&quot;%s&quot;,  RT_EBM_NAME_LEN, &quot;name&quot;, bu_offsetof(struct rt_ebm_internal, file), BU_STRUCTPARSE_FUNC_NULL, NULL, NULL },
</pre></div>


<p>or would I also have to change something to the other arguments as well?</p>



<a name="184155459"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184155459" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184155459">(Dec 24 2019 at 07:23)</a>:</h4>
<p>yeah, that's not the desired end state</p>



<a name="184155464"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184155464" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184155464">(Dec 24 2019 at 07:23)</a>:</h4>
<p>so notice the actual struct -- struct rt_ebm_internal</p>



<a name="184155505"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184155505" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184155505">(Dec 24 2019 at 07:24)</a>:</h4>
<p>it currently has a file field, but that is what's changing to just a name</p>



<a name="184155507"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184155507" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184155507">(Dec 24 2019 at 07:24)</a>:</h4>
<p>that name might be a file or might be an object</p>



<a name="184155509"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184155509" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184155509">(Dec 24 2019 at 07:24)</a>:</h4>
<p>the field should get renamed, but if you do that, then bu_offsetof() has to be updated</p>



<a name="184155518"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184155518" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184155518">(Dec 24 2019 at 07:25)</a>:</h4>
<p>Oh right, my bad for not noticing that. If I recall correctly, there's a bu function that can be used to get the offset of a string. Should I be using that?</p>



<a name="184155519"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184155519" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184155519">(Dec 24 2019 at 07:25)</a>:</h4>
<p>you are correct though in that you do want to structparse entries, one for "file" and one for "name" as those are strings that get serialized out to the .g file, but both will point to the renamed 'name' field</p>



<a name="184155558"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184155558" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184155558">(Dec 24 2019 at 07:26)</a>:</h4>
<p>no</p>



<a name="184155561"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184155561" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184155561">(Dec 24 2019 at 07:26)</a>:</h4>
<p>that's a bit of mildly advanced C going on there, no worries</p>



<a name="184155565"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184155565" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184155565">(Dec 24 2019 at 07:26)</a>:</h4>
<p>what that {...} line is doing is initializing an array with a bunch of field that help with parsing C structs automatically</p>



<a name="184155576"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184155576" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184155576">(Dec 24 2019 at 07:28)</a>:</h4>
<p>one of the columns there is bu_offset(...) .. what that is actually doing is reporting how many bytes into a "struct rt_ebm_internal" one can find a field named "file"</p>



<a name="184155619"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184155619" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184155619">(Dec 24 2019 at 07:28)</a>:</h4>
<p>if you rename file to name, you'll have to update that label to name as well</p>



<a name="184155631"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184155631" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184155631">(Dec 24 2019 at 07:28)</a>:</h4>
<p>Ah I see, so the only change that needs to be made is to change the second line's <code>file</code> to <code>name</code> again?</p>



<a name="184155701"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184155701" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184155701">(Dec 24 2019 at 07:30)</a>:</h4>
<p>no, you want a "file" line and a "name" line, but the byte offset for both will be to a name field after you rename the field in rt_ebm_internal</p>



<a name="184155725"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184155725" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184155725">(Dec 24 2019 at 07:31)</a>:</h4>
<p>oh wait, so both should be changed to <code>name</code>? Sorry I didn't really understand what the second argument was doing at first, as it wasn't a traditional string</p>



<a name="184155771"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184155771" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184155771">(Dec 24 2019 at 07:32)</a>:</h4>
<p>yeah, it's understandably confusing. it's a macro.</p>



<a name="184155791"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184155791" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184155791">(Dec 24 2019 at 07:33)</a>:</h4>
<p>getting byte offsets at compile-time requires a little bit of machinery</p>



<a name="184155844"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184155844" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184155844">(Dec 24 2019 at 07:34)</a>:</h4>
<p>if you did kernel development, you might become familiar with the C offsetof() macro which this is modeled after but portably cross-platform</p>



<a name="184155849"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184155849" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184155849">(Dec 24 2019 at 07:34)</a>:</h4>
<p>alright, gotta run.  keep up the great work!</p>



<a name="184155862"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184155862" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184155862">(Dec 24 2019 at 07:34)</a>:</h4>
<p>Ah ok, I think I'm starting to understand it more now. Thanks so much for your help! Hope you feel better soon :)</p>



<a name="184210511"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184210511" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184210511">(Dec 25 2019 at 09:37)</a>:</h4>
<p>Hey <span class="user-mention" data-user-id="102902">@Sean</span> , I mentioned a couple of extra changes I did on to the patch after my submission was approved - it seems like there were some things that I initially neglected to change. With the changes, the tests I've done seemed to have worked correctly (with the file input being default for the time being).  Sorry for the inconvenience!</p>



<a name="184210573"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184210573" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184210573">(Dec 25 2019 at 09:39)</a>:</h4>
<p>Here's the updated patch by the way - most of it was just me forgetting to change <code>eip-&gt;file</code> to <code>eip-&gt;name</code> after changing <code>rt_ebm_internal</code> struct parameter.<br>
<a href="/user_uploads/1549/hTd5VFwF73EsbHlKrEuFAZ9t/ebm2_updated.patch" target="_blank" title="ebm2_updated.patch">ebm2_updated.patch</a></p>



<a name="184210742"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184210742" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184210742">(Dec 25 2019 at 09:44)</a>:</h4>
<p>Also one last minor thing, while I was looking through typein.c, I noticed that the first line for <code>p_dsp_v5</code>, which is "Take data from file or database binary object [f|o]:" is missing a space at the end while the others all have one. Even though it's not related to EBM, could I add on the space for my next patch?</p>



<a name="184226548"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184226548" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184226548">(Dec 25 2019 at 18:14)</a>:</h4>
<p>Oh by the way, since C doesn't support function overloading, I'm getting an error when I try to add <code>get_file_data()</code> into src/librt/primitives/ebm/ebm.c because it already exists in src/librt/primitives/dsp/dsp.c; any idea how I could work around this?</p>



<a name="184226668"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184226668" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184226668">(Dec 25 2019 at 18:18)</a>:</h4>
<p>It seems like the easiest option would be to just rename the functions in both files to something more specific like <code>get_ebm_file_data()</code> and <code>get_dsp_file_data()</code>, but I didn't want to change anything externally without permission. Would this solution be ok?</p>



<a name="184237740"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184237740" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Thusal Ranawaka <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184237740">(Dec 26 2019 at 01:02)</a>:</h4>
<p><span class="user-mention" data-user-id="103542">@Erik</span> Hi, Erik.</p>



<a name="184238619"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184238619" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184238619">(Dec 26 2019 at 01:37)</a>:</h4>
<p><span class="user-mention" data-user-id="250111">@Jeffrey Liu</span>  Hm.  What about marking the functions as static?  Do they need to be externally visible beyond their own files?</p>



<a name="184238710"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184238710" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184238710">(Dec 26 2019 at 01:40)</a>:</h4>
<p>Oh, that works as well since they're only needed within the file. Thanks for the advice!</p>



<a name="184238961"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184238961" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184238961">(Dec 26 2019 at 01:50)</a>:</h4>
<p>Hmm... Looking at the HIDDEN macro definition, it should already be static, but I was getting some errors before</p>



<a name="184238969"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184238969" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184238969">(Dec 26 2019 at 01:51)</a>:</h4>
<p>Do I need to define NDEBUG myself?</p>



<a name="184240999"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184240999" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184240999">(Dec 26 2019 at 03:08)</a>:</h4>
<p>I would just use static directly, without using HIDDEN - I don't know that we'll be keeping HIDDEN in the long run anyway</p>



<a name="184241004"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184241004" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184241004">(Dec 26 2019 at 03:09)</a>:</h4>
<p>Hidden conditionally sets static, IIRC - Sean can give you more of the history there.</p>



<a name="184241264"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184241264" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184241264">(Dec 26 2019 at 03:18)</a>:</h4>
<p>Oh, right - it's in the common.h definition comment.  Evidently someone found it useful to disable static for debugging purposes.  I think there have been some discussions about the utility of that vs. losing the locality to the file that static is supposed to bring - my own thought is that it would be better to manually change the function names around in the (rare) case where we want to un-static a function for debugging and use static directly in its normal behavior all other times, but I don't remember for sure if that's where the consensus landed.</p>



<a name="184242138"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184242138" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184242138">(Dec 26 2019 at 03:49)</a>:</h4>
<p>Ah ok, thanks for the explanation! I was just using it because it was being used in dsp.c - should I change it from HIDDEN to static in both dsp.c and ebm.c?</p>



<a name="184251518"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184251518" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184251518">(Dec 26 2019 at 08:54)</a>:</h4>
<p><span class="user-mention" data-user-id="250111">@Jeffrey Liu</span>  You can, but shouldn't have to - as long as the ebm version is static, it shouldn't interfere with the dsp version.</p>



<a name="184298546"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184298546" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184298546">(Dec 27 2019 at 04:30)</a>:</h4>
<p>Hey <span class="user-mention" data-user-id="102902">@Sean</span> , for the fourth task, I noticed that there are other functions that currently rely upon the fact that EBM only supports file data at the moment. Should I update them as well?</p>



<a name="184298624"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184298624" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184298624">(Dec 27 2019 at 04:32)</a>:</h4>
<p>For example, <code>rt_ebm_prep</code> or <code>rt_ebm_bbox</code> seem to rely on <code>eip-&gt;mp</code>, unless I'm mistaken?</p>



<a name="184299011"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184299011" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184299011">(Dec 27 2019 at 04:46)</a>:</h4>
<p>I'm pretty sure get_obj_data() is working properly because a success statement is getting printed at the end of the function, but MGED still ends up crashing when I try to import from obj</p>



<a name="184308415"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184308415" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184308415">(Dec 27 2019 at 08:37)</a>:</h4>
<p>I've been working for a while now but I still have no idea what's causing the crashing... this is my current patch: <a href="/user_uploads/1549/SEQfwfGqbj3Pjjt2-CEIofzf/get_obj_data.patch" target="_blank" title="get_obj_data.patch">get_obj_data.patch</a> , and the file reading is still working, but MGED is still crashing when I try to use a database object as the data source.</p>



<a name="184308432"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184308432" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184308432">(Dec 27 2019 at 08:37)</a>:</h4>
<p>Could I get some help?</p>



<a name="184320644"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184320644" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184320644">(Dec 27 2019 at 13:17)</a>:</h4>
<p><span class="user-mention" data-user-id="250111">@Jeffrey Liu</span>  Are you able to attach a debugger to MGED to see where it is crashing?  <a href="https://docs.microsoft.com/en-us/visualstudio/debugger/attach-to-running-processes-with-the-visual-studio-debugger?view=vs-2019" target="_blank" title="https://docs.microsoft.com/en-us/visualstudio/debugger/attach-to-running-processes-with-the-visual-studio-debugger?view=vs-2019">https://docs.microsoft.com/en-us/visualstudio/debugger/attach-to-running-processes-with-the-visual-studio-debugger?view=vs-2019</a></p>



<a name="184320704"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184320704" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184320704">(Dec 27 2019 at 13:18)</a>:</h4>
<p>If you launch a debug build of MGED, attach the debugger and then try your ebm operation you should be able to see where it is wiping out...</p>



<a name="184320728"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184320728" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Thusal Ranawaka <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184320728">(Dec 27 2019 at 13:19)</a>:</h4>
<p><span class="user-mention" data-user-id="112516">@starseeker</span> Do you know how to build LibreCAD v3 from the source?</p>



<a name="184320740"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184320740" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184320740">(Dec 27 2019 at 13:19)</a>:</h4>
<p><span class="user-mention" data-user-id="253014">@Thusal Ranawaka</span> no, sorry</p>



<a name="184320784"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184320784" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Thusal Ranawaka <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184320784">(Dec 27 2019 at 13:20)</a>:</h4>
<blockquote>
<p><span class="user-mention silent" data-user-id="253014">Thusal Ranawaka</span> no, sorry</p>
</blockquote>
<p>It's okay.</p>



<a name="184320825"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184320825" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184320825">(Dec 27 2019 at 13:20)</a>:</h4>
<p><span class="user-mention" data-user-id="253014">@Thusal Ranawaka</span> Remember to ask unrelated questions in another channel (this one is specific to the EBM primitive task)</p>



<a name="184320990"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184320990" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184320990">(Dec 27 2019 at 13:24)</a>:</h4>
<p><span class="user-mention" data-user-id="250111">@Jeffrey Liu</span>  Without looking too closely at the code, I would expect that you'll need to update any of the other ebm functions that depend on a file being present for raytracing to work without crashing, but I'm not sure which functionality is called by the import command - this is a situation where the debugger would be helpful.</p>



<a name="184332646"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184332646" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184332646">(Dec 27 2019 at 17:14)</a>:</h4>
<p>Ah ok, thanks for the advice! I didn't even know attaching debuggers was a thing - I'll try it out right now.</p>



<a name="184334084"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184334084" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184334084">(Dec 27 2019 at 17:44)</a>:</h4>
<p>This was the exception indicated: <a href="/user_uploads/1549/Gct-HhJOmLNg_ejyI629x_uq/pasted_image.png" target="_blank" title="pasted_image.png">pasted image</a> I'll try to see what's going on but it definitely seems like it has to do with the file dependency</p>
<div class="message_inline_image"><a href="/user_uploads/1549/Gct-HhJOmLNg_ejyI629x_uq/pasted_image.png" target="_blank" title="pasted image"><img src="/user_uploads/1549/Gct-HhJOmLNg_ejyI629x_uq/pasted_image.png"></a></div>



<a name="184334258"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184334258" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184334258">(Dec 27 2019 at 17:48)</a>:</h4>
<p>So the issue lies in rt_ebm_plot()?</p>



<a name="184334454"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184334454" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184334454">(Dec 27 2019 at 17:52)</a>:</h4>
<p>Ok so I'm not completely sure, but I think this is where the issue is</p>
<div class="codehilite"><pre><span></span>#define BIT(_eip, _xx, _yy) \
    ((unsigned char *)((_eip)-&gt;mp-&gt;apbuf))[ ((_yy)+BIT_YWIDEN)*((_eip)-&gt;xdim + BIT_XWIDEN*2)+(_xx)+BIT_XWIDEN ]
</pre></div>



<a name="184334473"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184334473" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184334473">(Dec 27 2019 at 17:53)</a>:</h4>
<p>Where the call to <code>eip-&gt;mp</code> results in an exception being thrown</p>



<a name="184334657"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184334657" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184334657">(Dec 27 2019 at 17:56)</a>:</h4>
<p>Or actually, it seems like this is the line throwing the actual exception <code>base = y</code>, but I think that's being caused by the BIT macro</p>



<a name="184335357"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184335357" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184335357">(Dec 27 2019 at 18:12)</a>:</h4>
<p>Ok... so change <code>(_eip)-&gt;mp-&gt;apbuf</code> to <code>(_eip)-&gt;buf</code> solves the crashing, but now it looks like something is being read incorrectly which is probably a separate issue</p>



<a name="184341331"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184341331" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184341331">(Dec 27 2019 at 20:14)</a>:</h4>
<p>I'm still having some issues with the BIT macro, object reading isn't crashing but it's producing some weird results, and now file reading is crashing with a similar issue as what was happening with the object reading before</p>



<a name="184341363"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184341363" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184341363">(Dec 27 2019 at 20:15)</a>:</h4>
<p>I tried changing the logic of get_file_data() to the one found in dsp, because it looked like it was writing to eip-&gt;mp-&gt;apbuf before, but the issue is still there</p>



<a name="184352063"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184352063" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184352063">(Dec 28 2019 at 00:44)</a>:</h4>
<p>I've tried everything I could think of so far, but nothing has been working for me. Depending on how I change BIT or get_file_data(), either file or object reading gets messed up. I'm pretty sure my change to BIT was correct, since other functions will rely on it to access the data, but even after changing get_file_data() to mimic the one from dsp.c, I'm still getting a read access violation during rt_ebm_plot().</p>



<a name="184352198"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184352198" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184352198">(Dec 28 2019 at 00:49)</a>:</h4>
<p>What I don't understand is why it works for DSP, but not for this. From what I can tell, they're almost identical in terms of logic</p>



<a name="184359997"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184359997" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184359997">(Dec 28 2019 at 05:18)</a>:</h4>
<p>For the weird results from object reading: removing the bit offsets from the BIT macro seems to fix it? File reading still isn't working though.</p>



<a name="184360010"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184360010" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184360010">(Dec 28 2019 at 05:19)</a>:</h4>
<p><span class="user-mention" data-user-id="102902">@Sean</span> if you're available, could you help me with this? I still can't manage to get both working together.</p>



<a name="184362426"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184362426" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184362426">(Dec 28 2019 at 06:36)</a>:</h4>
<p>My best guess is that since <code>mp</code> goes out of scope, the pointer gets freed while <code>eip-&gt;mp</code> is still pointing to that location, but if that's the case, then I'm not sure why it works for dsp?</p>



<a name="184363759"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184363759" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184363759">(Dec 28 2019 at 07:22)</a>:</h4>
<p>Nope, I don't think that was it because I tried doing it without <code>mp</code> and the issue still occurs. This is what I'm currently trying <a href="/user_uploads/1549/jQxL8qTxqht06cl35i4Pd9Lu/file_reading_error.patch" target="_blank" title="file_reading_error.patch">file_reading_error.patch</a> and this is the error that is occurring when I attach a debugger to MGED:</p>
<div class="codehilite"><pre><span></span>Exception thrown: read access violation.
eip-&gt;**buf** was 0x1110347A42F0112. occurred
</pre></div>


<p>I'm pretty much out of ideas by now, so any help would be much appreciated.</p>



<a name="184383633"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184383633" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184383633">(Dec 28 2019 at 17:33)</a>:</h4>
<p><span class="user-mention" data-user-id="250111">@Jeffrey Liu</span> All I can suggest without stepping it through a debugger (unfortunately I don't have time for right now) is to look very carefully at each piece of the macro in question and what is in memory at the specific memory addresses in question, to make sure you understand what it intends to do vs what it is actually doing.  Another action sometimes helpful is to expand the macro to the actual code being compiled and see if that is easier to follow.</p>



<a name="184384379"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184384379" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184384379">(Dec 28 2019 at 17:55)</a>:</h4>
<p>Thanks for the advice! I'll look through it again and hopefully I can make some progress now that I've taken a break from it for a while</p>



<a name="184388946"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184388946" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184388946">(Dec 28 2019 at 20:03)</a>:</h4>
<p>Hm.. so I'm trying to track the differences in execution between DSP and EBM, and I think the main difference is that this conditional gets evaluated differently <code>(bu_cv_optimize(in_cookie) != bu_cv_optimize(out_cookie))</code>, where DSP evaluates this as true whereas EBM evaluates it as false. I'll have to look more into the function itself, but the values of <code>in_cookie</code> and <code>out_cookie</code> are different?</p>



<a name="184389066"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184389066" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184389066">(Dec 28 2019 at 20:07)</a>:</h4>
<p>Oh, so I guess the output of <code>bu_cv_optimize</code> end up becoming the same for <code>in_cookie</code> and <code>out_cookie</code> even though they're initially different.</p>



<a name="184389109"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184389109" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184389109">(Dec 28 2019 at 20:08)</a>:</h4>
<p>hi <span class="user-mention" data-user-id="250111">@Jeffrey Liu</span></p>



<a name="184389111"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184389111" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184389111">(Dec 28 2019 at 20:08)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="102902">@Sean</span> !</p>



<a name="184389112"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184389112" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184389112">(Dec 28 2019 at 20:08)</a>:</h4>
<p>I have a lot of messages to catch up on, but one thing to notice is that the datatype for EBM and DSP are different</p>



<a name="184389120"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184389120" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184389120">(Dec 28 2019 at 20:09)</a>:</h4>
<p>DSP reads 16-bit unsigned integers</p>



<a name="184389124"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184389124" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184389124">(Dec 28 2019 at 20:09)</a>:</h4>
<p>I replaced "s" with "c" and 16 with 8 anywhere I could notice, but perhaps I might have missed something</p>



<a name="184389164"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184389164" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184389164">(Dec 28 2019 at 20:10)</a>:</h4>
<p>EBM reads 8-bit unsigned integers (I think, have to double-check)</p>



<a name="184389180"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184389180" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184389180">(Dec 28 2019 at 20:10)</a>:</h4>
<p>the original ebm code would have been correct, it's just the translation needed for reading it from an in-memory correctly that should be needed, and to make sure it's not getting double-converter</p>



<a name="184389181"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184389181" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184389181">(Dec 28 2019 at 20:11)</a>:</h4>
<p>*converted</p>



<a name="184389192"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184389192" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184389192">(Dec 28 2019 at 20:11)</a>:</h4>
<p>Oh, so I should keep the original file reading logic?</p>



<a name="184389233"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184389233" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184389233">(Dec 28 2019 at 20:12)</a>:</h4>
<p>you'll need to have the same logic when the source is a file :)</p>



<a name="184389294"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184389294" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184389294">(Dec 28 2019 at 20:14)</a>:</h4>
<p>I think I tried something like <code>eip-&gt;buf = (unsigned char *)eip-&gt;mp-&gt;apbuf</code> at the end of the original code before, but it still didn't work. I'll try it again just to make sure though</p>



<a name="184389315"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184389315" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184389315">(Dec 28 2019 at 20:16)</a>:</h4>
<p>Is that what you meant by translating it?</p>



<a name="184389371"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184389371" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184389371">(Dec 28 2019 at 20:17)</a>:</h4>
<p>no no</p>



<a name="184389420"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184389420" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184389420">(Dec 28 2019 at 20:18)</a>:</h4>
<p>so first off, the translation for 8-bit (i.e., 1-byte) data is simple</p>



<a name="184389422"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184389422" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184389422">(Dec 28 2019 at 20:18)</a>:</h4>
<p>you just have to copy memory (or reference existing)</p>



<a name="184389443"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184389443" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184389443">(Dec 28 2019 at 20:19)</a>:</h4>
<p>previously, for file-based source, ebm mapped the file into memory with bu_open_mapped_file_with_path()</p>



<a name="184389449"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184389449" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184389449">(Dec 28 2019 at 20:19)</a>:</h4>
<p>then it "translates" it into ebm in-memory form with a simple memcpy() loop over the data</p>



<a name="184389517"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184389517" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184389517">(Dec 28 2019 at 20:21)</a>:</h4>
<p>for dsp, the translation is a bit more complicated because it's 2-byte data and it has to make sure the bytes are in the right order (ABABAB... vs BABABA...)</p>



<a name="184389523"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184389523" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184389523">(Dec 28 2019 at 20:21)</a>:</h4>
<p>that's where the bu_cv_... comes in, it does that more complicated translation</p>



<a name="184389530"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184389530" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184389530">(Dec 28 2019 at 20:21)</a>:</h4>
<p>however, for ebm, it's really super simple -- it's just a copy</p>



<a name="184389588"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184389588" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184389588">(Dec 28 2019 at 20:22)</a>:</h4>
<p>Ohh, that makes sense, so I guess that means my current object reading is also incorrect then?</p>



<a name="184389589"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184389589" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184389589">(Dec 28 2019 at 20:22)</a>:</h4>
<p>rather, it can be just a copy.  heck, it probably doesn't not even need to copy it for the binunif case since  its already in memory</p>



<a name="184389599"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184389599" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184389599">(Dec 28 2019 at 20:23)</a>:</h4>
<p>what's the current code you have look like?</p>



<a name="184389604"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184389604" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184389604">(Dec 28 2019 at 20:23)</a>:</h4>
<p>It was pretty much the same thing as the dsp version, with changes to indicate that it was unsigned char</p>



<a name="184389654"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184389654" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184389654">(Dec 28 2019 at 20:24)</a>:</h4>
<div class="codehilite"><pre><span></span>static int
get_obj_data(struct rt_ebm_internal *eip, const struct db_i *dbip)
{
    struct rt_binunif_internal *bip;
    int in_cookie, out_cookie;
    size_t got;
    int ret;

    BU_ALLOC(eip-&gt;bip, struct rt_db_internal);

    ret = rt_retrieve_binunif(eip-&gt;bip, dbip, eip-&gt;name);
    if (ret)
    return -1;

    if (RT_G_DEBUG &amp; RT_DEBUG_HF) {
    bu_log(&quot;db_internal magic: 0x%08x  major: %d  minor: %d\n&quot;,
        eip-&gt;bip-&gt;idb_magic,
        eip-&gt;bip-&gt;idb_major_type,
        eip-&gt;bip-&gt;idb_minor_type);
    }

    bip = (struct rt_binunif_internal *)eip-&gt;bip-&gt;idb_ptr;

    if (RT_G_DEBUG &amp; RT_DEBUG_HF)
    bu_log(&quot;binunif magic: 0x%08x  type: %d count:%zu data[0]:%u\n&quot;,
        bip-&gt;magic, bip-&gt;type, bip-&gt;count, bip-&gt;u.uint8[0]);

    if (bip-&gt;type != DB5_MINORTYPE_BINU_8BITINT_U
    || (size_t)bip-&gt;count != (size_t)(eip-&gt;xdim*eip-&gt;ydim))
    {
    size_t i = 0;
    size_t size;
    struct bu_vls binudesc = BU_VLS_INIT_ZERO;
    rt_binunif_describe(&amp;binudesc, eip-&gt;bip, 0, dbip-&gt;dbi_base2local);

    /* skip the first title line */
    size = bu_vls_strlen(&amp;binudesc);
    while (size &gt; 0 &amp;&amp; i &lt; size &amp;&amp; bu_vls_cstr(&amp;binudesc)[0] != &#39;\n&#39;) {
        bu_vls_nibble(&amp;binudesc, 1);
    }
    if (bu_vls_cstr(&amp;binudesc)[0] == &#39;\n&#39;)
        bu_vls_nibble(&amp;binudesc, 1);

    bu_log(&quot;ERROR: Binary object &#39;%s&#39; has invalid data (expected type %d, found %d).\n&quot;
           &quot;       Expecting %zu 8-bit unsigned char (nuc) integer data values.\n&quot;
           &quot;       Encountered %s\n&quot;,
           eip-&gt;name,
           DB5_MINORTYPE_BINU_8BITINT_U,
           bip-&gt;type,
           (size_t)(eip-&gt;xdim * eip-&gt;ydim),
           bu_vls_cstr(&amp;binudesc));
    return -2;
    }

    in_cookie = bu_cv_cookie(&quot;nuc&quot;); /* data is network unsigned char */
    out_cookie = bu_cv_cookie(&quot;huc&quot;);

    if (bu_cv_optimize(in_cookie) != bu_cv_optimize(out_cookie)) {
    /* if we&#39;re on a little-endian machine we convert the input
     * file from network to host format
     */

    got = bu_cv_w_cookie(bip-&gt;u.uint8, out_cookie,
                 bip-&gt;count * sizeof(unsigned char),
                 bip-&gt;u.uint8, in_cookie, bip-&gt;count);

    if (got != bip-&gt;count) {
        bu_log(&quot;got %zu != count %zu&quot;, got, bip-&gt;count);
        bu_bomb(&quot;\n&quot;);
    }
    }

    eip-&gt;buf = bip-&gt;u.uint8;
    return 0;
}
</pre></div>



<a name="184389660"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184389660" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184389660">(Dec 28 2019 at 20:24)</a>:</h4>
<p>so this is to get it from a binunif ... which assumes you created the binunif correctly</p>



<a name="184389738"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184389738" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184389738">(Dec 28 2019 at 20:26)</a>:</h4>
<p>Wait, was this not how it was supposed to look? My understanding was that the process would be something like <code>bo -i u C dbobj bw-image.bw</code> and then <code>in ebm ebm o dbobj 256 256 20</code>, which is how I've been creating DSPs from database objects.</p>



<a name="184389797"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184389797" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184389797">(Dec 28 2019 at 20:28)</a>:</h4>
<p>no, I think that's right ... and I wasn't suggesting it wasn't right, just that the code obviously needs it to BE right, not just assume it's right :)</p>



<a name="184389817"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184389817" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184389817">(Dec 28 2019 at 20:29)</a>:</h4>
<p>Whew, I was scared that I was approaching this completely incorrectly... the issue I had with using the original EBM code for file reading and this code for the object reading was that the BIT macro got messed up</p>



<a name="184389891"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184389891" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184389891">(Dec 28 2019 at 20:31)</a>:</h4>
<p>Since it uses <code>(_eip)-&gt;mp-&gt;apbuf</code>, which only works for file-based sources?</p>



<a name="184389937"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184389937" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184389937">(Dec 28 2019 at 20:32)</a>:</h4>
<p>you're definitely on the right track.  if anything, you're just a bit too complicated in how closely your mimicing the dsp code because it's got a more complicated data format</p>



<a name="184389965"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184389965" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184389965">(Dec 28 2019 at 20:33)</a>:</h4>
<p>but it's not to say it can't work. it definitely can.  just need to check data at every step along the way.</p>



<a name="184390006"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184390006" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184390006">(Dec 28 2019 at 20:34)</a>:</h4>
<p>what BIT macro?</p>



<a name="184390078"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184390078" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184390078">(Dec 28 2019 at 20:37)</a>:</h4>
<p>This one:</p>
<div class="codehilite"><pre><span></span>#define BIT(_eip, _xx, _yy) \
    ((unsigned char *)((_eip)-&gt;mp-&gt;apbuf))[ ((_yy)+BIT_YWIDEN)*((_eip)-&gt;xdim + BIT_XWIDEN*2)+(_xx)+BIT_XWIDEN ]
</pre></div>



<a name="184390089"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184390089" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184390089">(Dec 28 2019 at 20:37)</a>:</h4>
<p>I think it's used to access the data at a specific coordinate?</p>



<a name="184390226"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184390226" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184390226">(Dec 28 2019 at 20:41)</a>:</h4>
<p>Oh so for the object reading, is the whole part with the bu_cv... unnecessary, since there's no need for complicated translations?</p>



<a name="184390228"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184390228" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184390228">(Dec 28 2019 at 20:41)</a>:</h4>
<p>ah, not exactly -- in fact I was wrong about EBM using 1-byte data</p>



<a name="184390274"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184390274" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184390274">(Dec 28 2019 at 20:42)</a>:</h4>
<p>it's using 1-BIT data but since data is only stored on a byte basis, we must index into each byte to find the specific bit we're looking for</p>



<a name="184390276"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184390276" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184390276">(Dec 28 2019 at 20:42)</a>:</h4>
<p>which is what that macro is doing</p>



<a name="184390338"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184390338" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184390338">(Dec 28 2019 at 20:44)</a>:</h4>
<p>so looking at your get_obj_data() function, the only issue I see is all the bu_cv logic should be completely unnecessary.  should take it out.</p>



<a name="184390348"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184390348" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184390348">(Dec 28 2019 at 20:45)</a>:</h4>
<p>bip-&gt;u.uint8 is the data, so setting it to eip-&gt;buf should be adequate I believe</p>



<a name="184390405"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184390405" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184390405">(Dec 28 2019 at 20:46)</a>:</h4>
<p>Ah ok, thanks for the explanation! I was pretty confused about what that part was for</p>



<a name="184390471"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184390471" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184390471">(Dec 28 2019 at 20:49)</a>:</h4>
<p>So about the macro again, the issue I was having was that for file-based sources, the data would be stored in <code>eip-&gt;mp-&gt;apbuf</code> whereas the data would be stored in <code>eip-&gt;buf</code> for the object-based sources, so I would be dereferencing a null pointer</p>



<a name="184390640"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184390640" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184390640">(Dec 28 2019 at 20:52)</a>:</h4>
<p>But if I changed the BIT macro to <code>(_eip)-&gt;buf</code>, the file reading logic would get messed up instead</p>



<a name="184392144"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184392144" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184392144">(Dec 28 2019 at 21:38)</a>:</h4>
<p>One potential solution: switch-casing eip-&gt;datasrc anywhere BIT is called, and then passing eip-&gt;buf or eip-&gt;mp-&gt;apbuf depending on whether it is file-based or object-based?</p>



<a name="184392198"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184392198" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184392198">(Dec 28 2019 at 21:40)</a>:</h4>
<p>yep, that or better still, replace BIT with a function that has the switch or other conditional to access the appropriate container</p>



<a name="184392217"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184392217" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184392217">(Dec 28 2019 at 21:41)</a>:</h4>
<p>Ah, so I could do something like test if <code>eip-&gt;buf</code> is null or not, and if it is, use <code>eip-&gt;mp-&gt;apbuf</code> and if it isn't, use it?</p>



<a name="184392219"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184392219" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184392219">(Dec 28 2019 at 21:41)</a>:</h4>
<p>well you could, but you added eip-&gt;datasrc for a reason :)</p>



<a name="184392221"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184392221" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184392221">(Dec 28 2019 at 21:41)</a>:</h4>
<p>Ohh right that exists</p>



<a name="184392262"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184392262" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184392262">(Dec 28 2019 at 21:42)</a>:</h4>
<p>Alright I'll give it a try, thank so much for the advice!</p>



<a name="184392263"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184392263" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184392263">(Dec 28 2019 at 21:42)</a>:</h4>
<p>sure thing</p>



<a name="184392269"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184392269" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184392269">(Dec 28 2019 at 21:42)</a>:</h4>
<p>for what it's worth, this is very much "real" coding that one might do on a day-to-day basis ;)</p>



<a name="184392325"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184392325" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184392325">(Dec 28 2019 at 21:45)</a>:</h4>
<p>This is quite an experience, I think I'm slowly getting used to it :) this is the first time I've done "serious" debugging before</p>



<a name="184408940"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184408940" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184408940">(Dec 29 2019 at 07:01)</a>:</h4>
<p>I feel like I'm so close but I can't get past this one error... I changed the macro to</p>
<div class="codehilite"><pre><span></span>#define BIT(_eip, _xx, _yy) (                                               \
    ((_eip)-&gt;datasrc == RT_EBM_SRC_FILE) ?                                      \
    ((unsigned char *)((_eip)-&gt;mp-&gt;apbuf))[ ((_yy)+BIT_YWIDEN)*((_eip)-&gt;xdim + BIT_XWIDEN*2)+(_xx)+BIT_XWIDEN ] \
    : ((unsigned char *)((_eip)-&gt;buf))[ (_yy)*((_eip)-&gt;xdim)+(_xx)])
</pre></div>


<p>but the error I'm getting is "expression must be an lvalue or function designator." I've read that as long as both the second and third arguments to the ternary have the same lvalue/type, then the type of the ternary expression is also an lvalue. Both expressions don't create any errors individually, so why is this error still occurring?</p>



<a name="184409062"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184409062" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184409062">(Dec 29 2019 at 07:05)</a>:</h4>
<p>well it depends -- what line is the error on?</p>



<a name="184409114"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184409114" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184409114">(Dec 29 2019 at 07:06)</a>:</h4>
<p>that is still crazy hard to read -- that's why I suggested turning it into a function anyways.  macros are not only hard to read.  they can be hard to debug too.</p>



<a name="184409116"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184409116" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184409116">(Dec 29 2019 at 07:06)</a>:</h4>
<p>They occur in the two places with <code>memcpy(&amp;BIT(eip, 0, y), cp, eip-&gt;xdim);</code></p>



<a name="184409131"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184409131" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184409131">(Dec 29 2019 at 07:07)</a>:</h4>
<p>But yeah, I agree, macros in general confuse me a lot...</p>



<a name="184409199"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184409199" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184409199">(Dec 29 2019 at 07:09)</a>:</h4>
<p>I think I'll try replacing it with a function that has a switch-case</p>



<a name="184409530"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184409530" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184409530">(Dec 29 2019 at 07:19)</a>:</h4>
<p>Hm... this is still giving me the same error</p>
<div class="codehilite"><pre><span></span>unsigned char *
BIT(struct rt_ebm_internal *eip, size_t x, size_t y)
{
    unsigned char *ret;

    switch (eip-&gt;datasrc) {
    case RT_EBM_SRC_FILE:
        ret = (((unsigned char *)(eip-&gt;mp-&gt;apbuf))[(y+BIT_YWIDEN)*(eip-&gt;xdim+BIT_XWIDEN*2)+x+BIT_XWIDEN]);
        break;
    case RT_EBM_SRC_OBJ:
        ret = ((eip-&gt;buf)[(y)*(eip-&gt;xdim) + x]);
        break;
    }
    return ret;
}
</pre></div>


<p>but shouldn't it be returning a pointer to that location, which is an lvalue?</p>



<a name="184409584"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184409584" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184409584">(Dec 29 2019 at 07:21)</a>:</h4>
<p>that's much easier to read regardless</p>



<a name="184409629"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184409629" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184409629">(Dec 29 2019 at 07:22)</a>:</h4>
<p>so the problem is you can't take the address of a function return value</p>



<a name="184409640"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184409640" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184409640">(Dec 29 2019 at 07:23)</a>:</h4>
<p>it's a temporary value, might be in a register, might be handled by the compiler in some obscure way, might not even exist if inlined or eliminated (though this case it wouldn't be)</p>



<a name="184409643"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184409643" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184409643">(Dec 29 2019 at 07:23)</a>:</h4>
<p>you just need to capture the value to a variable first</p>



<a name="184409693"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184409693" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184409693">(Dec 29 2019 at 07:25)</a>:</h4>
<p>void *bitp = bit(eip, 0, y);  ... memcpy(bitp, cp, eip-&gt;xdim)</p>



<a name="184409817"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184409817" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184409817">(Dec 29 2019 at 07:29)</a>:</h4>
<p>I think that fix worked, thanks so much! I'm still a little confused though, could you elaborate on the difference between the address of the function return value and the actual address?</p>



<a name="184409981"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184409981" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184409981">(Dec 29 2019 at 07:34)</a>:</h4>
<p>the address-of operator "&amp;"</p>



<a name="184409989"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184409989" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184409989">(Dec 29 2019 at 07:35)</a>:</h4>
<p>it evaluates to the address of something in memory, which canonically is the address of a variable</p>



<a name="184409991"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184409991" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184409991">(Dec 29 2019 at 07:35)</a>:</h4>
<p>which points to a piece of memory</p>



<a name="184409997"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184409997" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184409997">(Dec 29 2019 at 07:36)</a>:</h4>
<p>and &amp; provides its address</p>



<a name="184410037"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184410037" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184410037">(Dec 29 2019 at 07:36)</a>:</h4>
<p>Ohhh I see, so I was basically taking the address of the address</p>



<a name="184410040"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184410040" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184410040">(Dec 29 2019 at 07:36)</a>:</h4>
<p>a function returns a value, but you can't take the address of a <em>value</em> .. you take the address of something in memory</p>



<a name="184410044"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184410044" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184410044">(Dec 29 2019 at 07:36)</a>:</h4>
<p>no, address of an address (i.e., a pointer) would have been just fine</p>



<a name="184410052"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184410052" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184410052">(Dec 29 2019 at 07:37)</a>:</h4>
<p>it's that a return value doesn't necessarily actually have a location in memory</p>



<a name="184410097"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184410097" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184410097">(Dec 29 2019 at 07:38)</a>:</h4>
<p>Oh ok, now I think I actually understand, thanks so much for the clarification!</p>



<a name="184410100"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184410100" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184410100">(Dec 29 2019 at 07:38)</a>:</h4>
<p>don't worry, it's a complicated topic</p>



<a name="184410106"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184410106" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184410106">(Dec 29 2019 at 07:38)</a>:</h4>
<p>you won't really fully understand probably until you attempt to do a canonical bit of recursive programming</p>



<a name="184410119"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184410119" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184410119">(Dec 29 2019 at 07:39)</a>:</h4>
<p>a good way to think about it, though, is to think about memory and where things are in memory</p>



<a name="184410168"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184410168" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184410168">(Dec 29 2019 at 07:40)</a>:</h4>
<p>a value being returned from a function doesn't necessarily reside in memory, thus you simply can't get the address to it until you assign it to a variable (i.e., until you save that value into a piece of memory)</p>



<a name="184410182"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184410182" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184410182">(Dec 29 2019 at 07:41)</a>:</h4>
<p>That makes sense I think, I guess I never knew that that was how function return values worked</p>



<a name="184410183"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184410183" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184410183">(Dec 29 2019 at 07:41)</a>:</h4>
<p>this might help: <a href="https://www.learncpp.com/cpp-tutorial/74a-returning-values-by-value-reference-and-address/" target="_blank" title="https://www.learncpp.com/cpp-tutorial/74a-returning-values-by-value-reference-and-address/">https://www.learncpp.com/cpp-tutorial/74a-returning-values-by-value-reference-and-address/</a></p>



<a name="184410224"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184410224" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184410224">(Dec 29 2019 at 07:42)</a>:</h4>
<p>it's a little different for C as it doesn't have the concept of references, but the rest applies</p>



<a name="184410411"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184410411" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184410411">(Dec 29 2019 at 07:48)</a>:</h4>
<p>Hm, for some reason the function (or more specifically, <code>ret = (((unsigned char *)(eip-&gt;mp-&gt;apbuf))[(y+BIT_YWIDEN)*(eip-&gt;xdim+BIT_XWIDEN*2)+x+BIT_XWIDEN]);</code>) keeps returning NULL</p>



<a name="184410484"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184410484" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184410484">(Dec 29 2019 at 07:50)</a>:</h4>
<p>well you had a couple mistakes, for example you had it returning a pointer yet the indexing is into an unsigned char array</p>



<a name="184410500"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184410500" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184410500">(Dec 29 2019 at 07:51)</a>:</h4>
<p>that means the value is an unsigned char (not a pointer)</p>



<a name="184410503"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184410503" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184410503">(Dec 29 2019 at 07:51)</a>:</h4>
<p>but then that'd be a problem for memcpy as you need the address of that unsigned char</p>



<a name="184410558"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184410558" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184410558">(Dec 29 2019 at 07:53)</a>:</h4>
<p>i.e., where it is in the buf, not just the value</p>



<a name="184410570"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184410570" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184410570">(Dec 29 2019 at 07:53)</a>:</h4>
<p>what may work is to move the address-of operator into the function, but then you'll need to modify all of the calls</p>



<a name="184410679"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184410679" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184410679">(Dec 29 2019 at 07:56)</a>:</h4>
<p>Oh, so to get the address of the unsigned char, I would just place the &amp; operator in front of that whole expression, right?</p>



<a name="184410685"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184410685" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184410685">(Dec 29 2019 at 07:57)</a>:</h4>
<p>And then in places where the value itself is needed, I would need to dereference it?</p>



<a name="184410994"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184410994" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184410994">(Dec 29 2019 at 08:04)</a>:</h4>
<p>Also for that case, wouldn't something like <code>memcpy(BIT(eip, 0, y), cp, eip-&gt;xdim);</code> be enough, since the value is now the address?</p>



<a name="184411052"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184411052" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184411052">(Dec 29 2019 at 08:06)</a>:</h4>
<p>Oops sorry I didn't realize I just asked 3 questions in a row like that, I'm pretty inexperienced working with pointers and all of their intricacies</p>



<a name="184411326"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184411326" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184411326">(Dec 29 2019 at 08:16)</a>:</h4>
<p>Well as an update - for the most part, it actually worked!! The only thing that's buggy are the outlines around the image during object reading: <a href="/user_uploads/1549/5GTh6I4nQaxJ98S8evDgciEc/pasted_image.png" target="_blank" title="pasted_image.png">pasted image</a></p>
<div class="message_inline_image"><a href="/user_uploads/1549/5GTh6I4nQaxJ98S8evDgciEc/pasted_image.png" target="_blank" title="pasted image"><img src="/user_uploads/1549/5GTh6I4nQaxJ98S8evDgciEc/pasted_image.png"></a></div>



<a name="184412188"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184412188" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184412188">(Dec 29 2019 at 08:47)</a>:</h4>
<p>My best guess is that it has something to do with the fact that the file-based bitmap is stored with 2 cells of 0s around, but something changes for the object-based bitmap, so it's accessing random external values.</p>



<a name="184413035"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184413035" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184413035">(Dec 29 2019 at 09:15)</a>:</h4>
<p>Yeah, it definitely looks like the data is being read at some weird offset or something - I'll see if I can figure out what's causing it tomorrow. Thanks so much for all of your help <span class="user-mention" data-user-id="102902">@Sean</span> and <span class="user-mention" data-user-id="112516">@starseeker</span> ! I think I learned a lot from this whole process.</p>



<a name="184439869"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184439869" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184439869">(Dec 29 2019 at 22:59)</a>:</h4>
<p>Well, I think I managed to work around it by copying the data from bip-&gt;u.uint8 along with the specified offset, but if there's a solution that doesn't require copying, that would probably be better.</p>



<a name="184560432"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184560432" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184560432">(Dec 31 2019 at 19:05)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="112516">@starseeker</span> , I noticed that r74585 reverted an EBM change I made because it broke the regress-solids regression test. While that patch was still incomplete (I just submitted my new patch that can implement both file and object source), is there something that I should correct?</p>



<a name="184560760"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184560760" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184560760">(Dec 31 2019 at 19:12)</a>:</h4>
<p>Here's the patch by the way: <a href="/user_uploads/1549/g6kWbrhr0j3TJ1JQmdP2z757/ebm4_updated4.patch" target="_blank" title="ebm4_updated4.patch">ebm4_updated4.patch</a></p>



<a name="184578542"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184578542" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184578542">(Jan 01 2020 at 02:48)</a>:</h4>
<p>Does the regress-solids test work with the patch applied?</p>



<a name="184578670"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184578670" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184578670">(Jan 01 2020 at 02:52)</a>:</h4>
<p>Er, hmm... now that I think about it, I don't know that that test will run on Windows...</p>



<a name="184578679"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184578679" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184578679">(Jan 01 2020 at 02:53)</a>:</h4>
<p>Yeah, shell script based.  <span class="user-mention" data-user-id="102902">@Sean</span> , how do you want to proceed here?</p>



<a name="184582343"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184582343" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184582343">(Jan 01 2020 at 04:44)</a>:</h4>
<blockquote>
<p>Does the regress-solids test work with the patch applied?</p>
</blockquote>
<p>Sorry, I didn't look much into it, I just noticed what the revision note that reverted the EBM changes said (although I guess I wouldn't be able to anyways, since I'm on Windows?). I was only wondering if there was anything I would be able to change to EBM in order to somehow correct this issue.</p>



<a name="184587754"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184587754" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184587754">(Jan 01 2020 at 07:44)</a>:</h4>
<blockquote>
<p>Hey <span class="user-mention silent" data-user-id="102902">Sean</span> , for the fourth task, I noticed that there are other functions that currently rely upon the fact that EBM only supports file data at the moment. Should I update them as well?</p>
</blockquote>
<p>Eventually will need to, so yes that would be great!</p>



<a name="184587940"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184587940" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184587940">(Jan 01 2020 at 07:50)</a>:</h4>
<blockquote>
<p>Yeah, shell script based.  <span class="user-mention silent" data-user-id="102902">Sean</span> , how do you want to proceed here?</p>
</blockquote>
<p><span class="user-mention" data-user-id="112516">@starseeker</span> I'll have to reproduce/see the regression failure.  A little surprised it failed anything as it was a non-logic change.  Gut reaction would be to assume it's a bad test / false-positive but maybe something going on with structparse printing.  There's a bigger patch pending that will get more exhaustively tested sitting as an sf patch waiting for it all to come together.</p>



<a name="184603325"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184603325" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184603325">(Jan 01 2020 at 15:58)</a>:</h4>
<blockquote>
<p>Eventually will need to, so yes that would be great!</p>
</blockquote>
<p>I didn't look at every single function in EBM, but fortunately, I think most of them were originally using the BIT macro to access the data. Hopefully, now that I've replaced all the BIT calls with the new bit() function, it should mostly be correct already :)</p>



<a name="184624103"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184624103" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184624103">(Jan 02 2020 at 02:49)</a>:</h4>
<p>It's definitely what I would expect as well.  It should be right or at least really close to correct.</p>



<a name="184632846"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184632846" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184632846">(Jan 02 2020 at 07:20)</a>:</h4>
<p><span class="user-mention" data-user-id="250111">@Jeffrey Liu</span> So I did a quick test of creating an ebm using an older/existing MGED, then opened that ebm using an MGED with your patch applied, and it fails to load it correctly:</p>



<a name="184632850"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184632850" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184632850">(Jan 02 2020 at 07:20)</a>:</h4>
<div class="codehilite"><pre><span></span>mged&gt; tops
<span class="m">00000</span>.000000.comb/   ebm

mged&gt; e ebm
Unreasonable EBM parameters
    <span class="nv">file</span><span class="o">=</span><span class="s2">&quot;data&quot;</span>
    <span class="nv">src</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
    <span class="nv">w</span><span class="o">=</span><span class="m">32</span>

    <span class="nv">n</span><span class="o">=</span><span class="m">32</span>

    <span class="nv">d</span><span class="o">=</span><span class="m">10</span>

 <span class="nv">mat</span><span class="o">=</span><span class="m">1</span>.000000E+00 <span class="m">0</span>.000000E+00 <span class="m">0</span>.000000E+00 <span class="m">0</span>.000000E+00

<span class="m">0</span>.000000E+00 <span class="m">1</span>.000000E+00 <span class="m">0</span>.000000E+00 <span class="m">0</span>.000000E+00

<span class="m">0</span>.000000E+00 <span class="m">0</span>.000000E+00 <span class="m">1</span>.000000E+00 <span class="m">0</span>.000000E+00

<span class="m">0</span>.000000E+00 <span class="m">0</span>.000000E+00 <span class="m">0</span>.000000E+00 <span class="m">1</span>.000000E+00
rt_db_external5_to_internal5<span class="o">(</span>ebm<span class="o">)</span>:  import failure
db_recurse<span class="o">()</span> rt_db_get_internal<span class="o">(</span>ebm<span class="o">)</span> FAIL
mged&gt; l ebm
Unreasonable EBM parameters
    <span class="nv">file</span><span class="o">=</span><span class="s2">&quot;data&quot;</span>
    <span class="nv">src</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
    <span class="nv">w</span><span class="o">=</span><span class="m">32</span>

    <span class="nv">n</span><span class="o">=</span><span class="m">32</span>

    <span class="nv">d</span><span class="o">=</span><span class="m">10</span>

 <span class="nv">mat</span><span class="o">=</span><span class="m">1</span>.000000E+00 <span class="m">0</span>.000000E+00 <span class="m">0</span>.000000E+00 <span class="m">0</span>.000000E+00

<span class="m">0</span>.000000E+00 <span class="m">1</span>.000000E+00 <span class="m">0</span>.000000E+00 <span class="m">0</span>.000000E+00

<span class="m">0</span>.000000E+00 <span class="m">0</span>.000000E+00 <span class="m">1</span>.000000E+00 <span class="m">0</span>.000000E+00

<span class="m">0</span>.000000E+00 <span class="m">0</span>.000000E+00 <span class="m">0</span>.000000E+00 <span class="m">1</span>.000000E+00
rt_db_external5_to_internal5<span class="o">(</span>ebm<span class="o">)</span>:  import failure
rt_db_get_internal<span class="o">(</span>ebm<span class="o">)</span> failure

mged&gt; in ebm2
Enter solid type: ebm
Take data from file or database binary object <span class="o">[</span>f<span class="p">|</span>o<span class="o">]</span>: f
Enter name of file/object: data
Enter width of bit-map <span class="o">(</span>number of cells<span class="o">)</span>: <span class="m">32</span>
Enter height of bit-map <span class="o">(</span>number of cells<span class="o">)</span>: <span class="m">32</span>
Enter extrusion distance: <span class="m">10</span>
ebm2
mged&gt; l ebm2
ebm2:  extruded bitmap <span class="o">(</span>EBM<span class="o">)</span>
      <span class="nv">file</span><span class="o">=</span><span class="s2">&quot;data&quot;</span> <span class="nv">w</span><span class="o">=</span><span class="m">32</span> <span class="nv">n</span><span class="o">=</span><span class="m">32</span> <span class="nv">depth</span><span class="o">=</span><span class="m">10</span>
   <span class="nv">mat</span><span class="o">=</span><span class="m">1</span>, <span class="m">0</span>, <span class="m">0</span>, <span class="m">0</span>, <span class="m">0</span>, <span class="m">1</span>, <span class="m">0</span>, <span class="m">0</span>, <span class="m">0</span>, <span class="m">0</span>, <span class="m">1</span>, <span class="m">0</span>, <span class="m">0</span>, <span class="m">0</span>, <span class="m">0</span>, <span class="m">1</span>
</pre></div>



<a name="184632944"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184632944" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184632944">(Jan 02 2020 at 07:23)</a>:</h4>
<p>As you can hopefully see, it works just fine creating new ebm, but can't handle old ebm (and it obviously should).  I think the issue is the empty src='' field, but hopefully something you can recreate and fix.  It could be something as simple as setting a default value in the structparse table, or it might require some change in the ebm import5 function.  It's unclear why import5 is reporting a failure, but that's where the problem resides.</p>



<a name="184632989"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184632989" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184632989">(Jan 02 2020 at 07:24)</a>:</h4>
<p>This is likely why the original patch had to be reverted as well as we have tests that include old ebm.</p>



<a name="184639097"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184639097" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184639097">(Jan 02 2020 at 09:48)</a>:</h4>
<p>Ah I forgot to account for that... so if I'm understanding correctly, the issue lies in the fact that EBM objects created before the <code>datasrc</code> field was added, so then redrawing them after the update will cause an error because nothing was written to that field for those objects?</p>



<a name="184640178"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184640178" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184640178">(Jan 02 2020 at 10:08)</a>:</h4>
<p>I think one method that would work would be to add a check like <code>!eip-&gt;datasrc</code> and then assign it a value of RT_EBM_SRC_FILE. I tried something like this, <code>{"%c",   1, "src",   RT_EBM_O(datasrc),  BU_STRUCTPARSE_FUNC_NULL, NULL, 'f' }</code> but I guess I either did something wrong or it didn't work</p>



<a name="184640310"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184640310" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184640310">(Jan 02 2020 at 10:11)</a>:</h4>
<p>Another option could be to add a function like <code>hook_verify()</code> found in DSP to do the checking, if that's how those functions work?</p>



<a name="184640800"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184640800" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184640800">(Jan 02 2020 at 10:19)</a>:</h4>
<p>Ok, so I'm pretty sure this check worked: <code>if (!eip-&gt;datasrc) eip-&gt;datasrc = RT_EBM_SRC_FILE;</code> <br>
I currently just placed it right before import5() checks for reasonable values, but I could also try putting it in something like a <code>hook_verify()</code> if that's preferred.</p>



<a name="184641247"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184641247" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184641247">(Jan 02 2020 at 10:26)</a>:</h4>
<p>Here's the patch: <a href="/user_uploads/1549/JEgxswovGd41_XqV2WI74A2e/ebm4_updated6.patch" target="_blank" title="ebm4_updated6.patch">ebm4_updated6.patch</a> <br>
I think it should work for all cases because MGED inherently prevents the user from inputting nothing to a field.</p>



<a name="184641512"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184641512" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184641512">(Jan 02 2020 at 10:31)</a>:</h4>
<p>Drawing/erasing "old" EBM objects works now, but could there be some other functions that I haven't accounted for through this check?</p>



<a name="184660372"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184660372" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184660372">(Jan 02 2020 at 15:46)</a>:</h4>
<p>simple is fine, no need for a hook function if putting a check in one place fixes it.  dsp needed the check in a few places (v4 and v5 support), so it then makes sense to refactor to a function that does the check.</p>



<a name="184660424"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184660424" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184660424">(Jan 02 2020 at 15:47)</a>:</h4>
<p>that way if the check itself ever needs to change, you change it in one place instead of finding everywhere datasrc is accessed and having to re-evaluate if it's needed</p>



<a name="184660529"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184660529" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184660529">(Jan 02 2020 at 15:48)</a>:</h4>
<blockquote>
<p>Drawing/erasing "old" EBM objects works now, but could there be some other functions that I haven't accounted for through this check?</p>
</blockquote>
<p>This I don't know, wouldn't know without reading the code in more detail.  You could look at all the places -&gt;name is accessed and see if any seem to assume it's  a file.</p>



<a name="184687041"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184687041" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184687041">(Jan 02 2020 at 21:45)</a>:</h4>
<blockquote>
<p>This I don't know, wouldn't know without reading the code in more detail.  You could look at all the places -&gt;name is accessed and see if any seem to assume it's  a file.</p>
</blockquote>
<p>I just looked at all the calls to <code>-&gt;name</code>, as well as if there were any more calls to <code>-&gt;mp-&gt;apbuf</code> (how the data was accessed before), but it seemed okay to me. It looks like most functions were using <code>BIT</code> (now <code>bit()</code>) which checks the datasrc.</p>



<a name="184687305"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184687305" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184687305">(Jan 02 2020 at 21:49)</a>:</h4>
<p>For the wiki edit task, could I include everything that should be added into a pdf file? Some of the old text would also need to be adjusted as well, so should I include that in the comments?</p>



<a name="184766690"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184766690" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184766690">(Jan 03 2020 at 20:50)</a>:</h4>
<p>Hi, I was trying to test the solid edit mode feature for DSP and EBM, but I was having a little trouble working with it and I couldn't find much relevant documentation. My main issue was that when trying to edit something, my input is only ever prompted when I choose file name. Otherwise, I'm not really sure how I'm supposed to edit the value (such as file size). Could anyone help me with this?</p>



<a name="184766958"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184766958" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184766958">(Jan 03 2020 at 20:54)</a>:</h4>
<p>Also, I think I may have found a bug (I don't think it's been reported before, so could I submit this as a bug report task?) - when I try to use "Primitive Editor" and I try to select a DSP object that I have created, I get this error after I click "Reset:" <a href="/user_uploads/1549/rsRjCWoRv9OLs0LnjBjo8q_x/pasted_image.png" target="_blank" title="pasted_image.png">pasted image</a></p>
<div class="message_inline_image"><a href="/user_uploads/1549/rsRjCWoRv9OLs0LnjBjo8q_x/pasted_image.png" target="_blank" title="pasted image"><img src="/user_uploads/1549/rsRjCWoRv9OLs0LnjBjo8q_x/pasted_image.png"></a></div>



<a name="184770303"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184770303" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184770303">(Jan 03 2020 at 21:42)</a>:</h4>
<p>There's not really any documentation on the Tcl side of things besides the code itself.</p>



<a name="184771994"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184771994" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184771994">(Jan 03 2020 at 22:06)</a>:</h4>
<p>As to the file name prompt, that's because the code makes a call that asks for the file dialog.</p>



<a name="184772303"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184772303" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184772303">(Jan 03 2020 at 22:11)</a>:</h4>
<p>That's really the central issue with the task, figuring out how to conditionally prompt differently.  I would suggest changing the menu entry to a "Data Source" entry that opens a dialog that has a "Object or file name" label, a  text input where you can type a name, and a button next to it that opens the file dialog.  Third line could have a toggle input that denotes object or file  that autosets to file when the file dialog is used but otherwise defaults to object.  Could display  warning when the name doesn't match an existing object or file accordingly.</p>



<a name="184772360"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184772360" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184772360">(Jan 03 2020 at 22:12)</a>:</h4>
<p>This is kind of what happens when you edit a sketch object, it opens a new window.</p>



<a name="184772644"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184772644" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184772644">(Jan 03 2020 at 22:17)</a>:</h4>
<p>The easiest way to go about this is probably to just do a simple tk tutorial that creates a little window with the input field, file button, checkbox, labels, etc.  Get that  working, then you just have to make the menu call it.</p>



<a name="184772695"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184772695" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184772695">(Jan 03 2020 at 22:18)</a>:</h4>
<p>and of course, <span class="user-mention" data-user-id="250111">@Jeffrey Liu</span> keep asking questions :)</p>



<a name="184773148"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184773148" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184773148">(Jan 03 2020 at 22:27)</a>:</h4>
<p>A good example to follow might be the color selection panel which you can see under Tools -&gt; Color Selector or by searching for "cadColorWidget" in src/tclscripts/mged (most is in colors.tcl)</p>



<a name="184773176"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184773176" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184773176">(Jan 03 2020 at 22:27)</a>:</h4>
<p>another really great one is botedit.tcl</p>



<a name="184780468"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184780468" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184780468">(Jan 04 2020 at 00:57)</a>:</h4>
<p>Ah okay, thank you for the advice! I think I have a better idea of what the task is asking for now - would it be better to reprompt for the file size as well when a new file/object is chosen?</p>



<a name="184783593"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184783593" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184783593">(Jan 04 2020 at 02:20)</a>:</h4>
<p>On second thought, it might be better to leave them separate. I'm still a little confused about how to precisely edit values though, when I'm in primitive edit mode for EBM and try to do Edit &gt; File Size (W N), I'm not given a prompt but middle clicking doesn't do anything either. Looking at edsol.c, it looks like it's extracting 2 arguments from <code>es_para</code> which is keyboard input, but I still haven't been able to actually input new dimensions myself. Am I still doing something wrong?</p>



<a name="184792552"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184792552" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184792552">(Jan 04 2020 at 07:12)</a>:</h4>
<p><span class="user-mention" data-user-id="102902">@Sean</span> I just made this on Google Drawings to plan things out, but is this similar to what you were talking about? <a href="/user_uploads/1549/pEszkrlLIvlAMLB-YYBdDYFu/pasted_image.png" target="_blank" title="pasted_image.png">pasted image</a></p>
<div class="message_inline_image"><a href="/user_uploads/1549/pEszkrlLIvlAMLB-YYBdDYFu/pasted_image.png" target="_blank" title="pasted image"><img src="/user_uploads/1549/pEszkrlLIvlAMLB-YYBdDYFu/pasted_image.png"></a></div>



<a name="184792614"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184792614" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184792614">(Jan 04 2020 at 07:15)</a>:</h4>
<p>I haven't used Tcl/Tk before, but I took a look at the existing code and I think two challenges might be returning two different parameters (name and datasrc), and actually calling the Tcl getFile command to get a file name.</p>



<a name="184820612"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184820612" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184820612">(Jan 04 2020 at 21:34)</a>:</h4>
<p>Well, I think an easy way to return both <code>name</code> and <code>datasrc</code> would be to just concatenate the two before returning it before parsing it to separate them. I'm having some difficulty actually creating the window though - I took a look at color.tcl and botedit.tcl, but from what I understand, those are directly called through openw.tcl (and some variables are provided) whereas getFile() is called through edsol.c. Is there something that I overlooked?</p>



<a name="184820753"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184820753" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184820753">(Jan 04 2020 at 21:39)</a>:</h4>
<p>I've been trying a couple soledit functions, but so far I haven't found any that actually opens a new window aside from the call to <code>tk_getOpenFile</code></p>



<a name="184820993"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184820993" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wendelin Wemhöner <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184820993">(Jan 04 2020 at 21:47)</a>:</h4>
<p>Hey! My name is Wendelin and I'm participating in the Google Code In. My favorite task by BRL-CAD is the "Discover the BRL-CAD open source community" task because it is a lovely introduction to this project.</p>



<a name="184838084"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184838084" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184838084">(Jan 05 2020 at 07:37)</a>:</h4>
<blockquote>
<p>Ah okay, thank you for the advice! I think I have a better idea of what the task is asking for now - would it be better to reprompt for the file size as well when a new file/object is chosen?</p>
</blockquote>
<p><span class="user-mention" data-user-id="250111">@Jeffrey Liu</span> I don't think it needs to prompt for file size as that's already a menu option unless you want to completely implement an edit panel for all the ebm parameters (kind of like how 'sketch' object editing is handled)</p>



<a name="184838145"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184838145" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184838145">(Jan 05 2020 at 07:39)</a>:</h4>
<p>it's not that it'd better or worse.  both / either can work.  that said, I think you found a bug in the File Size (W N) edit menu.   The normal way to set values on the menu (like the extrusion height) is to either middle-click in the gui or utilize the 'p' command to provide exact values.  So you'd select "File Size ..." and then run something like "p 10 20".</p>



<a name="184838193"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184838193" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184838193">(Jan 05 2020 at 07:40)</a>:</h4>
<p>However, like I said, it doesn't appear to be working right now.   Some bug in src/mged/edsol.c before where it reports "width and length of file are required".</p>



<a name="184838307"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184838307" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184838307">(Jan 05 2020 at 07:44)</a>:</h4>
<blockquote>
<p><span class="user-mention silent" data-user-id="102902">Sean</span> I just made this on Google Drawings to plan things out, but is this similar to what you were talking about? <a href="/user_uploads/1549/pEszkrlLIvlAMLB-YYBdDYFu/pasted_image.png" target="_blank" title="pasted_image.png">pasted image</a></p>
</blockquote>
<p>Yes, very close.  Welcome to ideas, but could also just have two buttons -- select data object &amp; select data file.  then you wouldn't need the toggle since it'd be implicit in the selection.</p>



<a name="184838612"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184838612" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184838612">(Jan 05 2020 at 07:56)</a>:</h4>
<blockquote>
<p>I've been trying a couple soledit functions, but so far I haven't found any that actually opens a new window aside from the call to <code>tk_getOpenFile</code></p>
</blockquote>
<p>the references I mentioned opened new windows.</p>



<a name="184838618"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184838618" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184838618">(Jan 05 2020 at 07:57)</a>:</h4>
<p>welcome <span class="user-mention" data-user-id="256658">@Wendelin Wemhöner</span> !</p>



<a name="184840922"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184840922" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184840922">(Jan 05 2020 at 09:12)</a>:</h4>
<p>Thank you for the advice! The 'p' command was exactly what I was looking for. Regarding the references - I took a look at them, but from what I could understand, they were being called directly from openw.tcl, which passed in a couple variables (<code>$id</code>, <code>$screen</code>) that were used to actually create the window. On the other hand, the Tk application that I would need to make would be called from edsol.c, right? That's why I was a little confused.</p>



<a name="184842153"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184842153" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184842153">(Jan 05 2020 at 09:51)</a>:</h4>
<blockquote>
<p>However, like I said, it doesn't appear to be working right now.   Some bug in src/mged/edsol.c before where it reports "width and length of file are required".</p>
</blockquote>
<p>I just tested this, and I would first get the error "three arguments needed," but when I put in 3 arguments, I would get the error "width and length of file are required." I looked into it and this seems to be the problem:</p>
<div class="codehilite"><pre><span></span>else {
    if (inpara != 3) {
        Tcl_AppendResult(interp, &quot;ERROR: three arguments needed\n&quot;, (char *)NULL);
        inpara = 0;
        return TCL_ERROR;
    }
}
</pre></div>


<p>on line 7902, as everything worked normally after I commented it out. Perhaps the issue is that the if statement is not being evaluated correctly?</p>



<a name="184842260"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184842260" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184842260">(Jan 05 2020 at 09:55)</a>:</h4>
<p>Or actually in this case,  there might need to be an else-if statement because the if block checks for editing options with only a single argument.</p>



<a name="184842773"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184842773" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184842773">(Jan 05 2020 at 10:12)</a>:</h4>
<p>The if conditional is a little interesting though, I'm getting similar "three arguments needed" errors when I try to set EBM height or scale DSP X/Y, all of which work again after I comment out the else block</p>



<a name="184842975"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184842975" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184842975">(Jan 05 2020 at 10:19)</a>:</h4>
<p>Back to my challenge with creating a new window, this was what I was talking about:<br>
<code>proc bot_askforname {parent screen}</code><br>
where the procedure is already given certain arguments beforehand, which it uses to create a new window. However, I believe that when calling a function through edsol.c, I don't have this capability.</p>



<a name="184862144"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184862144" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184862144">(Jan 05 2020 at 19:52)</a>:</h4>
<p>At the risk of spamming too many things, I think I found another error: using <code>tk_getOpenFile</code> returns the absolute path, which gets assigned to ebm-&gt;name (something similar happens for DSP). However, DSP and EBM both use the function <code>bu_open_mapped_file_with_path()</code>, which assumes a relative path. As a result, it concatenates the paths weirdly, and I'm getting a file import error whenever I try to edit a DSP or EBM file name/path. Perhaps it might be better to just prompt the user to manually type a name and then choose file or object, as this is essentially what DSP/EBM creation does in the first place?</p>



<a name="184972625"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184972625" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184972625">(Jan 07 2020 at 00:46)</a>:</h4>
<p>Ahh I finally got to create a new window - I needed to call <code>dm_get_filepath(DMP)</code> and <code>dm_get_dname(DMP)</code> in order to pass <code>parent</code> and <code>screen</code> as arguments to the function. As for the two errors - I mentioned possible solutions above, but perhaps if a dev could confirm some things so that I don't go ahead to change some things that shouldn't be changed?</p>



<a name="184976284"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184976284" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184976284">(Jan 07 2020 at 02:11)</a>:</h4>
<p>What about using bu_dir to get the root of the filepath, then passing the relative path on to the creation routine?</p>



<a name="184982783"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184982783" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184982783">(Jan 07 2020 at 05:07)</a>:</h4>
<p>Shoot, I just saw this but I'm almost done with my implementation that requires a manual input. I think I'll stick with this for now since it's already taken me quite a while to get to an almost complete GUI. I'm just having trouble returning a string using the information from the entry and menubutton widget.</p>



<a name="184986286"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184986286" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184986286">(Jan 07 2020 at 06:40)</a>:</h4>
<p>I'm so close to finishing the GUI, but I'm stuck on one last thing. Could I get some help? This is my code (I know it's pretty messy right now, but I'll clean it up once I get things working):</p>
<div class="codehilite"><pre><span></span>proc apply_datasrc { type name } {
    if {$type == &quot;File&quot;} {
    set ret &quot;f&quot;
    } else {
    set ret &quot;o&quot;
    }
    append ret $name
    return $ret
}

proc init_datasrc { parent screen } {
    set w $parent.data
    catch { destroy $w }

    set row -1
    toplevel $w -screen $screen
    wm title $w &quot;Set Data Source&quot;

    incr row
    frame $w.nameF -relief flat -bd 2
    label $w.nameL -text &quot;Name:&quot; -anchor e
    entry $w.nameE -relief sunken -bd 2 -textvariable name
    grid $w.nameL $w.nameE -in $w.nameF -padx 8
    grid $w.nameF -row $row -column 0 -sticky nsew -pady 8
    grid rowconfigure $w $row -weight 0

    incr row
    frame $w.typeF -relief flat -bd 2
    label $w.typeL -text &quot;Type:&quot; -anchor e
    menubutton $w.typeMB -relief raised -bd 2 -text &quot;Object&quot; -textvariable type -menu $w.typeMB.m
    menu $w.typeMB.m -tearoff 0
    $w.typeMB.m add command -label Object -command {set type &quot;Object&quot;}
    $w.typeMB.m add command -label File -command {set type &quot;File&quot;}
    grid $w.typeL $w.typeMB -in $w.typeF -padx 8
    grid $w.typeF -row $row -column 0 -sticky nsew -pady 8
    grid rowconfigure $w $row -weight 0

    incr row
    frame $w.buttons -relief flat -bd 2
    button $w.okB -text &quot;OK&quot; \
    -command {set ret [apply_datasrc $type $name]; return $ret}
    button $w.dismissB -text &quot;Dismiss&quot; \
    -command &quot;destroy $w&quot;
    grid $w.okB x $w.dismissB -in $w.buttons -sticky nsew -padx 8
    grid columnconfigure $w.buttons 1 -weight 1
    grid $w.buttons -row $row -column 0 -sticky nsew -pady 8
    grid rowconfigure $w $row -weight 0

    grid columnconfigure $w 0 -weight 1
}

proc getDataSrc { parent screen } {
    set ret [init_datasrc $parent $screen]
    return $ret
}
</pre></div>


<p>So the issue I'm having is that when <code>getDataSrc</code> is called, the GUI gets set up and all, but even though I've tested that ret is getting assigned exactly what I want it to after I click "OK," the GUI remains open and it doesn't seem like anything gets updated. I've tried debugging but I'm still a little bit confused as to how the Tcl interpreter is working, so I was wondering if there could be something blatantly incorrect with this code?</p>



<a name="184986375"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184986375" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184986375">(Jan 07 2020 at 06:43)</a>:</h4>
<p><span class="user-mention" data-user-id="250111">@Jeffrey Liu</span> manual is certainly fine for starters.  I don't think the GUI editing method has been tested very much for dsp, so it's not surprising.  full path should work, as should relative, so it's more likely a change to mapped file maybe broke that or requires a flag now.</p>



<a name="184986384"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184986384" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184986384">(Jan 07 2020 at 06:43)</a>:</h4>
<p>we definitely do have much better file/path handling routines now than when dsp was implemented</p>



<a name="184986454"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184986454" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184986454">(Jan 07 2020 at 06:45)</a>:</h4>
<p>Ah ok, thank you for the advice! If that's the case, perhaps I could try to update both DSP and EBM after GCi ends?</p>



<a name="184986514"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184986514" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184986514">(Jan 07 2020 at 06:47)</a>:</h4>
<p>absolutely, they both could use some TLC</p>



<a name="184986518"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184986518" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184986518">(Jan 07 2020 at 06:47)</a>:</h4>
<p>(tender loving care, not TCL typo) ;)</p>



<a name="184986572"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184986572" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184986572">(Jan 07 2020 at 06:48)</a>:</h4>
<p>Haha, yeah I did notice that a couple of DSP things weren't updated/implemented yet (like the file size sedit option)</p>



<a name="184986579"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184986579" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184986579">(Jan 07 2020 at 06:49)</a>:</h4>
<p>I don't see anything blatantly wrong in your code, but that doesn't mean the data is getting to where it needs to be.  tcl debugging is annoying.</p>



<a name="184986658"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184986658" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184986658">(Jan 07 2020 at 06:50)</a>:</h4>
<p>there is no return value from init_datasrc so returning that in getDataSrc presumably does nothing</p>



<a name="184986749"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184986749" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184986749">(Jan 07 2020 at 06:52)</a>:</h4>
<p>Hm, I didn't know how I would explicitly declare a return value, but I thought that the "return" command from the OK button would suffice. I did create a label from within getDataSrc with ret as a textvariable, and it was getting updated too. That's why I'm a little confused as to why the string isn't getting returned back.</p>



<a name="184987339"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184987339" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184987339">(Jan 07 2020 at 07:08)</a>:</h4>
<p>I don't think that's going to suffice because it's not a return from the right place</p>



<a name="184988141"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/184988141" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#184988141">(Jan 07 2020 at 07:31)</a>:</h4>
<p>that said, don't worry about it too much.  if you have it displaying a GUI, I'm happy to call the task done.  that's useful in itself and more appropriately scoped.  it was a noticeably harder task involving aspects of tcl/tk, mged, gui design, gui behavior implementation, debugging existing code, and hooking into existing code.  task probably should have been a chain of 3-6 tasks ..</p>



<a name="185007620"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185007620" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185007620">(Jan 07 2020 at 13:01)</a>:</h4>
<p>Alright, thanks so much! The tcl/tk was definitely challenging, but I wish I could've got everything working together though...</p>



<a name="185007947"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185007947" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185007947">(Jan 07 2020 at 13:05)</a>:</h4>
<p>I guess that's also part of the to-do after GCi</p>



<a name="185051535"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185051535" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Erik <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185051535">(Jan 07 2020 at 20:31)</a>:</h4>
<p>looking pretty  awesome, <span class="user-mention" data-user-id="250111">@Jeffrey Liu</span> , I don't  suppose we  could see a non-2^n non-square  "complicated" bitmap  (like  a photo) raytraced? Eye  candy is always nice. Keep up the good work!</p>



<a name="185052143"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185052143" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185052143">(Jan 07 2020 at 20:37)</a>:</h4>
<p>Thank you <span class="user-mention" data-user-id="103542">@Erik</span> :) I can do one right now - do you have anything in mind?</p>



<a name="185053160"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185053160" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Erik <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185053160">(Jan 07 2020 at 20:48)</a>:</h4>
<p>how about something  like a  mona  lisa as heightmap?</p>



<a name="185054790"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185054790" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Erik <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185054790">(Jan 07 2020 at 21:07)</a>:</h4>
<p>(not a requirement or anything. Everyone likes eye candy and this could be a  good acid  test  <span aria-label="slight smile" class="emoji emoji-1f642" role="img" title="slight smile">:slight_smile:</span> )</p>



<a name="185060095"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185060095" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185060095">(Jan 07 2020 at 22:07)</a>:</h4>
<p>Hm... It definitely sounds interesting, I never thought of using EBM (or did you mean DSP?) like that. It might seem a bit weird as an EBM, since everything would be the same height.</p>



<a name="185060123"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185060123" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185060123">(Jan 07 2020 at 22:07)</a>:</h4>
<p>I'll give it a try for both EBM and DSP to see how it goes</p>



<a name="185060818"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185060818" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185060818">(Jan 07 2020 at 22:17)</a>:</h4>
<p>Shoot I just realized that I don't have BRLCAD compiled on Linux, I'll have to do that first</p>



<a name="185061965"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185061965" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185061965">(Jan 07 2020 at 22:30)</a>:</h4>
<p>Something like <a href="https://www.prosportstickers.com/product_images/g/abe_lincoln_decal__43877_thumb.jpg" target="_blank" title="https://www.prosportstickers.com/product_images/g/abe_lincoln_decal__43877_thumb.jpg">https://www.prosportstickers.com/product_images/g/abe_lincoln_decal__43877_thumb.jpg</a> maybe?</p>
<div class="message_inline_image"><a href="https://www.prosportstickers.com/product_images/g/abe_lincoln_decal__43877_thumb.jpg" target="_blank" title="https://www.prosportstickers.com/product_images/g/abe_lincoln_decal__43877_thumb.jpg"><img src="https://www.prosportstickers.com/product_images/g/abe_lincoln_decal__43877_thumb.jpg"></a></div>



<a name="185063080"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185063080" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185063080">(Jan 07 2020 at 22:45)</a>:</h4>
<p>another fun one maybe: <a href="https://live.staticflickr.com/5653/20581371208_dfccf787d6_o_d.jpg" target="_blank" title="https://live.staticflickr.com/5653/20581371208_dfccf787d6_o_d.jpg">https://live.staticflickr.com/5653/20581371208_dfccf787d6_o_d.jpg</a></p>
<div class="message_inline_image"><a href="https://live.staticflickr.com/5653/20581371208_dfccf787d6_o_d.jpg" target="_blank" title="https://live.staticflickr.com/5653/20581371208_dfccf787d6_o_d.jpg"><img src="https://live.staticflickr.com/5653/20581371208_dfccf787d6_o_d.jpg"></a></div>



<a name="185065125"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185065125" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185065125">(Jan 07 2020 at 23:12)</a>:</h4>
<p>Hm yeah, those might work better. I'll try some out</p>



<a name="185065176"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185065176" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185065176">(Jan 07 2020 at 23:13)</a>:</h4>
<p>Although if the EBM reads the white pixels, would it be better to invert the colors?</p>



<a name="185070348"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185070348" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185070348">(Jan 08 2020 at 00:38)</a>:</h4>
<p>I didn't really spend too much time configuring the colors and stuff, but here's a quick render of two images imported to EBM: <a href="/user_uploads/1549/byyJ47ztF7ql4O5r_imUSqsl/lincoln_render.png" target="_blank" title="lincoln_render.png">lincoln_render.png</a> <a href="/user_uploads/1549/82kbvsOx95qKA9d2nx7CoQ7t/tsunami_render.png" target="_blank" title="tsunami_render.png">tsunami_render.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/1549/byyJ47ztF7ql4O5r_imUSqsl/lincoln_render.png" target="_blank" title="lincoln_render.png"><img src="/user_uploads/1549/byyJ47ztF7ql4O5r_imUSqsl/lincoln_render.png"></a></div><div class="message_inline_image"><a href="/user_uploads/1549/82kbvsOx95qKA9d2nx7CoQ7t/tsunami_render.png" target="_blank" title="tsunami_render.png"><img src="/user_uploads/1549/82kbvsOx95qKA9d2nx7CoQ7t/tsunami_render.png"></a></div>



<a name="185070438"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185070438" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185070438">(Jan 08 2020 at 00:40)</a>:</h4>
<p>cool, can you rotate it a bit to see the 3d effect?</p>



<a name="185070620"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185070620" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185070620">(Jan 08 2020 at 00:43)</a>:</h4>
<p>Here: <a href="/user_uploads/1549/DdCc6z4t_Y64sYVQRbfge-S8/lincoln_render_rotated.png" target="_blank" title="lincoln_render_rotated.png">lincoln_render_rotated.png</a> <a href="/user_uploads/1549/ImCMLjZ46vsOP2fqKnfdW76m/tsunami_render_rotated.png" target="_blank" title="tsunami_render_rotated.png">tsunami_render_rotated.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/1549/DdCc6z4t_Y64sYVQRbfge-S8/lincoln_render_rotated.png" target="_blank" title="lincoln_render_rotated.png"><img src="/user_uploads/1549/DdCc6z4t_Y64sYVQRbfge-S8/lincoln_render_rotated.png"></a></div><div class="message_inline_image"><a href="/user_uploads/1549/ImCMLjZ46vsOP2fqKnfdW76m/tsunami_render_rotated.png" target="_blank" title="tsunami_render_rotated.png"><img src="/user_uploads/1549/ImCMLjZ46vsOP2fqKnfdW76m/tsunami_render_rotated.png"></a></div>



<a name="185071113"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185071113" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185071113">(Jan 08 2020 at 00:52)</a>:</h4>
<p>By the way <span class="user-mention" data-user-id="102902">@Sean</span> , would it be alright for me to update the wiki before the patch is applied?</p>



<a name="185071130"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185071130" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185071130">(Jan 08 2020 at 00:52)</a>:</h4>
<p>yes, that should be just fine</p>



<a name="185071173"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185071173" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185071173">(Jan 08 2020 at 00:53)</a>:</h4>
<p>Ok thanks, I wasn't sure if I should just in case someone else would be referencing it anytime soon</p>



<a name="185072559"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185072559" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185072559">(Jan 08 2020 at 01:19)</a>:</h4>
<p>Updated :)</p>



<a name="185078895"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185078895" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185078895">(Jan 08 2020 at 03:51)</a>:</h4>
<p><span class="user-mention" data-user-id="250111">@Jeffrey Liu</span> Got it and closed.  Thank you for your work on this.  Hopefully you had fun.. that was a bit more of a diversion than was expected, but hopefully learned a lot too. ;)</p>



<a name="185079013"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185079013" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185079013">(Jan 08 2020 at 03:53)</a>:</h4>
<p>The ebm work is actually going to be quite useful.  What we really need is to generalize the entire concept of referencing something from a data object so that it's the same across dsp, ebm, vol, textures, uv maps, projection maps, image objects, and other entities instead of getting coded up independently each time.  That's not GCI work, but it is where we need to get to long term.</p>



<a name="185079055"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185079055" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185079055">(Jan 08 2020 at 03:54)</a>:</h4>
<p>This is a nudge in that direction, so thank you.</p>



<a name="185093962"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185093962" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185093962">(Jan 08 2020 at 09:51)</a>:</h4>
<p>Thank you :) Throughout the whole taskset, I learned a lot (Tcl/Tk, pointers, macros, etc) and I think I have a better understanding of how MGED works now. It took me a lot longer than I also expected, but the process as a whole was a lot of fun. As for the future work, would it be possible for me to contribute to this after GCI?</p>



<a name="185094100"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185094100" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185094100">(Jan 08 2020 at 09:53)</a>:</h4>
<p>That said, I can't wait to get back into the appleseed tasks! But before that, I need to revert my EBM changes right?</p>



<a name="185104237"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185104237" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185104237">(Jan 08 2020 at 12:22)</a>:</h4>
<p>Certainly - BRL-CAD is an open source project :-)</p>



<a name="185131661"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185131661" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185131661">(Jan 08 2020 at 16:47)</a>:</h4>
<p><span class="user-mention" data-user-id="250111">@Jeffrey Liu</span> the HOPE is that you keep contributing  after GCI.  you can work on literally any aspect of the code that you desire.  happy to mentor you in new or old areas.  would be great to take on a specific project of your own that is interesting to you that you can keep working on.</p>



<a name="185131773"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185131773" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185131773">(Jan 08 2020 at 16:48)</a>:</h4>
<blockquote>
<p>That said, I can't wait to get back into the appleseed tasks! But before that, I need to revert my EBM changes right?</p>
</blockquote>
<p>No reason to revert them.  You'll just want to be intentional when you "svn diff" anything in the future to make sure you don't pull in ebm changes.</p>



<a name="185134639"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185134639" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185134639">(Jan 08 2020 at 17:14)</a>:</h4>
<p><span class="user-mention" data-user-id="250111">@Jeffrey Liu</span> can you submit the Great Wave model as a patch?  that'd make a great sample ebm for the db/ directory to showcase the new embedded binunif ebm data source capability.  You'll want to make sure the model is cleanly near the origin (with 0,0,0 at the bottom-left corner or base center), has a title set (e.g., Great Wave Off Kanagawa silhouette as an extruded bitmap by Jeffrey Liu), has good object names, has a region defined, etc., and also hooked into the CMakeLists.txt file so it gets installed.  Think it'll need to be added as a .g as I don't believe binunif serialize to .asc yet.</p>



<a name="185151172"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185151172" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185151172">(Jan 08 2020 at 20:03)</a>:</h4>
<p>No problem, I'll do that as soon as I can :) For future projects, I'd definitely like to first tie up any loose ends with EBM/DSP and appleseed (perhaps at a slightly more leisurely but thorough pace), and then find something else do to from there.</p>



<a name="185151652"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185151652" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185151652">(Jan 08 2020 at 20:09)</a>:</h4>
<p>The image is pretty large though (it's around 3500x2500 if I recall), should I scale it down or find a smaller image so it takes up less space?</p>



<a name="185155197"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185155197" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185155197">(Jan 08 2020 at 20:50)</a>:</h4>
<p>Yeah, the .g becomes almost 10mb with it, so I think it'd be better if I scaled it down a bit.</p>



<a name="185159408"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185159408" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185159408">(Jan 08 2020 at 21:34)</a>:</h4>
<p>how does it compress?</p>



<a name="185159508"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185159508" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185159508">(Jan 08 2020 at 21:35)</a>:</h4>
<p>even if it doesn't compress well, 10mb is not a problem</p>



<a name="185159590"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185159590" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185159590">(Jan 08 2020 at 21:35)</a>:</h4>
<p>if it compresses well, you could have it be external, but then "compile" a version that has it imported as a binunif</p>



<a name="185160128"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185160128" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185160128">(Jan 08 2020 at 21:42)</a>:</h4>
<p>Sorry, I'm not quite sure if I understand what you mean by compress. Does it have something to do with CMake?</p>



<a name="185160217"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185160217" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185160217">(Jan 08 2020 at 21:43)</a>:</h4>
<p>if you run gzip on the data, how small does it get</p>



<a name="185160316"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185160316" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185160316">(Jan 08 2020 at 21:44)</a>:</h4>
<p>Ah oops, sorry about that - I've never used it before. I'll do it right now.</p>



<a name="185160349"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185160349" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185160349">(Jan 08 2020 at 21:45)</a>:</h4>
<p>you're on windows, right?</p>



<a name="185160376"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185160376" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185160376">(Jan 08 2020 at 21:45)</a>:</h4>
<p>it's akin to making a .zip file</p>



<a name="185160393"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185160393" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185160393">(Jan 08 2020 at 21:45)</a>:</h4>
<p>just wouldn't use the .zip format, it's terribly inefficient</p>



<a name="185160474"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185160474" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185160474">(Jan 08 2020 at 21:46)</a>:</h4>
<p>if you have 7-zip installed, it has support for the bzip2 and gzip formats that do much better</p>



<a name="185160626"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185160626" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185160626">(Jan 08 2020 at 21:48)</a>:</h4>
<p>cmake has built-in support for both too, so the general idea would be to add the image data as a compressed bz2 or gz file, then during "make", you'd run a custom command that decompresses the data file and imports it into a .g file.</p>



<a name="185160685"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185160685" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185160685">(Jan 08 2020 at 21:50)</a>:</h4>
<p>if that's all too complicated, seriously, you can just add the .g file as-is.  10mb will probably compress down to less than 1mb but it's not a big deal.  we have bigger .g's in there already.</p>



<a name="185160796"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185160796" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185160796">(Jan 08 2020 at 21:51)</a>:</h4>
<p>That makes sense, I'll try it out at the very least</p>



<a name="185164741"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185164741" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185164741">(Jan 08 2020 at 22:34)</a>:</h4>
<p>It's only 204 kb now!!</p>



<a name="185164778"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185164778" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185164778">(Jan 08 2020 at 22:35)</a>:</h4>
<p>cool!</p>



<a name="185164803"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185164803" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185164803">(Jan 08 2020 at 22:35)</a>:</h4>
<p>bitmap data tends to compress extremely well</p>



<a name="185164930"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185164930" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185164930">(Jan 08 2020 at 22:36)</a>:</h4>
<p>something we've had on our roadmap for a long time is the ability to store objects compressed in the .g file, so storing a binunif compressed for example.  that would be awesome for lots of things.</p>



<a name="185165741"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185165741" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185165741">(Jan 08 2020 at 22:45)</a>:</h4>
<p>Yeah, I can imagine how. Has there been any work done towards it so far?</p>



<a name="185165827"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185165827" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185165827">(Jan 08 2020 at 22:46)</a>:</h4>
<p>our file format specification has bits reserved to say "this is compressed" but no compression currently happens</p>



<a name="185165895"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185165895" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185165895">(Jan 08 2020 at 22:46)</a>:</h4>
<p>probably wouldn't be too hard now that we have lz4 (a compression library) integrated</p>



<a name="185168029"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185168029" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185168029">(Jan 08 2020 at 23:12)</a>:</h4>
<p>Oh wait, I just gzipped the geometry database with the image data already imported, is that okay? I noticed that the CMake text doesn't mention anything about .gz though, so would I need to include that somewhere as well?</p>



<a name="185169180"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185169180" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185169180">(Jan 08 2020 at 23:32)</a>:</h4>
<p><span class="user-mention" data-user-id="250111">@Jeffrey Liu</span> Yeah, I think that's fine.  You'll want to check out the cmake "tar" command.  It has compression/decompression options.  BZip2 ('j' option) is best.</p>



<a name="185181122"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185181122" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185181122">(Jan 09 2020 at 03:42)</a>:</h4>
<p>Ah ok, thanks! So if I zipped it with BZip2, would it be enough to just include something like <code>tar -E cjf tsunami.g.bz2 tsunami.g</code> at the end of db/CMakeLists.txt?</p>



<a name="185181177"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185181177" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185181177">(Jan 09 2020 at 03:44)</a>:</h4>
<p>Something seems a little off with that, but the ADD_G_TARGET function doesn't mention anything about zipped geometry database files so I'm not sure if I'm supposed to add it to G_SAMPLE_MODELS.</p>



<a name="185192699"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185192699" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185192699">(Jan 09 2020 at 08:40)</a>:</h4>
<p>you're probably not going to be able to use the typical macros we wrote</p>



<a name="185192875"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185192875" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185192875">(Jan 09 2020 at 08:43)</a>:</h4>
<p><span class="user-mention" data-user-id="250111">@Jeffrey Liu</span> look at regress/icv/CMakeLists.txt for a better example, search for "tar "</p>



<a name="185192886"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185192886" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185192886">(Jan 09 2020 at 08:43)</a>:</h4>
<p>then note where the ppm is used</p>



<a name="185192920"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185192920" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185192920">(Jan 09 2020 at 08:44)</a>:</h4>
<p>you'll want something similar for you file to unpack it and install it</p>



<a name="185223743"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185223743" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185223743">(Jan 09 2020 at 15:45)</a>:</h4>
<p>Ok thanks, I'll check it out as soon as I can - I was having some trouble finding an example where tar was being used.</p>



<a name="185276357"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185276357" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185276357">(Jan 10 2020 at 02:07)</a>:</h4>
<p>So for this, should I just leave the command outside of the ADD_G_TARGET function and exclude the .bz2 from the G_SAMPLE_MODELS? I think that if I left it in there, I would need to add a check for .bz2 files within the function itself. I'm perfectly fine with doing it, but I wasn't sure if that's making too many unwanted changes to the file.</p>



<a name="185280457"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185280457" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185280457">(Jan 10 2020 at 03:59)</a>:</h4>
<p>^ so what I meant by that was I would do something like this: <a href="/user_uploads/1549/ghu5nQEQZX45uiHQTExOF5sc/bz.patch" target="_blank" title="bz.patch">bz.patch</a> I have no idea if this solution would work or not, but calling <code>tar</code> outside of the rest of the logic seemed a little bit messy</p>



<a name="185280897"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185280897" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185280897">(Jan 10 2020 at 04:13)</a>:</h4>
<p>Hmm.  That might actually do fairly well - you may want to try an extension of .g.tbz2  to match what we're doing for the images - tar and bzip2 are generic to file type.</p>



<a name="185280949"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185280949" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185280949">(Jan 10 2020 at 04:14)</a>:</h4>
<p>I'd have to test if that logic can work with the more elaborate extension - it might not as-is.</p>



<a name="185281180"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185281180" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185281180">(Jan 10 2020 at 04:20)</a>:</h4>
<p>You've already got the key idea by adding the bz2 logic in the right place - the most likely failure point is needing to handle a two-part file extension with that REGEX expression - it may work as is, but I'd have to try it to be sure.</p>



<a name="185281326"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185281326" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185281326">(Jan 10 2020 at 04:25)</a>:</h4>
<p><span class="user-mention" data-user-id="250111">@Jeffrey Liu</span>   You can actually use CMake itself to make the tbz2 file.  On Linux it would be:</p>
<p>cmake -E tar cfj tsunami.g.tbz2 tsunami.g</p>



<a name="185302235"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185302235" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185302235">(Jan 10 2020 at 11:34)</a>:</h4>
<p>Thanks! The command worked for me as well. I haven't tested the actual logic itself yet, but I think I might want to set this aside for just a little bit so I can focus on my appleseed task.</p>



<a name="185307966"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185307966" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185307966">(Jan 10 2020 at 13:04)</a>:</h4>
<p>Sounds good.</p>



<a name="185335071"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185335071" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185335071">(Jan 10 2020 at 18:09)</a>:</h4>
<p>Actually, I did have one more question. What exactly is the DEPENDS macro used for? I noticed that all of the other add_custom_commands had it at the end, which also had the command as an argument. I was thinking about doing something like this: </p>
<div class="codehilite"><pre><span></span>if(${MODEL_TYPE} STREQUAL &quot;g.tbz2&quot;)
    add_custom_command(
      OUTPUT ${CMAKE_CURRENT_BUILD_DIR_SCRIPT}/${output_file}
      COMMAND ${CMAKE_COMMAND} -E tar xjf ${CMAKE_CURRENT_SOURCE_DIR}/${in_model} WORKING_DIRECTORY ${CMAKE_CURRENT_BUILD_DIR}
      DEPENDS ${CMAKE_COMMAND} ${CMAKE_CURRENT_SOURCE_DIR}/${in_model}
    )
endif(${MODEL_TYPE} STREQUAL &quot;g.tbz2&quot;)
</pre></div>


<p>but I couldn't find what it was supposed to do exactly.</p>



<a name="185369484"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185369484" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185369484">(Jan 11 2020 at 02:23)</a>:</h4>
<p>DEPENDS tells the build target that it is dependent on that file (or another build target).  That way, if the input file or a target that is required by the current target changes, the build system knows it needs to recreate the .g file</p>



<a name="185375699"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/185375699" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#185375699">(Jan 11 2020 at 05:36)</a>:</h4>
<p>Ah ok, thanks for the explanation! So I guess it would be better to include it then?</p>



<a name="186450769"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/186450769" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#186450769">(Jan 24 2020 at 00:13)</a>:</h4>
<p>Before I forget, here's some of the preliminary stuff I did for the example ebm .g file: <a href="/user_uploads/1549/44tOMXZr3cw3wYje1xe_nJR6/example_ebm.patch" target="_blank" title="example_ebm.patch">example_ebm.patch</a> <a href="/user_uploads/1549/3i_sVE_yEgqy3KAjF7Iv-1AQ/tsunami.g.tbz2" target="_blank" title="tsunami.g.tbz2">tsunami.g.tbz2</a> I'm almost positive it's building correctly, but in the wrong directory (build/db instead of build/Debug/share/db) - it's probably a pretty easy fix that I'll take care of later, I just haven't taken that close of a look at it for a while.</p>



<a name="186559025"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/186559025" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#186559025">(Jan 25 2020 at 05:46)</a>:</h4>
<p>thanks <span class="user-mention" data-user-id="250111">@Jeffrey Liu</span> !  Definitely don't want to loose track of this work.  I was just testing the ebm code changes work recently.  It's almost ready to integrate, but a few issues I had to track down.</p>



<a name="186572439"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/186572439" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#186572439">(Jan 25 2020 at 12:56)</a>:</h4>
<p>That's great - if there's anything I can do on my end, please let me know!</p>



<a name="186572826"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/186572826" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#186572826">(Jan 25 2020 at 13:08)</a>:</h4>
<p>Which also reminds me, there were a few minor bugs that I should submit tickets for relating to DSP/EBM</p>



<a name="186589454"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/186589454" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#186589454">(Jan 25 2020 at 21:30)</a>:</h4>
<p>or even better, submit a patch that fixes the issue <span class="user-mention" data-user-id="250111">@Jeffrey Liu</span>  :)</p>



<a name="186589784"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/186589784" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#186589784">(Jan 25 2020 at 21:41)</a>:</h4>
<blockquote>
<p>or even better, submit a patch that fixes the issue <span class="user-mention silent" data-user-id="250111">Jeffrey Liu</span>  :)</p>
</blockquote>
<p>Yep, that would be the plan, but seeing as I'll probably be working mostly on Appleseed integration, I thought I'd submit tickets so that I don't lose track of the bugs I found (to be honest, I already had to scroll through the chat to recall what the issues were).</p>



<a name="186589787"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/186589787" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#186589787">(Jan 25 2020 at 21:41)</a>:</h4>
<p>what was the issue?</p>



<a name="186589956"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/186589956" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#186589956">(Jan 25 2020 at 21:46)</a>:</h4>
<p>So I think I found 3/4 - one was the issue of tk_getOpenFile() returning an absolute path while bu_open_mapped_file_with_path() was expecting a relative path, another was the issue of editing the data source of a DSP object-based source (the file browser was still opening), another one was the issue of trying to select a DSP object with the primitive editor (this one is odd, since I'm getting 2 different errors on the version of MGED that I installed vs. the version of MGED compiled on a recent revision)</p>



<a name="186590028"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/186590028" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#186590028">(Jan 25 2020 at 21:48)</a>:</h4>
<p>I've also had a weird issue with the 'p' command, where I keep getting "three arguments needed" when trying to edit attributes of EBM or DSP (I haven't tried other object types yet), but I'm surprised that nothing similar has been reported before from what I've seen.</p>



<a name="186590098"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/186590098" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#186590098">(Jan 25 2020 at 21:50)</a>:</h4>
<p>"bu_open_mapped_file_with_path() was expecting a relative path" &lt;--- that doesn't sound right</p>



<a name="186590119"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/186590119" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#186590119">(Jan 25 2020 at 21:51)</a>:</h4>
<p>definitely seemed to run into a bug with the 'p' command -- I hit the same bug but didn't have time to debug it</p>



<a name="186590175"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/186590175" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#186590175">(Jan 25 2020 at 21:53)</a>:</h4>
<blockquote>
<p>"bu_open_mapped_file_with_path() was expecting a relative path" &lt;--- that doesn't sound right</p>
</blockquote>
<p>I think you're right, I just took a look at the BUGS file and this may be the cause <code>dsp primitives specifying data using Windows style file paths don't work.</code> In which case, my bug ticket is wrong/already reported...</p>



<a name="186590183"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/186590183" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#186590183">(Jan 25 2020 at 21:53)</a>:</h4>
<p>the 'p' parameter command is tailored to different states, so there's undoubtedly something just not described right for the state it needed to be in</p>



<a name="186590227"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/186590227" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#186590227">(Jan 25 2020 at 21:54)</a>:</h4>
<p>yet they should just work if they are getting passed through to open()</p>



<a name="186590556"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/186590556" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#186590556">(Jan 25 2020 at 22:05)</a>:</h4>
<p>I did some debugging on it back when I was working on the EBM tasks, and if I recall correctly, it was because of a conditional in mged_param() where es_edflag didn't satisfy the if statement so it jumped to the else statement for "three arguments needed"</p>



<a name="186590987"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/186590987" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#186590987">(Jan 25 2020 at 22:18)</a>:</h4>
<p>Yeah, so the condition checks for this: <code>if (es_edflag == PSCALE || es_edflag == SSCALE || es_edflag == ECMD_BOT_THICK)</code>, but the DSP and EBM settings are setting es_edflag to these:</p>
<div class="codehilite"><pre><span></span>#define ECMD_EBM_DSRC       53  /* set EBM data source */
#define ECMD_EBM_FSIZE      54  /* set EBM file size */
#define ECMD_EBM_HEIGHT     55  /* set EBM extrusion depth */

#define ECMD_DSP_FNAME      56  /* set DSP file name */
#define ECMD_DSP_FSIZE      57  /* set DSP file size */
#define ECMD_DSP_SCALE_X        58  /* Scale DSP x size */
#define ECMD_DSP_SCALE_Y        59  /* Scale DSP y size */
#define ECMD_DSP_SCALE_ALT      60  /* Scale DSP Altitude size */
</pre></div>



<a name="186591060"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/186591060" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#186591060">(Jan 25 2020 at 22:20)</a>:</h4>
<p>An easy fix would be to just add the correct settings to the conditional (I think that's what's already being done for ECMD_BOT_THICK). I could do that right now, unless there's a better approach?</p>



<a name="186591857"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/186591857" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#186591857">(Jan 25 2020 at 22:46)</a>:</h4>
<p>Taking a bit of a closer look, I'm wondering if the conditional should actually be checking for something like EDIT_SCALE instead, which seems to encompass more things instead of just PSCALE AND SSCALE, although it still doesn't account for EBM or DSP's FSIZE.</p>



<a name="186593211"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/186593211" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#186593211">(Jan 25 2020 at 23:31)</a>:</h4>
<p>This change worked for me <a href="/user_uploads/1549/zY-cedxcRMjFDZ5FNNSWkPAQ/p_command_fix.patch" target="_blank" title="p_command_fix.patch">p_command_fix.patch</a>, if I'm using EDIT_SCALE as it was intended. Setting EBM file size and depth and DSP altitude work as expected with the change applied.</p>



<a name="186756834"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/186756834" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#186756834">(Jan 28 2020 at 06:36)</a>:</h4>
<p>I have been getting another error, but I've had some trouble debugging it because I think it's TCL related... for me, I'm consistently getting an error when I try to modify/create a DSP using the primitive editor. Curious if other people have seen this?</p>



<a name="186757646"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/186757646" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#186757646">(Jan 28 2020 at 06:58)</a>:</h4>
<p>These are the errors I'm getting - they are when I try to edit or create a DSP respectively: <a href="/user_uploads/1549/c02W0BLyn9Kmu3wI8eZ2Pdl9/error.log" target="_blank" title="error.log">error.log</a> <a href="/user_uploads/1549/_VCpL0R2xyfSDXVoC7pHdkm7/error1.log" target="_blank" title="error1.log">error1.log</a></p>



<a name="187285372"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/187285372" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#187285372">(Feb 03 2020 at 17:42)</a>:</h4>
<p>Awesome <span class="user-mention" data-user-id="250111">@Jeffrey Liu</span> !  That's some good debugging on the 'p' command.</p>



<a name="187330550"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/187330550" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#187330550">(Feb 04 2020 at 04:54)</a>:</h4>
<p>Thank you! Was the patch acceptable?</p>



<a name="187330770"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/187330770" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#187330770">(Feb 04 2020 at 05:00)</a>:</h4>
<p>The edsol code is just awful but your added case for dsp and ebm looked good to me.</p>



<a name="187330776"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/187330776" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#187330776">(Feb 04 2020 at 05:01)</a>:</h4>
<p><span class="user-mention" data-user-id="250111">@Jeffrey Liu</span> the only bit I'm unsure of is what's going on with EDIT_SCALE?</p>



<a name="187330854"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/187330854" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#187330854">(Feb 04 2020 at 05:02)</a>:</h4>
<p>I noticed that the conditionals for PSCALE and SSCALE weren't covering what was needed for DSP and EBM, which is why I changed it to EDIT_SCALE which seemed to include it. It may not be the correct macro to use in that case though?</p>



<a name="187330912"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/187330912" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#187330912">(Feb 04 2020 at 05:04)</a>:</h4>
<p>I have no idea honestly</p>



<a name="187330951"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/187330951" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#187330951">(Feb 04 2020 at 05:05)</a>:</h4>
<p>it seems okay on the surface.  question would be whether any of the additional clauses covered by, say SEDIT_SCALE, supposed to take more than one parameter</p>



<a name="187330958"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/187330958" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#187330958">(Feb 04 2020 at 05:05)</a>:</h4>
<p>also odd then, why is ECMD_BOT_THICK not included in SEDIT_SCALE.  should it be?</p>



<a name="187331037"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/187331037" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#187331037">(Feb 04 2020 at 05:08)</a>:</h4>
<p>I'm not sure, I'll take a look at it again to make sure. There were some other options with SEDIT_SCALE and OEDIT_SCALE that I'd never used before, so it's possible that there are some that take in more than a single parameter.</p>



<a name="187331086"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/187331086" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#187331086">(Feb 04 2020 at 05:08)</a>:</h4>
<p>that would be the only thing to make sure, since it adds about 10 more that wheren't being tested there</p>



<a name="187331098"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/187331098" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#187331098">(Feb 04 2020 at 05:09)</a>:</h4>
<p>Right</p>



<a name="187331446"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/187331446" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#187331446">(Feb 04 2020 at 05:19)</a>:</h4>
<p>I'm pretty sure I tested the DSP and EBM scaling when I changed it, but I didn't really find much documentation on some of the other things (Cline?) so I couldn't test those</p>



<a name="187331496"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/187331496" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#187331496">(Feb 04 2020 at 05:20)</a>:</h4>
<p>cline can be ignored</p>



<a name="187331607"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/187331607" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#187331607">(Feb 04 2020 at 05:23)</a>:</h4>
<p>Ah ok, how about EXTR?</p>



<a name="187335778"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/187335778" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#187335778">(Feb 04 2020 at 07:20)</a>:</h4>
<p>probably ignorable, I think they're all RT_NURB_ which is the old nurbs implementation, now defunct</p>



<a name="187335787"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/187335787" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#187335787">(Feb 04 2020 at 07:20)</a>:</h4>
<p>I didn't look that closely.  Is that all of what was left?</p>



<a name="187386954"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/187386954" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#187386954">(Feb 04 2020 at 18:48)</a>:</h4>
<p>Aside from those, the rest of them (besides EBM and DSP), if I remember correctly, had to do with VOL. I should be able to test those myself though.</p>



<a name="187399531"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/187399531" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#187399531">(Feb 04 2020 at 20:59)</a>:</h4>
<p>Just saw that the EBM changes were implemented! One minor thing when merging though, I might have noticed and changed this after I submitted the original patch. Sorry about that! <a href="/user_uploads/1549/bcq9GgNaPJcbudPwDbT0Nwwk/ebm_src.patch" target="_blank" title="ebm_src.patch">ebm_src.patch</a></p>



<a name="187399602"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/187399602" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#187399602">(Feb 04 2020 at 21:00)</a>:</h4>
<p>For reference, it's just that ebm-&gt;datasrc was being set to RT_DSP_SRC_(TYPE) instead of RT_EBM_SRC_(TYPE). My fault - I probably changed this later but forgot to update the patch.</p>



<a name="187472204"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/187472204" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#187472204">(Feb 05 2020 at 16:58)</a>:</h4>
<p><span class="user-mention" data-user-id="250111">@Jeffrey Liu</span> oh wow, I missed that on review.  thanks!</p>



<a name="187472217"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/187472217" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#187472217">(Feb 05 2020 at 16:58)</a>:</h4>
<p>fortunately, they're the same value (today), but good catch regardless.</p>



<a name="187472914"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/187472914" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#187472914">(Feb 05 2020 at 17:05)</a>:</h4>
<p><span class="user-mention" data-user-id="250111">@Jeffrey Liu</span> since you've been working in that area of the code and have some experience now, and see how VOL is pretty much in the same situation as EBM and DSP, can you think of a good way to generalize what they're doing in a reusable manner</p>



<a name="187472996"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/187472996" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#187472996">(Feb 05 2020 at 17:06)</a>:</h4>
<p>so that VOL isn't version #3 of the get_file_data() and get_obj_data() .. and whatever additional objects that end up supporting internal and external data sources</p>



<a name="187489619"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/187489619" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#187489619">(Feb 05 2020 at 20:04)</a>:</h4>
<p>Interesting, like get_obj_data() and get_file_data() in a separate file that can be called by any of the three?</p>



<a name="187495859"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/187495859" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#187495859">(Feb 05 2020 at 21:16)</a>:</h4>
<p>yeah, some sort of generalized interface for this pattern</p>



<a name="187496409"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/187496409" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#187496409">(Feb 05 2020 at 21:23)</a>:</h4>
<p>I'm thinking maybe something like a "struct rt_data_obj *data" field that would replace the existing name field, src field, and the #defines for src/obj.</p>



<a name="187496569"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/187496569" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#187496569">(Feb 05 2020 at 21:24)</a>:</h4>
<p>Maybe something like a simple api that works with it like rt_data_read(struct rt_data_obj <em>,  (</em>rt_data_file_func)(), (*rt_data_obj_func)()) and rt_data_write() to read and write object data using callback functions defined by individual primitives.  Or alternatively, something involving ICV to just specify an image/data source and let the primitive's prep auto-convert accordingly.</p>



<a name="187513479"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/187513479" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#187513479">(Feb 06 2020 at 01:45)</a>:</h4>
<p>Hm I didn't even think of the struct, but that definitely seems a lot cleaner. I'm not sure if I completely understand what you mean by the API though, could you elaborate?</p>



<a name="211693766"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/211693766" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffrey Liu <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#211693766">(Sep 29 2020 at 22:36)</a>:</h4>
<p><span class="user-mention" data-user-id="102902">@Sean</span>  if I remember correctly, you commented on one of my tickets recently about the EBM GUI. I'm not sure if you saw my response, but I didn't commit those changes. I uploaded them to another patch here: <a href="https://sourceforge.net/p/brlcad/patches/540/">https://sourceforge.net/p/brlcad/patches/540/</a>.  Please let me know if there's anything else I can do to help!</p>



<a name="211774165"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/EBM/near/211774165" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/EBM.html#211774165">(Sep 30 2020 at 15:09)</a>:</h4>
<p>Will do</p>



<hr><p>Last updated: Aug 04 2025 at 01:05 UTC</p>
</html>