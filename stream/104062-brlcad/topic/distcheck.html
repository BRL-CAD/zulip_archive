<html>
<head><meta charset="utf-8"><title>distcheck · brlcad · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/index.html">brlcad</a></h2>
<h3>Topic: <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/distcheck.html">distcheck</a></h3>

<hr>

<base href="https://brlcad.zulipchat.com">

<head><link href="https://brl-cad.github.io/zulip_archive/style.css" rel="stylesheet"></head>

<a name="455712803"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/distcheck/near/455712803" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/distcheck.html#455712803">(Aug 01 2024 at 17:30)</a>:</h4>
<p>Anyone else seeing distcheck-full errors on main?  I'm getting a handful that look like valid bugs:</p>
<div class="codehilite" data-code-language="Text only"><pre><span></span><code>...
 35/922 Test  #33: bu_file ....................................................***Failed    0.01 sec

file [FAIL] test input file bu_file_test_dir/bu_file_1 is incorrectly reported to be executable
...
373/922 Test #374: bu_color_to_rgb_floats_1 ...................................***Failed    0.00 sec
Result: 0.752941,0.305882,0.839216
...
Start 922: ged_test_drawing_quad
919/922 Test #922: ged_test_drawing_quad ......................................Subprocess aborted***Exception:   0.00 sec
dyld[94599]: Library not loaded: @executable_path/../lib/libtcl8.6.dylib
  Referenced from: &lt;77324E71-4FC8-3FA9-B662-6DD9330C4344&gt; /Volumes/X10/brlcad/.build.debug/distcheck-in_src_dir/brlcad-7.40.1/src/libged/tests/draw/ged_test_quad
  Reason: tried: '/Volumes/X10/brlcad/.build.debug/distcheck-in_src_dir/brlcad-7.40.1/src/libged/tests/lib/libtcl8.6.dylib' (no such file)

920/922 Test #907: rt_cache_serial_multiple_different_objects .................   Passed    7.23 sec
921/922 Test #555: bu_mappedfile_serial_16384 .................................   Passed  100.26 sec
922/922 Test #556: bu_mappedfile_parallel_16384 ...............................   Passed  120.57 sec

99% tests passed, 12 tests failed out of 922

Total Test time (real) = 125.61 sec

The following tests FAILED:
         33 - bu_file (Failed)
        374 - bu_color_to_rgb_floats_1 (Failed)
        910 - rt_search_tests (Subprocess aborted)
        914 - ged_test_tops_moss (Subprocess aborted)
        915 - ged_test_list (Subprocess aborted)
        916 - ged_test_material (Subprocess aborted)
        917 - ged_test_search (Subprocess aborted)
        918 - ged_test_drawing_basic (Subprocess aborted)
        919 - ged_test_drawing_faceplate (Subprocess aborted)
        920 - ged_test_drawing_lod (Subprocess aborted)
        921 - ged_test_drawing_select (Subprocess aborted)
        922 - ged_test_drawing_quad (Subprocess aborted)
Errors while running CTest
</code></pre></div>
<p>First two look like bugs, subprocess looks to be maybe something wrong in the relocatability dylib/exec editing.</p>



<a name="455731489"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/distcheck/near/455731489" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/distcheck.html#455731489">(Aug 01 2024 at 18:52)</a>:</h4>
<p>I've not seen those errors - are they only in the in-src-dir config or do they pop up in others as well?</p>



<a name="455760039"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/distcheck/near/455760039" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/distcheck.html#455760039">(Aug 01 2024 at 21:31)</a>:</h4>
<p><span class="user-mention" data-user-id="112516">@starseeker</span> I just ran distcheck-full… didn’t see any other errors.  I haven’t just run a plain distcheck too but was going to check that also.</p>



<a name="455794065"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/distcheck/near/455794065" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/distcheck.html#455794065">(Aug 02 2024 at 01:07)</a>:</h4>
<p>Just an update, ran make check and the errors are agnostic.  Fails debug and release on those tests, so something newish.</p>



<a name="455840434"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/distcheck/near/455840434" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/distcheck.html#455840434">(Aug 02 2024 at 06:08)</a>:</h4>
<p>Failures are also on RELEASE branch just the same. </p>
<p>Looking into the lib issues, looks like it's because the unit tests are wired wrong, as if they were installed into bin:</p>
<div class="codehilite" data-code-language="Text only"><pre><span></span><code>morrison@Miniagua tests % ./ged_test_tops
dyld[47269]: Library not loaded: @executable_path/../lib/libtcl8.6.dylib
  Referenced from: &lt;82312D51-F510-33AC-9283-067C3FBAFF54&gt; /Volumes/X10/brlcad.RELEASE/.build.release/src/libged/tests/ged_test_tops
  Reason: tried: '/Volumes/X10/brlcad.RELEASE/.build.release/src/libged/lib/libtcl8.6.dylib' (no such file)
zsh: abort      ./ged_test_tops
morrison@Miniagua tests % DYLD_LIBRARY_PATH=../../../lib ./ged_test_tops
Usage: ./ged_test_tops file.g
morrison@Miniagua tests % otool -L ./ged_test_tops
./ged_test_tops:
    @rpath/libged.20.dylib (compatibility version 20.0.0, current version 20.0.1)
    @rpath/libanalyze.20.dylib (compatibility version 20.0.0, current version 20.0.1)
    @rpath/libwdb.20.dylib (compatibility version 20.0.0, current version 20.0.1)
    @rpath/liboptical.20.dylib (compatibility version 20.0.0, current version 20.0.1)
    @executable_path/../lib/libtcl8.6.dylib (compatibility version 8.6.0, current version 8.6.14)
    @rpath/libdm.20.dylib (compatibility version 20.0.0, current version 20.0.1)
    @rpath/libicv.20.dylib (compatibility version 20.0.0, current version 20.0.1)
    @rpath/libnetpbm.dylib (compatibility version 0.0.0, current version 0.0.0)
    @rpath/libutahrle.19.dylib (compatibility version 19.0.0, current version 19.0.1)
    @rpath/librt.20.dylib (compatibility version 20.0.0, current version 20.0.1)
    @rpath/libbrep.20.dylib (compatibility version 20.0.0, current version 20.0.1)
    @rpath/libnmg.dylib (compatibility version 0.0.0, current version 0.0.0)
    @rpath/libbv.20.dylib (compatibility version 20.0.0, current version 20.0.1)
    @rpath/libbg.20.dylib (compatibility version 20.0.0, current version 20.0.1)
    @rpath/libbn.20.dylib (compatibility version 20.0.0, current version 20.0.1)
    @rpath/libOpenNURBS.dylib (compatibility version 0.0.0, current version 0.0.0)
    @rpath/libmanifold.2.dylib (compatibility version 2.0.0, current version 2.4.5)
    @rpath/libassimp.5.dylib (compatibility version 5.0.0, current version 5.4.1)
    @rpath/libgeogram.1.dylib (compatibility version 1.0.0, current version 1.9.0)
    @rpath/libpkg.20.dylib (compatibility version 20.0.0, current version 20.0.1)
    @rpath/libbu.20.dylib (compatibility version 20.0.0, current version 20.0.1)
    /usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 1336.61.1)
    @rpath/png.framework/Versions/1.6.43/png (compatibility version 0.0.0, current version 0.0.0)
    @rpath/libz_brl.1.dylib (compatibility version 1.0.0, current version 1.3.1)
    @rpath/liblmdb.dylib (compatibility version 0.0.0, current version 0.0.0)
    @rpath/libregex_brl.1.dylib (compatibility version 1.0.0, current version 1.0.4)
morrison@Miniagua tests % pwd
/Volumes/X10/brlcad.RELEASE/.build.release/src/libged/tests
</code></pre></div>



<a name="456036621"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/distcheck/near/456036621" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/distcheck.html#456036621">(Aug 02 2024 at 20:24)</a>:</h4>
<p><span class="user-mention" data-user-id="112516">@starseeker</span> investigated the dyld issue a few hours and don't understand why libtcl is being changed/installed with a @executable_path into the lib.  Do you recall why? </p>
<p>That seems to fundamentally be the issue.  If I replace @executable_path/../lib/libtcl8.6.dylib with @rpath/libtcl8.6.dylib like all the other libs, it works just fine.  I had to replace them in libtcl itself as well as all the libs and apps that link tcl, but presumably they're inheriting from libtcl's original setting.</p>
<p>I found the section in the patch file where you override it, but wanted to check why before mucking with it.</p>



<a name="456053022"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/distcheck/near/456053022" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/distcheck.html#456053022">(Aug 02 2024 at 22:27)</a>:</h4>
<p>At a guess I probably was using the settings from elsewhere in our build, and didn't properly clue in that I needed to go that route for libtcl</p>



<a name="456109002"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/distcheck/near/456109002" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/distcheck.html#456109002">(Aug 03 2024 at 05:50)</a>:</h4>
<p>No other library appears to have/do that.. don't see it anywhere else, but maybe I'm missing it.  That's why I was wondering why you have that specific patch being applied to Tcl's build logic, to make it use @executable_path.</p>



<a name="456157569"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/distcheck/near/456157569" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/distcheck.html#456157569">(Aug 03 2024 at 13:14)</a>:</h4>
<p>I don't recall anything specific - most likely an error on my part, would be my guess</p>



<a name="456720201"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/distcheck/near/456720201" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/distcheck.html#456720201">(Aug 05 2024 at 22:33)</a>:</h4>
<p>I might have an idea about what I was thinking, looking at the Tcl patch.  The first part of the patch, with the logic for CFG_RUNTIME and CFG_INSTALL, depends on Tcl_GetNameOfExecutable having something that will work with the relative paths.</p>



<a name="456720418"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/distcheck/near/456720418" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/distcheck.html#456720418">(Aug 05 2024 at 22:34)</a>:</h4>
<p>It's basically similar to what happens when _bu_dir_brlcad_root calls  wai_getExecutablePath - except in the Tcl case we don't have the equivalent of a fallback to wai_getModulePath</p>



<a name="456720655"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/distcheck/near/456720655" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/distcheck.html#456720655">(Aug 05 2024 at 22:36)</a>:</h4>
<p>In a "normal" Tcl install those paths are absolute to the install path, so it's not an issue, but that's not an option for a relocatable Tcl install.</p>



<a name="456721000"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/distcheck/near/456721000" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/distcheck.html#456721000">(Aug 05 2024 at 22:38)</a>:</h4>
<p>That may be why I went ahead and set that DYLIB_INSTALL_DIR the way I did, since there wouldn't be any expectation of things working without a suitable path from Tcl_GetNameOfExecutable</p>



<a name="456726874"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/distcheck/near/456726874" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/distcheck.html#456726874">(Aug 05 2024 at 23:28)</a>:</h4>
<p>I'll try the @rpath setting anyway and we can see what happens</p>



<a name="456727061"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/distcheck/near/456727061" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/distcheck.html#456727061">(Aug 05 2024 at 23:30)</a>:</h4>
<p>Pushed to main</p>



<a name="456873718"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/distcheck/near/456873718" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/distcheck.html#456873718">(Aug 06 2024 at 14:38)</a>:</h4>
<p>At least on a auto debug rebuild, I'm hitting an error that is probably unrelated, but same error I think bill was getting:</p>
<p>[  6%] Building C object CMakeFiles/itcl3.4.dir/generic/itclStubInit.c.o<br>
-- stderr output is:</p>
<p>In file included from /Volumes/X10/brlcad/.build/bext_build/itcl/ITCL_BLD-prefix/src/ITCL_BLD/generic/itclStubInit.c:12:</p>
<p>/Volumes/X10/brlcad/.build/bext_build/itcl/ITCL_BLD-prefix/src/ITCL_BLD/generic/itclInt.h:50:10: fatal error: 'tclInt.h' file not found</p>
<p>#include "tclInt.h"</p>
<p>^~~~~~~~~~</p>
<p>1 error generated.</p>
<p>make[5]: *** [CMakeFiles/itcl3.4.dir/generic/itclStubInit.c.o] Error 1</p>



<a name="456874039"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/distcheck/near/456874039" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/distcheck.html#456874039">(Aug 06 2024 at 14:39)</a>:</h4>
<p>On a debug BRLCAD_BEXT_DIR build, it gets much much farther, but fails during asc2g:</p>
<p>[ 62%] Built target asc2g</p>
<p>[ 62%] <strong>Generating ../share/db/bldg391.g</strong></p>
<p>[ 62%] Built target bldg391.g</p>
<p>[ 62%] <strong>Generating ../share/db/m35.g</strong></p>
<p>[ 62%] Built target m35.g</p>
<p>[ 62%] <strong>Generating ../share/db/moss.g</strong></p>
<p>[ 62%] Built target moss.g</p>
<p>[ 62%] <strong>Generating ../share/db/sphflake.g</strong></p>
<p>[ 62%] Built target sphflake.g</p>
<p>[ 62%] <strong>Generating ../share/db/star.g</strong></p>
<p>[ 62%] Built target star.g</p>
<p>[ 62%] <strong>Generating ../share/db/world.g</strong></p>
<p>[ 62%] Built target world.g</p>
<p>[ 62%] <strong>Generating ../share/db/aet.g</strong></p>
<p>CMake Error at aet.cmake:36 (message):</p>
<p>[aet] Failure: 1</p>
<p>/Volumes/X10/brlcad/.build.debug/bin/asc2g</p>
<p>/Volumes/X10/brlcad/db/aet.asc;/Volumes/X10/brlcad/.build.debug/share/db/aet.g"</p>
<p>Failed to process input file (/Volumes/X10/brlcad/db/aet.asc)!</p>
<p>unknown command: title</p>



<a name="456874142"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/distcheck/near/456874142" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/distcheck.html#456874142">(Aug 06 2024 at 14:39)</a>:</h4>
<p>release fails also on same asc2g</p>



<a name="456874425"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/distcheck/near/456874425" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/distcheck.html#456874425">(Aug 06 2024 at 14:40)</a>:</h4>
<p>OK.  The latter means Tcl isn't functioning correctly - probably not initializing correctly.  If you try manually running btclsh or bwish I would expect some kind of error report?</p>



<a name="456874546"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/distcheck/near/456874546" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/distcheck.html#456874546">(Aug 06 2024 at 14:41)</a>:</h4>
<p>The tclInt.h bit is Itcl not finding an internal Tcl header it needs to build</p>



<a name="456874565"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/distcheck/near/456874565" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/distcheck.html#456874565">(Aug 06 2024 at 14:41)</a>:</h4>
<p>Hold on the latter -- it doesn't look like it applied your rpath change</p>



<a name="456875186"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/distcheck/near/456875186" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/distcheck.html#456875186">(Aug 06 2024 at 14:43)</a>:</h4>
<p>The Itcl CMakeLists.txt file should be telling the Itcl build where to go looking for Tcl private headers - we should be passing in TCL_SOURCE_DIR to the parent ExternalProject_Add for Itcl</p>



<a name="456875214"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/distcheck/near/456875214" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/distcheck.html#456875214">(Aug 06 2024 at 14:43)</a>:</h4>
<p>-DTCL_SOURCE_DIR=${CMAKE_SOURCE_DIR}/tcl/tcl</p>



<a name="456875274"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/distcheck/near/456875274" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/distcheck.html#456875274">(Aug 06 2024 at 14:44)</a>:</h4>
<p><em>sigh</em> .. so I must be crazy, but outside of blowing away an entire bext build dir, how "should" I be getting libtcl to recompile correctly?</p>



<a name="456875367"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/distcheck/near/456875367" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/distcheck.html#456875367">(Aug 06 2024 at 14:44)</a>:</h4>
<p>If the tcl/tcl submodule isn't populated, that's when I would expect it not to find the header</p>



<a name="456875458"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/distcheck/near/456875458" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/distcheck.html#456875458">(Aug 06 2024 at 14:44)</a>:</h4>
<p>I clear the build subdirectory for the specific target I'm wanting to reset.  So, if I needed to start over with Tcl, I'd clear the build/tcl subdirectory</p>



<a name="456875500"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/distcheck/near/456875500" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/distcheck.html#456875500">(Aug 06 2024 at 14:45)</a>:</h4>
<p>CMake should automatically re-run and reset things</p>



<a name="456875552"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/distcheck/near/456875552" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/distcheck.html#456875552">(Aug 06 2024 at 14:45)</a>:</h4>
<p>just doing a git pull and rebuild is what I'd expect and that didn't work.</p>



<a name="456875658"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/distcheck/near/456875658" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/distcheck.html#456875658">(Aug 06 2024 at 14:45)</a>:</h4>
<p>Once the ExternalProject_Add outputs are populated, an update of the source directory doesn't (in my experience) reliably reset things</p>



<a name="456875663"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/distcheck/near/456875663" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/distcheck.html#456875663">(Aug 06 2024 at 14:45)</a>:</h4>
<p>so make clean in bext/.build/tcl ?</p>



<a name="456875765"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/distcheck/near/456875765" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/distcheck.html#456875765">(Aug 06 2024 at 14:46)</a>:</h4>
<p>That might do it - I would straight up remove bext/.build/tcl</p>



<a name="456875877"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/distcheck/near/456875877" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/distcheck.html#456875877">(Aug 06 2024 at 14:46)</a>:</h4>
<p>You can then do make TCL_BLD to just redo the Tcl build and dependencies</p>



<a name="456877154"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/distcheck/near/456877154" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/distcheck.html#456877154">(Aug 06 2024 at 14:52)</a>:</h4>
<p><span class="user-mention silent" data-user-id="112516">starseeker</span> <a href="#narrow/stream/104062-brlcad/topic/distcheck/near/456875658">said</a>:</p>
<blockquote>
<p>Once the ExternalProject_Add outputs are populated, an update of the source directory doesn't (in my experience) reliably reset things</p>
</blockquote>
<p>Is there intuition as to why that's not working?  Is that because of things in our cmake?  What can we do about it barring massive deletions?</p>



<a name="456877648"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/distcheck/near/456877648" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/distcheck.html#456877648">(Aug 06 2024 at 14:54)</a>:</h4>
<p>Because that's going to bite ... every time we git pull on bext, going to have to either blow everything away whenever there's an update (which is going to be crazy dev cycle times) or hope to catch which subdirs update each pull and manually make-clean each of them (make clean in tcl subdir worked btw)</p>



<a name="456878309"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/distcheck/near/456878309" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/distcheck.html#456878309">(Aug 06 2024 at 14:58)</a>:</h4>
<p>I'm not completely sure of the reasons.  I do have the parent build always re-executing the build steps every time  the targets are run, specifically to try to catch such things, but I think that may be only the build step.</p>



<a name="456878502"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/distcheck/near/456878502" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/distcheck.html#456878502">(Aug 06 2024 at 14:58)</a>:</h4>
<p>I did notice it seems to reliably avoid rework once compile + install is complete</p>



<a name="456878525"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/distcheck/near/456878525" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/distcheck.html#456878525">(Aug 06 2024 at 14:58)</a>:</h4>
<p>I don't know if it will re-execute the configure step reliably - that may be up to the build system itself (the way CMake spots and knows to re-run configure if the build files change.)</p>



<a name="456878581"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/distcheck/near/456878581" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/distcheck.html#456878581">(Aug 06 2024 at 14:59)</a>:</h4>
<p>So if Tcl isn't smart about that, we may not be getting reconfigures we need after a source update</p>



<a name="456878663"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/distcheck/near/456878663" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/distcheck.html#456878663">(Aug 06 2024 at 14:59)</a>:</h4>
<p>Here's another error, bext release rebuild (after clearing and rebuilding tcl):</p>
<p>CMake Error at /Volumes/X10/brlcad.bext/.build.release/qt/Qt6_BLD-prefix/src/Qt6_BLD-stamp/Qt6_BLD-build-Release.cmake:37 (message):</p>
<p>Command failed: 1</p>
<p>'/opt/homebrew/Cellar/cmake/3.28.3/bin/cmake' '-DCMAKE_BUILD_TYPE=Release' '-P' '/Volumes/X10/brlcad.bext/.build.release/qt/qt_build.cmake'</p>
<p>See also</p>
<p>/Volumes/X10/brlcad.bext/.build.release/qt/Qt6_BLD-prefix/src/Qt6_BLD-stamp/Qt6_BLD-build-*.log<br>
-- stdout output is:<br>
-- stderr output is:</p>
<p>CMake Error at /Volumes/X10/brlcad.bext/.build.release/qt/qt_build.cmake:18 (message):</p>
<p>Qt build failed: [ 0%] Built target syncqt</p>
<p>[ 1%] Built target Core_lib_pri</p>
<p>[ 1%] Built target qmodule_pri</p>
<p>Error copying directory from</p>
<p>"/Volumes/X10/brlcad.bext/.build.release/qt/qt6-build/include/QtCore/.syncqt_staging"</p>
<p>to</p>
<p>"/Volumes/X10/brlcad.bext/.build.release/qt/qt6-build/lib/QtCore.framework/Versions/A/Headers".</p>
<p>make[5]: *** [src/corelib/CMakeFiles/Core_copy_fw_sync_headers] Error 1</p>
<p>make[4]: *** [src/corelib/CMakeFiles/Core_copy_fw_sync_headers.dir/all]</p>



<a name="456878811"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/distcheck/near/456878811" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/distcheck.html#456878811">(Aug 06 2024 at 15:00)</a>:</h4>
<p>That one is surprising - that appears to be internal to the Qt build itself</p>



<a name="456879051"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/distcheck/near/456879051" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/distcheck.html#456879051">(Aug 06 2024 at 15:01)</a>:</h4>
<p>That's why I remove the tcl subdirectory in such a case - it reliably reconfigures and rebuilds from scratch</p>



<a name="456884506"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/distcheck/near/456884506" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/distcheck.html#456884506">(Aug 06 2024 at 15:22)</a>:</h4>
<div class="codehilite"><pre><span></span><code>
</code></pre></div>

<p>CMake Warning (dev) at /opt/homebrew/Cellar/cmake/3.28.3/share/cmake/Modules/FindPackageHandleStandardArgs.cmake:438 (message):</p>
<p>The package name passed to <code>find_package_handle_standard_args</code> (OpenCV)</p>
<p>does not match the name of the calling package (OPENCV).  This can lead to</p>
<p>problems in calling code that expects <code>find_package</code> result variables</p>
<p>(e.g., <code>_FOUND</code>) to follow a certain pattern.</p>
<p>Call Stack (most recent call first):</p>
<p>/opt/homebrew/lib/cmake/opencv4/OPENCVConfig.cmake:354 (find_package_handle_standard_args)</p>
<p>CMakeLists.txt:374 (find_package)</p>
<p>opencv/CMakeLists.txt:4 (bext_enable)</p>
<p>This warning is for project developers.  Use -Wno-dev to suppress it.</p>
<p>CMake Warning (dev) at /opt/homebrew/Cellar/cmake/3.28.3/share/cmake/Modules/FindPackageHandleStandardArgs.cmake:447 (message):</p>
<p><code>find_package()</code> specify a version range but the module TCL does not</p>
<p>support this capability.  Only the lower endpoint of the range will be</p>
<p>used.</p>
<p>Call Stack (most recent call first):</p>
<p>CMake/FindTCL.cmake:461 (FIND_PACKAGE_HANDLE_STANDARD_ARGS)</p>
<p>tcl/CMakeLists.txt:24 (find_package)</p>
<p>This warning is for project developers.  Use -Wno-dev to suppress it.</p>



<a name="457136706"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/distcheck/near/457136706" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/distcheck.html#457136706">(Aug 07 2024 at 15:27)</a>:</h4>
<p>Looks like the @rpath fix to Tcl is working, at least preliminary build and make check are back to working again without that issue.</p>
<p>Remaining check failures are:</p>
<div class="codehilite" data-code-language="Text only"><pre><span></span><code>The following tests FAILED:

33 - bu_file (Failed)
374 - bu_color_to_rgb_floats_1 (Failed)
918 - ged_test_drawing_basic (Failed)
920 - ged_test_drawing_lod (Failed)
921 - ged_test_drawing_select (Failed)
</code></pre></div>



<a name="457159568"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/distcheck/near/457159568" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/distcheck.html#457159568">(Aug 07 2024 at 17:25)</a>:</h4>
<p>fixed bu_file, test had a flawed assumption about defaults</p>



<a name="457169610"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/distcheck/near/457169610" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/distcheck.html#457169610">(Aug 07 2024 at 18:28)</a>:</h4>
<p>fixed bu_color_to_rgb_floats_1</p>



<a name="457170169"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/distcheck/near/457170169" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/distcheck.html#457170169">(Aug 07 2024 at 18:30)</a>:</h4>
<p>(note @rpath is fixed on bext main, not bext RELEASE)</p>



<a name="462369076"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/distcheck/near/462369076" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/distcheck.html#462369076">(Aug 14 2024 at 15:28)</a>:</h4>
<p>OK, I got a look at the drawing failures</p>



<a name="462371078"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/distcheck/near/462371078" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/distcheck.html#462371078">(Aug 14 2024 at 15:38)</a>:</h4>
<p>The lod failure is doing an exact check on an image that is off by a single pixel, so that should probably just be switched to an approximate check.</p>



<a name="462371142"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/distcheck/near/462371142" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/distcheck.html#462371142">(Aug 14 2024 at 15:38)</a>:</h4>
<p>There may be more failures after that one, so I'll have to try and see what happens.</p>



<a name="462371335"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/distcheck/near/462371335" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/distcheck.html#462371335">(Aug 14 2024 at 15:39)</a>:</h4>
<p>Actually it's one pixel off by one, even</p>



<a name="462371468"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/distcheck/near/462371468" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/distcheck.html#462371468">(Aug 14 2024 at 15:40)</a>:</h4>
<p>The basic test difference is a bit larger, but looking at the diff image it appears to be a difference in how the tor got tessellated</p>



<a name="462371524"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/distcheck/near/462371524" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/distcheck.html#462371524">(Aug 14 2024 at 15:40)</a>:</h4>
<p><a href="/user_uploads/1549/_IbH9BMPc9SisQ67kxCP_PXY/v_23_diff.png">v_23_diff.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/1549/_IbH9BMPc9SisQ67kxCP_PXY/v_23_diff.png" title="v_23_diff.png"><img data-original-dimensions="512x512" src="/user_uploads/thumbnail/1549/_IbH9BMPc9SisQ67kxCP_PXY/v_23_diff.png/840x560.webp"></a></div>



<a name="462372095"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/distcheck/near/462372095" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/distcheck.html#462372095">(Aug 14 2024 at 15:42)</a>:</h4>
<p>Or more likely (since the prior draw of the bot didn't trigger) it's a difference in which lines ended up visible in the "hidden line" draw mode.</p>



<a name="462372718"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/distcheck/near/462372718" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/distcheck.html#462372718">(Aug 14 2024 at 15:44)</a>:</h4>
<p>Looks like the approximate compare is still a bit too strict for that one, so I'll adjust</p>



<a name="462372751"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/distcheck/near/462372751" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/distcheck.html#462372751">(Aug 14 2024 at 15:44)</a>:</h4>
<p>The real problem is the third case.</p>



<a name="462372858"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/distcheck/near/462372858" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/distcheck.html#462372858">(Aug 14 2024 at 15:45)</a>:</h4>
<p>To my astonishment, it <em>is</em> in fact failing to tessellate the tor primitive</p>



<a name="462372954"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/distcheck/near/462372954" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/distcheck.html#462372954">(Aug 14 2024 at 15:45)</a>:</h4>
<p>This is due to the select test changing the relative tolerance before facetizing the tor</p>



<a name="462373160"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/distcheck/near/462373160" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/distcheck.html#462373160">(Aug 14 2024 at 15:46)</a>:</h4>
<p>Running the process manually we can see more info:</p>
<div class="codehilite"><pre><span></span><code>mged&gt; facetize -vv tor t2.bot
/Users/user/brlcad/build/bin/ged_exec facetize_process -O /Users/user/.cache/BRL-CAD/facetize_5733869552563525943/facetize_moss_select_tmp.g --methods NMG --method-opts NMG nmg_debug=0x00000000 tol_abs=0.00000000000000000 tol_rel=0.00010000000000000 tol_norm=0.00000000000000000 --cache-dir /Users/user/.cache/BRL-CAD tor
Attempting to triangulate tor...
cut_unimonotone(): infinite loop 0x60000231aac0

cut_unimonotone(): infinite loop

 FAILED.
/Users/user/brlcad/build/bin/ged_exec facetize_process -O /Users/user/.cache/BRL-CAD/facetize_5733869552563525943/facetize_moss_select_tmp.g --methods CM --method-opts &quot;CM&quot; --cache-dir /Users/user/.cache/BRL-CAD tor
Attempting to triangulate tor...
feature_size: 0.000000
feature_scale: 0.150000
target_feature_size: 0.761658
CM: error at size 10.1554
CM: retrying with size 1.01554
CM: error at size 1.01554
CM: retrying with size 0.507772
CM: surface reconstruction failed: tor
 FAILED.
/Users/user/brlcad/build/bin/ged_exec facetize_process -O /Users/user/.cache/BRL-CAD/facetize_5733869552563525943/facetize_moss_select_tmp.g --methods CO3NE --method-opts &quot;CO3NE&quot; --cache-dir /Users/user/.cache/BRL-CAD tor
Attempting to triangulate tor...
feature_size: 0.000000
feature_scale: 0.150000
target_feature_size: 0.761658
Geogram result not manifold
o-[reconstruct ] Elapsed time: 3.013s
 FAILED.
/Users/user/brlcad/build/bin/ged_exec facetize_process -O /Users/user/.cache/BRL-CAD/facetize_5733869552563525943/facetize_moss_select_tmp.g --methods SPSR --method-opts &quot;SPSR&quot; --cache-dir /Users/user/.cache/BRL-CAD tor
Attempting to triangulate tor...
feature_size: 0.000000
feature_scale: 0.150000
target_feature_size: 0.761658
SPSR: decimating with feature size: 1.30208

bu_mtx_trylock() failed

bu_mtx_trylock() failed
Saving stack trace to facetize_process-83790-bomb.log

bu_mtx_lock() failed

bu_mtx_lock() failed
 FAILED.

Primitive tessellation summary:

1 object(s) failed:
        tor
</code></pre></div>



<a name="462373354"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/distcheck/near/462373354" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/distcheck.html#462373354">(Aug 14 2024 at 15:47)</a>:</h4>
<p>It's annoying that the fallback methods fail (the SPSR decimation is where those bu_mtx failures are coming from) but the <em>real</em> problem is the NMG "cut_unimonotone" failure.</p>



<a name="462373425"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/distcheck/near/462373425" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/distcheck.html#462373425">(Aug 14 2024 at 15:47)</a>:</h4>
<p>For a basic tor like that we should never have gotten to the fallbacks at all</p>



<a name="462373555"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/distcheck/near/462373555" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/distcheck.html#462373555">(Aug 14 2024 at 15:48)</a>:</h4>
<p>The tol setting from the select.cpp setup is:  "tol rel 0.0001"</p>



<a name="462373601"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/distcheck/near/462373601" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/distcheck.html#462373601">(Aug 14 2024 at 15:48)</a>:</h4>
<p>A facetize without changing the rel tolerance does succeed</p>



<a name="462373822"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/distcheck/near/462373822" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/distcheck.html#462373822">(Aug 14 2024 at 15:49)</a>:</h4>
<p>Looks like in the LoD test I changed this to 0.0002, probably to avoid a similar failure.  Not sure why I missed the select.</p>



<a name="462381021"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/distcheck/near/462381021" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/distcheck.html#462381021">(Aug 14 2024 at 16:29)</a>:</h4>
<p>OK, we'll see if a248e798bc2c passes.  If so I'll pull the necessary changes over to RELEASE.</p>



<a name="462381137"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/distcheck/near/462381137" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/distcheck.html#462381137">(Aug 14 2024 at 16:30)</a>:</h4>
<p>At some point we'll need to do something about that NMG failure, but that could be quite the rabbit hole</p>



<hr><p>Last updated: Feb 25 2025 at 00:48 UTC</p>
</html>