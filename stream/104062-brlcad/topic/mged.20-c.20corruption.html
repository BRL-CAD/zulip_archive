<html>
<head><meta charset="utf-8"><title>mged -c corruption · brlcad · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/index.html">brlcad</a></h2>
<h3>Topic: <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/mged.20-c.20corruption.html">mged -c corruption</a></h3>

<hr>

<base href="https://brlcad.zulipchat.com">

<head><link href="https://brl-cad.github.io/zulip_archive/style.css" rel="stylesheet"></head>

<a name="220476000"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/mged%20-c%20corruption/near/220476000" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/mged.20-c.20corruption.html#220476000">(Dec 19 2020 at 16:10)</a>:</h4>
<p><span class="user-mention" data-user-id="102902">@Sean</span>   Is this similar to what you're seeing?</p>
<div class="codehilite"><pre><span></span><code>BRL-CAD Release 7.32.1  Geometry Editor (MGED)
    Sat, 19 Dec 2020 14:52:53 UTC, Compilation 0
    cyapp@ubuntu2019

attach (nu ogl X)[nu]?
mged&gt; search /
/all.g
/all.g/box.r
/all.g/box.r/box.s
/all.g/cone.r
/all.g/cone.r/cone.s
/all.g/ellipse.r
/all.g/ellipse.r/ellipse.s
/all.g/light.r
/all.g/light.r/LIGHT
/all.g/platform.r
/all.g/platform.r/platform.s
/all.g/tor.r
/all.g/tor.r/tor
mged&gt; l en &quot;BRL-CAD Release 7.32.1  Geometry Editor (MGED)
    Sat, 19 Dec 2020 14:52:53 UTC, Compilation 0
    cyapp@ubuntu2019
mged&gt; l elAD Release 7.32.1  Geometry Editor (MGED)
    Sat, 19 Dec 2020 14:52:53 UTC, Compilation 0
    cyapp@ubuntu2019
mged&gt; l en &quot;BRL-CllAD Release 7.32.1  Geometry Editor (MGED)
    Sat, 19 Dec 2020 14:52:53 UTC, Compilation 0
    cyapp@ubuntu2019
mged&gt; l en &quot;BRL-ClliAD Release 7.32.1  Geometry Editor (MGED)
    Sat, 19 Dec 2020 14:52:53 UTC, Compilation 0
    cyapp@ubuntu2019
mged&gt; l en &quot;BRL-CllipAD Release 7.32.1  Geometry Editor (MGED)
    Sat, 19 Dec 2020 14:52:53 UTC, Compilation 0
    cyapp@ubuntu2019
mged&gt; l en &quot;BRL-CllipsAD Release 7.32.1  Geometry Editor (MGED)
    Sat, 19 Dec 2020 14:52:53 UTC, Compilation 0
    cyapp@ubuntu2019
mged&gt; l en &quot;BRL-CllipseAD Release 7.32.1  Geometry Editor (MGED)
    Sat, 19 Dec 2020 14:52:53 UTC, Compilation 0
    cyapp@ubuntu2019
mged&gt; l en &quot;BRL-Cllipse.AD Release 7.32.1  Geometry Editor (MGED)
    Sat, 19 Dec 2020 14:52:53 UTC, Compilation 0
    cyapp@ubuntu2019
mged&gt; l en &quot;BRL-Cllipse.rAD Release 7.32.1  Geometry Editor (MGED)
    Sat, 19 Dec 2020 14:52:53 UTC, Compilation 0
    cyapp@ubuntu2019
mged&gt; l en &quot;BRL-Cllipse.reAD Release 7.32.1  Geometry Editor (MGED)
    Sat, 19 Dec 2020 14:52:53 UTC, Compilation 0
    cyapp@ubuntu2019
mged&gt; l en &quot;BRL-Cllipse.relAD Release 7.32.1  Geometry Editor (MGED)
    Sat, 19 Dec 2020 14:52:53 UTC, Compilation 0
    cyapp@ubuntu2019
mged&gt; l en &quot;BRL-Cllipse.rellAD Release 7.32.1  Geometry Editor (MGED)
    Sat, 19 Dec 2020 14:52:53 UTC, Compilation 0
    cyapp@ubuntu2019
mged&gt; l en &quot;BRL-Cllipse.relliAD Release 7.32.1  Geometry Editor (MGED)
    Sat, 19 Dec 2020 14:52:53 UTC, Compilation 0
    cyapp@ubuntu2019
mged&gt; l en &quot;BRL-Cllipse.rellipAD Release 7.32.1  Geometry Editor (MGED)
    Sat, 19 Dec 2020 14:52:53 UTC, Compilation 0
    cyapp@ubuntu2019
mged&gt; l en &quot;BRL-Cllipse.rellipsAD Release 7.32.1  Geometry Editor (MGED)
    Sat, 19 Dec 2020 14:52:53 UTC, Compilation 0
    cyapp@ubuntu2019
mged&gt; l en &quot;BRL-Cllipse.rellipseAD Release 7.32.1  Geometry Editor (MGED)
    Sat, 19 Dec 2020 14:52:53 UTC, Compilation 0
    cyapp@ubuntu2019
mged&gt; l en &quot;BRL-Cllipse.rellipse.AD Release 7.32.1  Geometry Editor (MGED)
    Sat, 19 Dec 2020 14:52:53 UTC, Compilation 0
    cyapp@ubuntu2019
mged&gt; l en &quot;BRL-Cllipse.rellipse.rAD Release 7.32.1  Geometry Editor (MGED)
    Sat, 19 Dec 2020 14:52:53 UTC, Compilation 0
    cyapp@ubuntu2019
mged&gt; l en &quot;BRL-Cllipse.rellipse.r
</code></pre></div>



<a name="220476026"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/mged%20-c%20corruption/near/220476026" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/mged.20-c.20corruption.html#220476026">(Dec 19 2020 at 16:11)</a>:</h4>
<p>I had mged -c up in valgrind and it didn't squawk about anything when that happened...</p>



<a name="220476183"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/mged%20-c%20corruption/near/220476183" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/mged.20-c.20corruption.html#220476183">(Dec 19 2020 at 16:15)</a>:</h4>
<p>Could libtermio be out of sync with modern terminals somehow?</p>



<a name="220735444"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/mged%20-c%20corruption/near/220735444" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/mged.20-c.20corruption.html#220735444">(Dec 22 2020 at 21:21)</a>:</h4>
<p>Yep, that looks like the corruption.  It wasn't libtermio the last time this happened (last winter), but it could be.  It could be lots of things.    The thing to do is attach a debugger when it happens, see what's messed up.  It usually prints the version info, which is held in global static vars, so that's a strong indication its memory corruption.</p>



<a name="378261422"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/mged%20-c%20corruption/near/378261422" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/mged.20-c.20corruption.html#378261422">(Jul 24 2023 at 20:22)</a>:</h4>
<p>A quick debugging session suggests that brlcad_ident isn't being called when the version string is appearing in the output.</p>



<a name="378262087"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/mged%20-c%20corruption/near/378262087" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/mged.20-c.20corruption.html#378262087">(Jul 24 2023 at 20:26)</a>:</h4>
<p>There's an interesting note in src/mged/cmd.c around line 1029 warning that the input string needs to be saved because f_mouse is "notorious for adding things to the input string" and indicating the non-copied input shouldn't be fed to Tcl_Eval...  are we perhaps Tcl_Evaling something we shouldn't either here or elsewhere in MGED and getting corrupted input that way?</p>



<a name="378262894"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/mged%20-c%20corruption/near/378262894" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/mged.20-c.20corruption.html#378262894">(Jul 24 2023 at 20:31)</a>:</h4>
<p>What happens if you put “global version” and “set version something” in your .mgedrc?  That’ll indicate whether it’s the tcl bar or not.</p>



<a name="378289650"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/mged%20-c%20corruption/near/378289650" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> starseeker <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/mged.20-c.20corruption.html#378289650">(Jul 24 2023 at 22:37)</a>:</h4>
<p>Grr.  Now it doesn't want to repeat - the instance of corruption I'm getting now pulled part of a previous command's text in as I middle click pasted, but not the version string specifically:</p>
<div class="codehilite"><pre><span></span><code>mged&gt; 1;2A1;2A1;2A1;2A
result: invalid command name &quot;1&quot;
invalid command name &quot;1&quot;
mged&gt; ls
result: LIGHT               cone.r/R            light.r/R           tor.r/R
all.g/              cone.s              platform.r/R
box.r/R             ellipse.r/R         platform.s
box.s               ellipse.s           tor

LIGHT               cone.r/R            light.r/R           tor.r/R
all.g/              cone.s              platform.r/R
box.r/R             ellipse.r/R         platform.s
box.s               ellipse.s           tor
mged&gt;  ve1;rsion2A1;2A1;2A
result: invalid command name &quot;ve1&quot;
invalid command name &quot;ve1&quot;
</code></pre></div>
<p>(The corrupted 'version' command was generated from a middle-mouse-buttion paste selection that  had both a clean 'version' text command and additional lines of  text from the history selected, btw)  Looks like the previous history text apparently started to get inserted after just two characters of the paste had landed...</p>



<a name="378619278"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/mged%20-c%20corruption/near/378619278" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/mged.20-c.20corruption.html#378619278">(Jul 25 2023 at 22:45)</a>:</h4>
<p>I've seen it be things other than the version string too, which is also why I think version is probably just one of the last commands to get run. (there is a "set version [brlcad_ident "..."]" in the initialization.)</p>



<a name="381891617"></a>
<h4><a href="https://brlcad.zulipchat.com#narrow/stream/104062-brlcad/topic/mged%20-c%20corruption/near/381891617" class="zl"><img src="https://brl-cad.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mo Aman <a href="https://brl-cad.github.io/zulip_archive/stream/104062-brlcad/topic/mged.20-c.20corruption.html#381891617">(Aug 04 2023 at 15:25)</a>:</h4>
<p>bro-cad</p>



<hr><p>Last updated: Jan 07 2025 at 00:46 UTC</p>
</html>